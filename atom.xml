<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>艾斯牛 Blog</title>
  <icon>https://www.gravatar.com/avatar/c64997c9d7912f88b4e2d0181ae88958</icon>
  <subtitle>一生志愿只要平凡快乐</subtitle>
  <link href="https://blog.halfsummer.xyz/atom.xml" rel="self"/>
  
  <link href="https://blog.halfsummer.xyz/"/>
  <updated>2023-03-11T12:51:07.430Z</updated>
  <id>https://blog.halfsummer.xyz/</id>
  
  <author>
    <name>aceniu</name>
    <email>123354319@qq.com</email>
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Rsync备份服务器配置</title>
    <link href="https://blog.halfsummer.xyz/posts/9e614189.html"/>
    <id>https://blog.halfsummer.xyz/posts/9e614189.html</id>
    <published>2023-03-09T23:52:34.000Z</published>
    <updated>2023-03-11T12:51:07.430Z</updated>
    
    <content type="html"><![CDATA[<meta name="referrer" content="no-referrer" /><h1 id="1）简介">1）简介</h1><p>rsync（remote synchronize）是Liunx/Unix下的一个远程数据同步工具。它可通过LAN/WAN快速同步多台主机间的文件和目录，并适当利用rsync算法（差分编码）以减少数据的传输。rsync算法并不是每一次都整份传输，而是只传输两个文件的不同部分，因此其传输速度相当快。除此之外，rsync可拷贝、显示目录属性，以及拷贝文件，并可选择性的压缩以及递归拷贝。</p><h2 id="1-1-rsync的工作原理">1.1 rsync的工作原理</h2><ul><li>客户端构造FileList，FileList包含了需要与服务器同步的所有文件信息对name-&gt;id<br>（id用来唯一表示文件例如MD5）</li><li>客户端将FileList发送到服务器。</li><li>服务器上rsync处理客户端发过来的FileList，构建新的NewFileList。其中根据MD5值比较，删除服务器上已经存在的文件信息对，只保留服务器上不存在或变化的文件。</li><li>客户端得到服务器发送过来的NewFileList，然后把NewFileList中的文件重新传输到服务器。</li></ul><h2 id="1-2-rsync优点">1.2 rsync优点</h2><ol><li><p>可以镜像保存整个目录树和文件系统。</p></li><li><p>可以很容易做到保持原来文件的权限、时间、软硬连接等。</p></li><li><p>无需特殊权限即可安装。</p></li><li><p>快速：第一次同步时rsync复制全部内容，但在下一次值传输修改过的内容</p></li><li><p>压缩传输：rysnc在传输的过程中可以实行压缩及解压缩操作，可以使用更少的带宽</p></li><li><p>安全：可以使用scp、ssh等方式来进行文件传输</p></li><li><p>支持匿名传输，以方便进行网站镜像</p></li><li><p>rsync不仅可以远程同步数据（类似于scp），而且可以本地同步数据（类似于cp），做差异同步</p></li><li><p>openssh 8.0已经把scp标记为过时不建议使用了。建议用sftp或者rsync替代scp</p></li></ol><p><em>（需要在Liunx/Unix服务器之间互传海量数据时，建议选择rsync进行传输）</em></p><h2 id="1-3-rsync认证方式">1.3 rsync认证方式</h2><p>rsync有两种常用的认证方式，一种是rsync-daemon方式，另外一种是ssh方式。</p><p>在平时使用过程，我们使用最多的是rsync-daemon方式。</p><p>⚠️<strong>注意：在使用rsync时，服务器和客户端都必须安装rsync程序</strong>。</p><h3 id="📌rsync-daemon-认证">📌rsync-daemon 认证</h3><p>rsync在rsync-daemon认证方式下，默认监听TCP的873端口。</p><p>rsync-daemon认证方式是rsync的主要认证方式，这个也是我们经常使用的认证方式。并且也只有在此种模式下，rsync才可以把密码写入到一个文件中。</p><blockquote><p>⚠️注意：<br>rsync-daemon认证方式，需要服务器和客户端都安装rsync服务并且只需要rsync服务器端启动rsync，同时配置rsync配置文件。客户端启动不启动rsync服务，都不影响同步的正常进行。</p></blockquote><h3 id="📌ssh认证">📌ssh认证</h3><p>rsync在ssh认证方式下，可通过系统用户进行认证，即在rsync上通过ssh隧道进行传输，类似于scp工具。此时同步操作不在局限于rsync中定义的同步文件夹。</p><blockquote><p>⚠️注意：<br>ssh认证方式，不需要服务器和客户端配置rsync配置文件只需要双方都安装rsync服务，并且也不需要双方启动rsync。</p></blockquote><p>若rsync服务端SSH为标准端口，此时rsync使用方式如下：</p><pre><code>rsync -avz /root/test root@10.10.10.10:/root/</code></pre><p>若rsync服务端SSH为非标准端口，可通过rsync的-e参数进行端口指定。使用方式如下：</p><pre><code>rsync -avz /root/test -e 'ssh -p1234' root@10.10.10.10:/root/</code></pre><h1 id="2）安装rsync">2）安装rsync</h1><p>安装rsync，我们可以分为两种方式：源码方式安装和RPM方式安装。</p><p><strong>注意：rsync软件无论是服务器端还是客户端都是同一个软件包。</strong></p><h2 id="2-1-源码方式安装">2.1 源码方式安装</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 源码方式安装rsync，需要到其官网下载对应的安装包。rsync官网：rsync.samba.org </span></span><br><span class="line"></span><br><span class="line">1)、下载</span><br><span class="line">wget https://download.samba.org/pub/samba/stable/samba-4.18.0.tar.gz</span><br><span class="line"></span><br><span class="line">2)、解压并安装</span><br><span class="line">tar -xvf rsync-4.18.0.tar.gz</span><br><span class="line"></span><br><span class="line">3)、编译安装</span><br><span class="line"><span class="comment"># 源码安装rsync时，其编译时所需要的gcc库文件尽量提前安装完毕</span></span><br><span class="line"><span class="comment"># 默认安装到/usr/local/目录下</span></span><br><span class="line">./configure</span><br><span class="line">make &amp;&amp; make install</span><br><span class="line"></span><br><span class="line">4)、设置开机启动</span><br><span class="line"><span class="built_in">echo</span> “/usr/local/bin/rsync --daemon -config=/etc/rsyncd.conf” &gt;&gt;/etc/profile</span><br></pre></td></tr></table></figure><h2 id="2-2-yum方式安装">2.2 yum方式安装</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">yum -y install  rsync</span><br><span class="line"></span><br><span class="line"><span class="comment">#设置开机启动</span></span><br><span class="line"><span class="built_in">echo</span> “/usr/local/bin/rsync --daemon -config=/etc/rsyncd.conf” &gt;&gt;/etc/profile</span><br></pre></td></tr></table></figure><h1 id="3）配置rsync-daemon">3）配置rsync daemon</h1><h2 id="3-1-服务端配置">3.1 服务端配置</h2><p>📌<strong>准备rsync配置文件</strong></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 以 rsync 用户启动进程</span></span><br><span class="line">uid = rsync</span><br><span class="line">gid = rsync</span><br><span class="line"></span><br><span class="line"> <span class="comment"># 无需让rsync以root身份运行，允许接收文件的完整属性</span></span><br><span class="line">fake super = <span class="built_in">yes</span>       </span><br><span class="line"></span><br><span class="line"><span class="comment"># 禁锢推送的数据至某个目录, 不允许跳出该目录</span></span><br><span class="line">use <span class="built_in">chroot</span> = no                </span><br><span class="line"></span><br><span class="line">max connections = 200          <span class="comment"># 最大连接数</span></span><br><span class="line"><span class="built_in">timeout</span> = 600                  <span class="comment"># 超时时间</span></span><br><span class="line">ignore errors                  <span class="comment"># 忽略错误信息</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">read</span> only = <span class="literal">false</span>              <span class="comment"># 对备份数据可读写</span></span><br><span class="line"></span><br><span class="line">list = <span class="literal">false</span>                   <span class="comment"># 不允许查看模块信息</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 定义虚拟用户，作为连接认证用户</span></span><br><span class="line">auth <span class="built_in">users</span> = myuser </span><br><span class="line"></span><br><span class="line"><span class="comment"># 定义rsync服务用户连接认证密码文件路径</span></span><br><span class="line">secrets file = /etc/rsync.passwd</span><br><span class="line"></span><br><span class="line"><span class="comment">#### 定义模块信息</span></span><br><span class="line">[backup]                </span><br><span class="line">comment = commit        <span class="comment"># 模块注释信息</span></span><br><span class="line">path = /backup          <span class="comment"># 定义接收备份数据目录</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 只允许10.10.10段ip连接</span></span><br><span class="line">hosts allow = 10.10.10.0/24</span><br></pre></td></tr></table></figure><p>📌<strong>配置并启动守护进程</strong></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 需要一个rsync进程运行时使用的普通用户 rsync</span></span><br><span class="line">useradd rsync -M -s /sbin/nologin</span><br><span class="line"></span><br><span class="line"><span class="comment"># 服务端需要定义一个客户端连接    虚拟用户名和密码</span></span><br><span class="line"><span class="comment"># 密码文件形式  user:passwd</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;myuser:password&quot;</span> &gt; /etc/rsync.passwd</span><br><span class="line"><span class="built_in">chmod</span> 600 /etc/rsync.passwd</span><br><span class="line"></span><br><span class="line"><span class="comment"># 准备模块定义好的目录,客户端的数据都存放在该目录下</span></span><br><span class="line"><span class="built_in">mkdir</span> /backup</span><br><span class="line"><span class="built_in">chown</span> -R rsync.rsync /backup</span><br><span class="line"></span><br><span class="line"><span class="comment"># 启动服务</span></span><br><span class="line">rsync --daemon</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看服务</span></span><br><span class="line">ps aux | grep rsync</span><br><span class="line">netstat -lntp|grep 873</span><br></pre></td></tr></table></figure><h2 id="3-2-客户端的使用">3.2 客户端的使用</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment"># 在客户端安装完毕rsync服务后，是不需要启动rsync服务的。</span></span><br><span class="line"><span class="comment"># 我们只需要在客户端创建连接rsync服务器时，验证码用户所需要的密码文件即可。</span></span><br><span class="line"><span class="comment"># 该密码文件中的密码要与rsync服务器上的密码文件中的密码对应</span></span><br><span class="line"><span class="comment"># 并且也要与rsync服务器rsyncd.conf配置文件中的认证模块中的用户匹配。</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> “password”&gt;&gt;/etc/rsync.passwd</span><br><span class="line"></span><br><span class="line"><span class="built_in">chmod</span> 600 /etc/rsync.passwd</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看 rsync 守护程序分配的所有 module 列表，可以执行下面命令。</span></span><br><span class="line">rsync rsync://10.10.10.10</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 具体写法是服务器与目标目录之间使用双冒号分隔`::`</span></span><br><span class="line"><span class="comment"># 地址中的module并不是实际路径名，而是 rsync 守护程序指定的模块名</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 把本地的文件同步到远程服务器</span></span><br><span class="line"><span class="comment"># rsync [OPTION]… [SRC]… [USER@]HOST::DEST</span></span><br><span class="line"><span class="comment"># rsync [选项] [--port=]  [--password-file=] [/local/path] [用户名]@服务端IP::[模块名]</span></span><br><span class="line"></span><br><span class="line">rsync -av --password-file=/etc/rsync.passwd <span class="built_in">local</span>/ myuser@10.10.10.10::backup</span><br><span class="line"></span><br><span class="line"><span class="comment"># 把远程机器的文件同步到本地</span></span><br><span class="line"><span class="comment"># rsync [OPTION]… [USER@]HOST::SRC [DEST]</span></span><br><span class="line"><span class="comment"># rsync [选项] [--port=] [--password-file=] [用户名@]服务端IP::[模块名]  [/local/path]</span></span><br><span class="line"></span><br><span class="line">rsync -av --password-file=/etc/rsync.passwd myuser@10.10.10.10::backup <span class="built_in">local</span>/</span><br></pre></td></tr></table></figure><h1 id="4）rsync使用">4）rsync使用</h1><h2 id="4-1-同步模式模式">4.1 同步模式模式</h2><h3 id="4-1-1-本地同步">4.1.1 本地同步</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">##本地  rsync   选项       源      目标</span></span><br><span class="line">Local:  rsync [OPTION...] SRC... [DEST]</span><br><span class="line"></span><br><span class="line"><span class="comment">#将/etc目录备份到/opt目录下，和cp的区别在于会自动增量备份</span></span><br><span class="line">rsync -avz /etc /opt</span><br></pre></td></tr></table></figure><h3 id="4-1-2远程同步">4.1.2远程同步</h3><h4 id="ssh协议">ssh协议</h4><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 默认使用 SSH 进行远程登录和数据传输</span></span><br><span class="line"><span class="comment"># 不需要做任何配置，需要都安装rsync，操作上类似scp</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#将远端文件拉（下载）到本地</span></span><br><span class="line">Pull: rsync [OPTION...] [USER@]HOST:SRC... [DEST]</span><br><span class="line">         </span><br><span class="line"><span class="comment">#将本地文件推送（上传）到远端</span></span><br><span class="line">Push: rsync [OPTION...] SRC... [USER@]HOST:DEST</span><br><span class="line"> </span><br><span class="line"><span class="comment">#将etc推送到10.10.10.10下的自定义文件夹下</span></span><br><span class="line">rsync -az /etc/ 10.10.10.10:/opt/etc-$(hostname)-$(<span class="built_in">date</span> +%F)</span><br></pre></td></tr></table></figure><h4 id="rsync协议">rsync协议</h4><blockquote><p>使用rsync协议，需要服务端启动守护进程</p><p>操作参考 <a href="">配置rsync daemon</a></p></blockquote><h2 id="4-2-命令参数">4.2 命令参数</h2><p>📌<strong>常用参数</strong></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">-v, –verbose详细模式输出。</span><br><span class="line"></span><br><span class="line">-a, –archive归档模式，表示以递归方式传输文件，并保持所有文件属性不变。</span><br><span class="line"></span><br><span class="line">-z, –compress对备份的文件在传输时进行压缩处理。</span><br><span class="line"></span><br><span class="line">–delete：删除那些DST中存在而在SRC中没有的文件。</span><br></pre></td></tr></table></figure><p>📌<strong>所有参数</strong></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">-a：–archive archive mode 权限保存模式，相当于 -rlptgoD 参数，存档，递归，保持属性等。</span><br><span class="line">-r：–recursive 复制所有下面的资料，递归处理。</span><br><span class="line">-p：–perms 保留档案权限，文件原有属性。</span><br><span class="line">-t：–<span class="built_in">times</span> 保留时间点，文件原有时间。</span><br><span class="line">-g：–group 保留原有属组。</span><br><span class="line">-o：–owner 保留档案所有者(root only)。</span><br><span class="line">-D：–devices 保留device资讯(root only)。</span><br><span class="line">-l：–links 复制所有的连接，拷贝连接文件。</span><br><span class="line">-z：–compress 压缩模式，当资料在传送到目的端进行档案压缩。</span><br><span class="line">-H：–hard-links 保留硬链接文件。</span><br><span class="line">-A：–acls 保留ACL属性文件，需要配合–perms。</span><br><span class="line">-P：-P参数和 --partial --progress 相同，只是为了把参数简单化，表示传进度。</span><br><span class="line">--version：输出rsync版本。</span><br><span class="line">-v：–verbose 复杂的输出信息。</span><br><span class="line">-u：–update 仅仅进行更新，也就是跳过已经存在的目标位置，并且文件时间要晚于要备份的文件，不覆盖新的文件。</span><br><span class="line">--port=PORT：定义rsyncd(daemon)要运行的port(预设为tcp 873)。</span><br><span class="line"></span><br><span class="line">--delete：删除那些目标位置有的文件而备份源没有的文件。</span><br><span class="line"></span><br><span class="line">--delete-before: 接收者在传输之前进行删除操作</span><br><span class="line"></span><br><span class="line">--password-file=FILE ：从 指定密码文件中获取密码。</span><br><span class="line">--bwlimit=KBPS：限制 I/O 带宽。</span><br><span class="line">--filter “-filename”：需要过滤的文件。</span><br><span class="line">--exclude=filname：需要过滤的文件。</span><br><span class="line">--progress：显示备份过程。</span><br></pre></td></tr></table></figure><h1 id="5）示例">5）示例</h1><h2 id="5-1-常用示例">5.1 常用示例</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 将当前目录下所有文件同步到远端</span></span><br><span class="line">rsync -avzP ./* myuser@10.10.10.15::backup </span><br><span class="line"></span><br><span class="line"><span class="comment"># 从服务端同步数据到本地</span></span><br><span class="line">rsync -avzP  myuser@10.10.10.15::backup .</span><br><span class="line"></span><br><span class="line"><span class="comment"># 保持服务端于客户端上数据完全一致，服务端有则同步给客户端，服务端没有，客户端有的则从客户端删除</span></span><br><span class="line"><span class="comment"># –delete 选项，表示客户端上的数据要与服务器端完全一致,多则删之，少则补之</span></span><br><span class="line"><span class="comment"># 用的时候要小心点，最好不要把已经有重要数所据的目录，当做本地更新目录，否则会把你的数据全部删除</span></span><br><span class="line">rsync -avzP  --delete myuser@10.10.10.15::backup  /tmp/test/</span><br><span class="line"></span><br><span class="line"><span class="comment"># 下面的 rsync 命令将10.10.10.10主机上的 /www 目录（不包含 /www/logs 和 /www/conf子目录）复制到本地的 /backup/www/ </span></span><br><span class="line">rsync -avzP --delete --exclude <span class="string">&quot;logs/&quot;</span> --exclude <span class="string">&quot;conf/&quot;</span>  \</span><br><span class="line">10.10.10.10:/www/ /backup/www/</span><br></pre></td></tr></table></figure><h2 id="5-2-快速删除大量数据">5.2 快速删除大量数据</h2><p><strong>在<code>need_delete</code> 目录下建立30万个文件</strong></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">time <span class="keyword">for</span> i <span class="keyword">in</span> $(<span class="built_in">seq</span> 1 300000)</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line"><span class="built_in">echo</span> <span class="built_in">test</span> &gt;&gt;<span class="variable">$i</span>.txt</span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 执行时间</span></span><br><span class="line">real0m42.267s</span><br><span class="line">user0m6.756s</span><br><span class="line">sys0m33.973s</span><br></pre></td></tr></table></figure><p><strong>测试rsync删除</strong></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 先创建一个空目录new_dir</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 然后执行 </span></span><br><span class="line">time rsync -a --delete-before new_dir/ need_delete/</span><br><span class="line"></span><br><span class="line"><span class="comment"># 只需要几秒钟，速度非常快</span></span><br><span class="line">real0m8.146s</span><br><span class="line">user0m0.216s</span><br><span class="line">sys0m7.127s</span><br></pre></td></tr></table></figure><p><strong>测试 rm -rf 删除</strong></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">time <span class="built_in">rm</span> -rf need_delete/</span><br><span class="line"></span><br><span class="line">real0m9.639s</span><br><span class="line">user0m0.143s</span><br><span class="line">sys0m8.250s</span><br></pre></td></tr></table></figure><h1 id="6）rsyncd-conf-详解">6）rsyncd.conf 详解</h1><h2 id="6-1-全局参数">6.1 全局参数</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 在独立运行时，用于指定的服务器运行的 IP 地址</span></span><br><span class="line">address = IP</span><br><span class="line"></span><br><span class="line"><span class="comment"># 监听端口</span></span><br><span class="line">port = 873 </span><br><span class="line"></span><br><span class="line"><span class="comment"># rsync 的守护进程将其 PID 写入指定的文件</span></span><br><span class="line">pid file = /var/run/rsyncd.pid</span><br><span class="line"></span><br><span class="line"><span class="comment"># 指定支持 max connections 参数的锁文件</span></span><br><span class="line">lock file = /var/run/rsync.lock</span><br><span class="line"></span><br><span class="line"><span class="comment"># 指定 rsync 守护进程的日志文件，而不将日志发送给 syslog</span></span><br><span class="line"><span class="built_in">log</span> file = /var/log/rsyncd.log</span><br><span class="line"></span><br><span class="line"><span class="comment">#========== 控制参数 =============#</span></span><br><span class="line"> <span class="comment"># 以指定的 UID 传输文件</span></span><br><span class="line">uid = rsync        </span><br><span class="line"></span><br><span class="line"><span class="comment"># 指定该模块以指定的 GID 传输文件。</span></span><br><span class="line">gid = rsync                     </span><br><span class="line"></span><br><span class="line"><span class="comment"># 禁锢推送的数据至某个目录, 不允许跳出该目录,</span></span><br><span class="line"><span class="comment"># 默认为 yes，则 rsync 在传输文件之前首先 chroot 到 path 参数所指定的目录下</span></span><br><span class="line"><span class="comment"># 这样做的原因是实现额外的安全防护，但是缺点是需要 root 权限</span></span><br><span class="line"><span class="comment"># 并且不能备份指向 path 外部的符号连接所指向的目录文件</span></span><br><span class="line">use <span class="built_in">chroot</span> = no                </span><br><span class="line"></span><br><span class="line"><span class="comment"># 无需让rsync以root身份运行，允许接收文件的完整属性</span></span><br><span class="line">fake super = <span class="built_in">yes</span>                </span><br><span class="line"></span><br><span class="line"><span class="comment"># 大并发连接数量以保护服务器，超过限制的连接请求将被告知随后再试</span></span><br><span class="line"><span class="comment"># 默认为0 （没有限制）</span></span><br><span class="line">max connections = 200</span><br><span class="line"></span><br><span class="line"><span class="comment"># 超时时间</span></span><br><span class="line"><span class="built_in">timeout</span> = 600               </span><br><span class="line"></span><br><span class="line"><span class="comment"># 指定在 rsync 服务器上运行 delete 操作时是否忽略 I/O 错误。</span></span><br><span class="line"><span class="comment"># 一般来说 rsync 在出现 I/O 错误时将将跳过 –delete 操作</span></span><br><span class="line"><span class="comment"># 以防止因为暂时的资源不足或其它 I/O 错误导致的严重问题。</span></span><br><span class="line">ignore errors</span><br><span class="line"></span><br><span class="line"><span class="comment"># 指定是否允许客户上传文件。</span></span><br><span class="line"><span class="comment"># 默认为true，不允许用户上传文件，</span></span><br><span class="line"><span class="comment"># 若为 false 并且服务器目录也具有读写权限则允许上传。</span></span><br><span class="line"><span class="built_in">read</span> only = <span class="literal">false</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 指定当客户请求列出可以使用的模块列表时，该模块是否应该被列出。</span></span><br><span class="line"><span class="comment"># 默认为 true，如果设置该选项为 false，可以创建隐藏的模块</span></span><br><span class="line">list = <span class="literal">false</span></span><br></pre></td></tr></table></figure><h2 id="6-2-模块参数">6.2 模块参数</h2><blockquote><p>模块参数主要用于定义 rsync 服务器哪个目录要被同步。</p><p>模块声明的格式必须为 [module] 形式，这个名字就是在 rsync 客户端看到的名字，类似于 Samba 服务器提供的共享名。</p><p>而服务器真正同步的数据是通过 path 来指定的。可以根据自己的需要，来指定多个模块，模块中可以定义以下参数：</p></blockquote><p><strong>基本模块参数</strong></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 指定模块名</span></span><br><span class="line">[backup]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 指定当前模块在 rsync 服务器上的同步路径，该参数是必须指定的</span></span><br><span class="line">path = /backup  </span><br><span class="line"></span><br><span class="line"><span class="comment"># 给模块指定一个描述，该描述连同模块名在客户连接得到模块列表时显示给客户</span></span><br><span class="line">comment = commit</span><br></pre></td></tr></table></figure><p><strong>模块文件筛选参数</strong></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 指定多个由空格隔开的多个文件或目录(相对路径)</span></span><br><span class="line"><span class="comment"># 并将其添加到 exclude 列表中。这等同于在客户端命令中使用 –exclude 来指定模式。</span></span><br><span class="line">exclude = exclude_file</span><br><span class="line"></span><br><span class="line"><span class="comment"># 指定一个包含 exclude 规则定义的文件名，服务器从该文件中读取 exclude 列表定义</span></span><br><span class="line">exclude from = exclude-file.txt</span><br><span class="line"></span><br><span class="line"><span class="comment"># 指定多个由空格隔开的多个文件或目录(相对路径)，并将其添加到 include 列表中。</span></span><br><span class="line"><span class="comment"># 这等同于在客户端命令中使用 –include 来指定模式 。</span></span><br><span class="line">include = include-file.txt</span><br><span class="line"></span><br><span class="line"><span class="comment"># 指定一个包含 include 规则定义的文件名，服务器从该文件中读取 include 列表定义</span></span><br><span class="line">include from = exclude-file.txt</span><br><span class="line"></span><br><span class="line"><span class="comment"># 一个模块只能指定一个exclude 参数、一个include 参数</span></span><br><span class="line"><span class="comment"># 结合 include 和 exclude 可以定义复杂的exclude/include 规则</span></span><br><span class="line"><span class="comment"># 这几个参数分别与相应的rsync 客户命令选项等价，唯一不同的是它们作用在服务器端</span></span><br></pre></td></tr></table></figure><p><strong>模块用户认证参数</strong></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># rsync 默认匿名方式传输</span></span><br><span class="line"><span class="comment"># 若只配置匿名访问的 rsync 服务器，则无需设置下述参数</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 指定由空格或逗号分隔的用户名列表，只有这些用户才允许连接该模块。</span></span><br><span class="line"><span class="comment"># 这里的用户和系统用户没有任何关系。用户名和口令以明文方式存放在 secrets file 参数指定的文件中</span></span><br><span class="line">auth <span class="built_in">users</span> = user_name</span><br><span class="line"></span><br><span class="line"><span class="comment"># 指定一个 rsync 认证口令文件。只有在 auth users 被定义时，该文件才起作用</span></span><br><span class="line">secrets file = /etc/rsync.passwd</span><br><span class="line"></span><br><span class="line"><span class="comment"># rsync 认证口令文件的权限一定是 600，否则客户端将不能连接服务器。</span></span><br><span class="line"><span class="comment"># rsync 认证口令文件中每一行指定一个 用户名:口令 对，格式为：</span></span><br><span class="line"><span class="comment"># username:passwd</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 一般来说口令最好不要超过8个字符</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 一个rsync配置文件中可以包含多个认证模块，同时一个密码文件中也可以存放多个用户和其对应的密码。</span></span><br><span class="line"><span class="comment"># 其中每一个认证模块可以对应不同的客户端。</span></span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;meta name=&quot;referrer&quot; content=&quot;no-referrer&quot; /&gt;
&lt;h1 id=&quot;1）简介&quot;&gt;1）简介&lt;/h1&gt;
&lt;p&gt;rsync（remote synchronize）是Liunx/Unix下的一个远程数据同步工具。它可通过LAN/WAN快速同步多台</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>NFS服务器配置</title>
    <link href="https://blog.halfsummer.xyz/posts/757768a4.html"/>
    <id>https://blog.halfsummer.xyz/posts/757768a4.html</id>
    <published>2023-03-09T22:54:06.000Z</published>
    <updated>2023-03-11T12:51:07.426Z</updated>
    
    <content type="html"><![CDATA[<meta name="referrer" content="no-referrer" /><h1 id="1）这里用一个实例环境来讲解">1）这里用一个实例环境来讲解</h1><table><thead><tr><th>hostname</th><th>ip</th></tr></thead><tbody><tr><td>Server-nfs</td><td>192.168.0.1</td></tr><tr><td>Cilent-nfs-linux</td><td>192.168.0.10</td></tr><tr><td>Cilent-nfs-windows</td><td>192.168.0.20</td></tr></tbody></table><p>📌 <strong>配置网络环境</strong></p><p>-----略-----</p><hr><h1 id="2）NFS-服务端部署">2）NFS 服务端部署</h1><h2 id="📌-在服务端安装NFS服务">📌 <strong>在服务端安装NFS服务</strong></h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum -y install nfs-utils rpcbind</span><br></pre></td></tr></table></figure><h2 id="📌-创建共享目录">📌 <strong>创建共享目录</strong></h2><p>这个目录可以在任意位置的任意名字</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> -p /opt/share</span><br><span class="line"><span class="built_in">chmod</span> o+w /opt/share/</span><br></pre></td></tr></table></figure><h2 id="📌-配置共享目录">📌 <strong>配置共享目录</strong></h2><p>默认文件为空：此配置按列分隔</p><ul><li><p>第一列：<strong>共享文件的路径</strong></p></li><li><p>第二列：&lt;客户端ip&gt;(&lt;rw(读写)&gt; | &lt;ro(只读)&gt;,&lt;all_squash(映射为系统账号)&gt;)</p><blockquote><p>系统账号为nfs-nobody（/etc/passwd可查看）</p></blockquote></li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/exports</span><br><span class="line"></span><br><span class="line">/opt/share192.168.0.0/24(rw,all_squash)</span><br></pre></td></tr></table></figure><h2 id="📌重启NFS服务">📌<strong>重启NFS服务</strong></h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">systemctl restart nfs</span><br><span class="line">systemctl status nfs</span><br></pre></td></tr></table></figure><hr><h1 id="3）Linux-NFS-客户端部署">3）Linux NFS 客户端部署</h1><h2 id="📌在客户端安装NFS服务">📌在客户端安装NFS服务</h2><p>这里并不是用于配置服务端，而是让客户端挂载时能够识别服务端的文件系统</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum -y install nfs-utils rpcbind</span><br></pre></td></tr></table></figure><h2 id="📌创建挂载点">📌创建挂载点</h2><p>语法：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mount -t nfs &lt;服务器ip&gt;:&lt;共享的绝对路径&gt; 本地挂载点</span><br></pre></td></tr></table></figure><p>实例：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> /mnt/nfs_share</span><br><span class="line">mount -t nfs 192.168.0.1:/opt/share /mnt/nfs_share</span><br></pre></td></tr></table></figure><hr><h1 id="4）Windows-NFS-客户端部署">4）Windows NFS 客户端部署</h1><h2 id="📌-安装nfs客户端">📌 安装nfs客户端</h2><p>windows一般只有在旗舰版中才有nfs，在服务中安装nfs客户端即可，版本较多自行百度。</p><h2 id="📌-查看NFS服务器共享的信息">📌 查看NFS服务器共享的信息</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">showmount -e 192.168.0.1</span><br></pre></td></tr></table></figure><h2 id="📌挂载">📌挂载</h2><p>注意Windows下的斜杆为撬棍！</p><p>语法：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mount \\&lt;服务器ip&gt;\&lt;共享的绝对路径&gt; 盘符</span><br></pre></td></tr></table></figure><p>实例：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mount \\192.168.0.1\opt\share x:<span class="comment"># 必须使用未使用的盘符</span></span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;meta name=&quot;referrer&quot; content=&quot;no-referrer&quot; /&gt;
&lt;h1 id=&quot;1）这里用一个实例环境来讲解&quot;&gt;1）这里用一个实例环境来讲解&lt;/h1&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;hostname&lt;/th&gt;
&lt;th&gt;ip&lt;/th</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>PassWall的正确设置，利用SmartDNS实现国内外分离</title>
    <link href="https://blog.halfsummer.xyz/posts/d3fb2262.html"/>
    <id>https://blog.halfsummer.xyz/posts/d3fb2262.html</id>
    <published>2023-03-06T10:43:16.000Z</published>
    <updated>2023-03-11T12:51:07.430Z</updated>
    
    <content type="html"><![CDATA[<meta name="referrer" content="no-referrer" /><h1 id="查看本地dns服务的端口">查看本地dns服务的端口</h1><p><img src="https://cos.halfsummer.xyz/pictures/niubb/2023/20230306-640559303e3a7.png" alt="image-20230306110832844"></p><p>这里是6153记下来。</p><hr><h1 id="PassWall配置">PassWall配置</h1><p>📌 启用</p><p><img src="https://cos.halfsummer.xyz/pictures/niubb/2023/20230306-640553f46895a.png" alt="image-20230306104605886"></p><p><img src="https://cos.halfsummer.xyz/pictures/niubb/2023/20230306-640558f7632fc.png" alt="image-20230306110735947"></p><hr><h1 id="SmartDNS配置">SmartDNS配置</h1><p>📌 常规配置页：</p><p><img src="https://cos.halfsummer.xyz/pictures/niubb/2023/20230306-6405542633d0a.png" alt="image-20230306104702793"></p><p><img src="https://cos.halfsummer.xyz/pictures/niubb/2023/20230306-640555bb1b04a.png" alt="image-20230306105347649"></p><p>📌 自己添加DNS服务器：</p><p><img src="https://cos.halfsummer.xyz/pictures/niubb/2023/20230306-6405545242fc2.png" alt="image-20230306104746841"></p><p>📌 重点来了在此我们需要将国内和国外的dns服务器分开：(这里分为CN和GW)</p><p><img src="https://cos.halfsummer.xyz/pictures/niubb/2023/20230306-6405554830079.png" alt="image-20230306105152740"></p><p><img src="https://cos.halfsummer.xyz/pictures/niubb/2023/20230306-64055577e6c99.png" alt="image-20230306105240507"></p><p>📌 在自定义设置中添加：</p><p><img src="https://cos.halfsummer.xyz/pictures/niubb/2023/20230306-640557a0bf385.png" alt="image-20230306110153316"></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">bind</span> <span class="string">:6153</span> <span class="string">-group</span> <span class="string">CN</span></span><br><span class="line"><span class="string">bind</span> <span class="string">:6453</span> <span class="string">-group</span> <span class="string">GW</span> <span class="string">-no-speed-check</span> <span class="string">-no-cache</span></span><br></pre></td></tr></table></figure><p>📌 拉到下方，保存&amp;应用。</p><hr><h1 id="注意事项">注意事项</h1><h2 id="1-PassWall的规则列表">1.PassWall的规则列表</h2><p>这个区域必须要有填写在SmartDNS的地址，没有请自己加上。</p><p><img src="https://cos.halfsummer.xyz/pictures/niubb/2023/20230306-640559e64988b.png" alt="image-20230306111134867"></p><h2 id="2-如果可以访问外网但是不能访问国内">2.如果可以访问外网但是不能访问国内</h2><p>📌 请这样设置</p><p><img src="https://cos.halfsummer.xyz/pictures/niubb/2023/20230306-64055a84a8597.png" alt="image-20230306111413322"></p><p>📌 在试试可以不，如果还不行修改防火墙规则</p><p><img src="https://cos.halfsummer.xyz/pictures/niubb/2023/20230306-64055ad1e8e8a.png" alt="image-20230306111530529"></p><p>添加：（这里eth1是我的网卡，你修改成你的）</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iptables -t nat -I POSTROUTING -o eth1 -j MASQUERADE</span><br></pre></td></tr></table></figure><p>📌 最后在试试，把这两个接受下</p><p><img src="https://cos.halfsummer.xyz/pictures/niubb/2023/20230306-64055b5e4254c.png" alt="image-20230306111750768"></p><h2 id="3-国内外DNS汇总">3.国内外DNS汇总</h2><blockquote><p><strong>国内DNS:</strong><br><strong>阿里公共DNS：</strong><br>223.5.5.5   类型选择：UDP<br>223.6.6.6   类型选择：UDP<br>阿里加密DNS：alidns_ip/dns-query   类型选择：https<br>阿里加密DNS：<a href="http://dns.alidns.com/dns-query">dns.alidns.com/dns-query</a>   类型选择：https<br><strong>腾讯公共DNS:</strong><br>DNS：119.29.29.29  类型选择：UDP<br>腾讯加密DNS：doh.pub/dns-query  类型选择：https<br>腾讯加密DNS：sm2.doh.pub/dns-query  类型选择：https<br><strong>360公共DNS</strong><br>中国电信/铁通/移动：  101.226.4.6   218.30.118.6   类型选择：UDP<br>中国联通：  123.125.81.6      140.207.198.6   类型选择：UDP<br>百度公共DNS：180.76.76.76  类型选择：UDP<br>**114DNS：**114.114.114.114    114.114.115.115   类型选择：UDP</p></blockquote><blockquote><p><strong>国外DNS：</strong><br>**CloudflareDNS：**1.1.1.1   类型选择：UDP<br>Cloudflare加密DNS：1.1.1.1/dns-query   类型选择：tls<br><strong>Google DNS：</strong><br>8.8.8.8      8.8.4.4    类型选择：UDP<br>谷歌加密DNS：dns.google/dns-query   类型选择：https<br>谷歌加密DNS：dns.google   类型选择：tls<br><strong>Norton ConnectSafe：</strong> 199.85.126.10    199.85.127.10  类型选择：UDP<br>威瑞信：64.6.64.6   64.6.65.6  类型选择：UDP<br><strong>Comodo安全DNS：</strong>  8.26.56.2    68.20.247.20  类型选择：UDP<br><strong>DNS Watch：</strong> 84.200.69.80    84.200.70.40  类型选择：UDP<br><strong>Quad9：</strong><br>Quda9加密DNS：<a href="http://dns11.quad9.net/dns-query">dns11.quad9.net/dns-query</a></p></blockquote><p><strong>原理我就不讲解了，照着搬就可以了。</strong></p>]]></content>
    
    
      
      
    <summary type="html">&lt;meta name=&quot;referrer&quot; content=&quot;no-referrer&quot; /&gt;
&lt;h1 id=&quot;查看本地dns服务的端口&quot;&gt;查看本地dns服务的端口&lt;/h1&gt;
&lt;p&gt;&lt;img src=&quot;https://cos.halfsummer.xyz/pictures/niub</summary>
      
    
    
    
    <category term="openwrt" scheme="https://blog.halfsummer.xyz/categories/openwrt/"/>
    
    
  </entry>
  
  <entry>
    <title>Linux三剑客grep、sed、awk</title>
    <link href="https://blog.halfsummer.xyz/posts/b29674f9.html"/>
    <id>https://blog.halfsummer.xyz/posts/b29674f9.html</id>
    <published>2023-03-06T10:16:10.000Z</published>
    <updated>2023-03-11T12:51:07.426Z</updated>
    
    <content type="html"><![CDATA[<meta name="referrer" content="no-referrer" /><h1 id="1）三剑客的特点及应用场景">1）三剑客的特点及应用场景</h1><table><thead><tr><th>命令</th><th>特点</th><th>场景</th></tr></thead><tbody><tr><td>grep</td><td>过滤</td><td>过滤速度是最快的</td></tr><tr><td>sed</td><td>替换，修改文件内容，取行</td><td>如果要进行替换/修改文件内容<br/>取出某个范围的内容</td></tr><tr><td>awk</td><td>取列，统计计算</td><td>取列<br/>对比，比较<br/>统计计算</td></tr></tbody></table><hr><h1 id="2）grep">2）grep</h1><p>grep全拼：Global search Regular expression and Print out the line</p><p>作用，文本搜索工具，根据用户指定的条件对目标文本进行匹配检查并打印匹配的行。</p><p>📌<strong>语法</strong>：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ grep [options] [pattern] file</span><br></pre></td></tr></table></figure><p>📌<strong>选项</strong>：</p><table><thead><tr><th>选项</th><th>作用</th></tr></thead><tbody><tr><td>-E</td><td>相当于egrep，正则</td></tr><tr><td>-A</td><td>after；-A5 匹配你要的内容显示接下来的5行</td></tr><tr><td>-B</td><td>before；-B5 匹配你要的内容显示上面的5行</td></tr><tr><td>-C</td><td>context；-C5 匹配你要的内容显示上下5行</td></tr><tr><td>-c</td><td>只统计匹配到的行数（类似于wc -l）</td></tr><tr><td>-v</td><td>取反（一般用于对自己取反<code>grep -v grep</code>；查询进程时grep也会产生进程）</td></tr><tr><td>-n</td><td>显示行号</td></tr><tr><td>-i</td><td>忽略大小写</td></tr><tr><td>-w</td><td>精确匹配</td></tr></tbody></table><h1 id="3）sed">3）sed</h1><h2 id="3-1-简介">3.1 简介</h2><p>sed是Stream Editor (字符流编辑器)的缩写，简称流编辑器。</p><p>常用功能包括结合正则表达式对文件实现快速增删改查,其中查询的功能中最常用的两大功能是过滤(过滤指定字符串)、取行(取出指定行)。</p><h2 id="3-2-执行过程">3.2 执行过程</h2><p><span style="color:blue;">四个字总结： “找谁干啥”</span></p><p><img src="https://cos.halfsummer.xyz/pictures/niubb/2023/20230308-6407e969a99cc.png" alt="img"></p><h2 id="3-3-语法">3.3 语法</h2><p>📌<strong>语法</strong>：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$ sed [options] <span class="string">&#x27;&#123;command&#125;[flags]&#x27;</span> [filename]    </span><br><span class="line"><span class="comment"># 中括号内容必有 大括号内容可有可无</span></span><br><span class="line">sed  <span class="comment"># 执行命令</span></span><br><span class="line">[options]  <span class="comment"># 命令选项</span></span><br><span class="line">&#123;<span class="built_in">command</span>&#125;[flags]    <span class="comment"># sed内部选项和参数</span></span><br><span class="line">[filename]     <span class="comment"># 文件</span></span><br></pre></td></tr></table></figure><p>📌<strong>选项</strong> <code>options</code>：</p><table border="0">  <tbody>    <tr>      <td>参数</td>      <td>解释</td>    </tr>    <tr>      <td>-n</td>      <td>        取消sed默认输出（默认输出：无论是不是匹配项都输出，即像cat一样把文本内容打印出来），常与sed内置命令p一起使用      </td>    </tr>    <tr>      <td>-i</td>      <td>        直接将修改结果写入文件，不用-i，sed修改的是内存数据而不是修改源文件      </td>    </tr>    <tr>      <td>-e</td>      <td>多次编辑，不再需要管道符了</td>    </tr>    <tr>      <td>-r</td>      <td>支持正则扩展</td>    </tr>  </tbody></table><p>📌<strong>内部命令</strong> <code>command</code>：</p><p>常用：增删改查</p><table>  <tbody>    <tr>      <td style="vertical-align: top">        <p><strong>操作符</strong></p>      </td>      <td style="vertical-align: top; width: 240px">        <p><strong>用途</strong></p>      </td>      <td style="vertical-align: top; width: 192px">        <p><strong>指令示例</strong></p>      </td>      <td style="vertical-align: top">        <p><strong>解释</strong></p>      </td>    </tr>    <tr>      <td rowspan="3" style="vertical-align: top">        <p><strong>s</strong></p>      </td>      <td rowspan="3" style="vertical-align: top; width: 240px">        <p>字符串替换(substitution)</p>      </td>      <td style="vertical-align: top; width: 192px"><p>s/old/new/</p></td>      <td style="vertical-align: top">        <p>将每行的第1&nbsp;个old替换为new</p>      </td>    </tr>    <tr>      <td style="vertical-align: top; width: 192px"><p>s/old/new/3</p></td>      <td style="vertical-align: top">        <p>将每行的第3&nbsp;个old替换为new</p>      </td>    </tr>    <tr>      <td style="vertical-align: top; width: 192px"><p>s/old/new/g</p></td>      <td style="vertical-align: top"><p>将所有的old都替换为new</p></td>    </tr>    <tr>      <td rowspan="2" style="vertical-align: top">        <p><strong>p</strong></p>      </td>      <td rowspan="2" style="vertical-align: top; width: 240px">        <p>打印行（print）</p>      </td>      <td style="vertical-align: top; width: 192px">        <p>2，4p&nbsp;&nbsp;&nbsp;</p>      </td>      <td style="vertical-align: top"><p>输出第2－4行</p></td>    </tr>    <tr>      <td style="vertical-align: top; width: 192px"><p>2p,4p</p></td>      <td style="vertical-align: top"><p>输出第2行、第4行</p></td>    </tr>    <tr>      <td style="vertical-align: top">        <p><strong>d</strong></p>      </td>      <td style="vertical-align: top; width: 240px"><p>删除行（delete）</p></td>      <td style="vertical-align: top; width: 192px"><p>2,4d</p></td>      <td style="vertical-align: top"><p>删除第2－4行</p></td>    </tr>    <tr>      <td rowspan="3" style="vertical-align: top">        <p><strong>cai</strong></p>      </td>      <td rowspan="3" style="vertical-align: top; width: 240px">        <p>取代/新增/插入</p>      </td>      <td style="vertical-align: top; width: 192px"><p>c</p></td>      <td style="vertical-align: top">        <p>c 的后面可以接字串，这些字串可以取代 n1,n2 之间的行</p>      </td>    </tr>    <tr>      <td style="vertical-align: top; width: 192px"><p>a</p></td>      <td style="vertical-align: top">        <p>a 的后面可以接字串，而这些字串会在新的一行出现(目前的下一行)</p>      </td>    </tr>    <tr>      <td style="vertical-align: top; width: 192px"><p>i</p></td>      <td style="vertical-align: top">        <p>i 的后面可以接字串，而这些字串会在新的一行出现(目前的上一行)</p>      </td>    </tr>  </tbody></table><p>📌<strong>sed匹配范围</strong>：</p><table border="0">  <tbody>    <tr>      <td>范围</td>      <td>解释</td>    </tr>    <tr>      <td>空地址</td>      <td>全文处理</td>    </tr>    <tr>      <td>单地址</td>      <td>指定文件某一行</td>    </tr>    <tr>      <td>/pattern/</td>        <td>被模式匹配到的每一行，<span style="color:red;">斜线中表示正则！！！</span></td>    </tr>    <tr>      <td>范围区间</td>      <td>10,20表示10~20行；10，+5第10行向下5行;/pattern1/,/pattern2/</td>    </tr>    <tr>      <td>步长</td>      <td>1~2表示1,3,5,7奇数行，2~2表示2,4,6,8偶数行</td>    </tr>  </tbody></table>## 3.4 应用<h3 id="📌示例">📌示例</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[root@db001 ~]<span class="comment"># cat &gt; test.txt &lt;&lt;EOF </span></span><br><span class="line">1 the quick brown fox jumps over the lazy dog . dog</span><br><span class="line">2 the quick brown fox jumps over the lazy dog . dog</span><br><span class="line">3 the quick brown fox jumps over the lazy dog . dog</span><br><span class="line">4 the quick brown fox jumps over the lazy dog . dog</span><br><span class="line">5 the quick brown fox jumps over the lazy dog . dog</span><br><span class="line">EOF</span><br></pre></td></tr></table></figure><h3 id="📌查找（打印）p">📌查找（打印）<code>p</code></h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#打印test.txt文件内容</span></span><br><span class="line">$ sed <span class="string">&#x27;p&#x27;</span> test.txt</span><br><span class="line">1 the quick brown fox jumps over the lazy dog . dog</span><br><span class="line">1 the quick brown fox jumps over the lazy dog . dog</span><br><span class="line">2 the quick brown fox jumps over the lazy dog . dog</span><br><span class="line">2 the quick brown fox jumps over the lazy dog . dog</span><br><span class="line">3 the quick brown fox jumps over the lazy dog . dog</span><br><span class="line">3 the quick brown fox jumps over the lazy dog . dog</span><br><span class="line">4 the quick brown fox jumps over the lazy dog . dog</span><br><span class="line">4 the quick brown fox jumps over the lazy dog . dog</span><br><span class="line">5 the quick brown fox jumps over the lazy dog . dog</span><br><span class="line">5 the quick brown fox jumps over the lazy dog . dog</span><br><span class="line"></span><br><span class="line"><span class="comment">#打印test.txt文件第三行的内容</span></span><br><span class="line">$ sed <span class="string">&#x27;3p&#x27;</span> test.txt</span><br><span class="line">1 the quick brown fox jumps over the lazy dog . dog</span><br><span class="line">2 the quick brown fox jumps over the lazy dog . dog</span><br><span class="line">3 the quick brown fox jumps over the lazy dog . dog</span><br><span class="line">3 the quick brown fox jumps over the lazy dog . dog</span><br><span class="line">4 the quick brown fox jumps over the lazy dog . dog</span><br><span class="line">5 the quick brown fox jumps over the lazy dog . dog</span><br><span class="line"></span><br><span class="line"><span class="comment">#打印test.txt文件第二、三、四行内容</span></span><br><span class="line">$ sed <span class="string">&#x27;2,4p&#x27;</span> test.txt</span><br><span class="line">1 the quick brown fox jumps over the lazy dog . dog</span><br><span class="line">2 the quick brown fox jumps over the lazy dog . dog</span><br><span class="line">2 the quick brown fox jumps over the lazy dog . dog</span><br><span class="line">3 the quick brown fox jumps over the lazy dog . dog</span><br><span class="line">3 the quick brown fox jumps over the lazy dog . dog</span><br><span class="line">4 the quick brown fox jumps over the lazy dog . dog</span><br><span class="line">4 the quick brown fox jumps over the lazy dog . dog</span><br><span class="line">5 the quick brown fox jumps over the lazy dog . dog</span><br><span class="line"></span><br><span class="line"><span class="comment">#打印test.txt文件包含字符串&quot;3 the&quot;的行</span></span><br><span class="line">$ sed <span class="string">&#x27;/3 the/p&#x27;</span> test.txt</span><br><span class="line">1 the quick brown fox jumps over the lazy dog . dog</span><br><span class="line">2 the quick brown fox jumps over the lazy dog . dog</span><br><span class="line">3 the quick brown fox jumps over the lazy dog . dog</span><br><span class="line">3 the quick brown fox jumps over the lazy dog . dog</span><br><span class="line">4 the quick brown fox jumps over the lazy dog . dog</span><br><span class="line">5 the quick brown fox jumps over the lazy dog . dog </span><br><span class="line"><span class="comment">#可以看得出，打印内容是重复的行，原因是打印了指定文件内容一次，又将读入缓存的所有数据打印了一次，所以会看到这样的效果，如果不想看到这样的结果，可以加命令选项-n抑制内存输出即可。</span></span><br></pre></td></tr></table></figure><h3 id="📌删除-d">📌删除  <code>d</code></h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#删除文件test.txt中的所有数据</span></span><br><span class="line">$ sed <span class="string">&#x27;d&#x27;</span> test.txt</span><br><span class="line"></span><br><span class="line"><span class="comment">#删除文件test.txt中的第三行数据</span></span><br><span class="line">$ sed <span class="string">&#x27;3d&#x27;</span> test.txt</span><br><span class="line">1 the quick brown fox jumps over the lazy dog . dog</span><br><span class="line">2 the quick brown fox jumps over the lazy dog . dog</span><br><span class="line">4 the quick brown fox jumps over the lazy dog . dog</span><br><span class="line">5 the quick brown fox jumps over the lazy dog . dog</span><br><span class="line"></span><br><span class="line"><span class="comment">#删除文件test.txt第三到第四行的数据</span></span><br><span class="line">$ sed <span class="string">&#x27;3,4d&#x27;</span> test.txt</span><br><span class="line">1 the quick brown fox jumps over the lazy dog . dog</span><br><span class="line">2 the quick brown fox jumps over the lazy dog . dog</span><br><span class="line">5 the quick brown fox jumps over the lazy dog . dog</span><br><span class="line"></span><br><span class="line"><span class="comment">#删除文件test.txt中包含字符串&quot;3 the&quot;的行</span></span><br><span class="line">$ sed <span class="string">&#x27;/3 the/d&#x27;</span> test.txt</span><br><span class="line">1 the quick brown fox jumps over the lazy dog . dog</span><br><span class="line">2 the quick brown fox jumps over the lazy dog . dog</span><br><span class="line">4 the quick brown fox jumps over the lazy dog . dog</span><br><span class="line">5 the quick brown fox jumps over the lazy dog . dog</span><br></pre></td></tr></table></figure><h3 id="📌增加-c-a-i">📌增加  <code>c</code> <code>a</code> <code>i</code></h3><p>这里只演示下 <code>a</code> 的用法，其它2个也是相同的语法。<code>a</code> <strong>在新的一行增加</strong>。</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#在每行后追加一行新数据内容: append data &quot;haha&quot;</span></span><br><span class="line">$ sed <span class="string">&#x27;a\append data &quot;haha&quot;&#x27;</span> test.txt<span class="comment">#这里`\`可以用空格，个人习惯用反斜杠增加可读性</span></span><br><span class="line">1 the quick brown fox jumps over the lazy dog . dog</span><br><span class="line">append data <span class="string">&quot;haha&quot;</span></span><br><span class="line">2 the quick brown fox jumps over the lazy dog . dog</span><br><span class="line">append data <span class="string">&quot;haha&quot;</span></span><br><span class="line">3 the quick brown fox jumps over the lazy dog . dog</span><br><span class="line">append data <span class="string">&quot;haha&quot;</span></span><br><span class="line">4 the quick brown fox jumps over the lazy dog . dog</span><br><span class="line">append data <span class="string">&quot;haha&quot;</span></span><br><span class="line">5 the quick brown fox jumps over the lazy dog . dog</span><br><span class="line">append data <span class="string">&quot;haha&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#在第二行后新开一行追加数据: append data &quot;haha&quot;</span></span><br><span class="line">$  sed <span class="string">&#x27;2a\append data &quot;haha&quot;&#x27;</span> test.txt</span><br><span class="line">1 the quick brown fox jumps over the lazy dog . dog</span><br><span class="line">2 the quick brown fox jumps over the lazy dog . dog</span><br><span class="line">append data <span class="string">&quot;haha&quot;</span></span><br><span class="line">3 the quick brown fox jumps over the lazy dog . dog</span><br><span class="line">4 the quick brown fox jumps over the lazy dog . dog</span><br><span class="line">5 the quick brown fox jumps over the lazy dog . dog</span><br><span class="line"></span><br><span class="line"><span class="comment">#在第二到四行每行后新开一行追加数据: append data &quot;haha&quot;</span></span><br><span class="line">$  sed <span class="string">&#x27;2,4a\append data &quot;haha&quot;&#x27;</span> test.txt</span><br><span class="line">1 the quick brown fox jumps over the lazy dog . dog</span><br><span class="line">2 the quick brown fox jumps over the lazy dog . dog</span><br><span class="line">append data <span class="string">&quot;haha&quot;</span></span><br><span class="line">3 the quick brown fox jumps over the lazy dog . dog</span><br><span class="line">append data <span class="string">&quot;haha&quot;</span></span><br><span class="line">4 the quick brown fox jumps over the lazy dog . dog</span><br><span class="line">append data <span class="string">&quot;haha&quot;</span></span><br><span class="line">5 the quick brown fox jumps over the lazy dog . dog</span><br><span class="line"></span><br><span class="line"><span class="comment">#匹配字符串追加: 找到包含&quot;3 the&quot;的行，在其后新开一行追加内容: append data &quot;haha&quot;</span></span><br><span class="line">$  sed <span class="string">&#x27;/3 the/a\append data &quot;haha&quot;&#x27;</span> test.txt</span><br><span class="line">1 the quick brown fox jumps over the lazy dog . dog</span><br><span class="line">2 the quick brown fox jumps over the lazy dog . dog</span><br><span class="line">3 the quick brown fox jumps over the lazy dog . dog</span><br><span class="line">append data <span class="string">&quot;haha&quot;</span></span><br><span class="line">4 the quick brown fox jumps over the lazy dog . dog</span><br><span class="line">5 the quick brown fox jumps over the lazy dog . dog</span><br></pre></td></tr></table></figure><h3 id="📌替换-s">📌替换  <code>s</code></h3><blockquote><table><thead><tr><th>flags</th><th>说明</th><th>指令示例</th><th>解释</th></tr></thead><tbody><tr><td>数字</td><td>表示新文本替换的模式</td><td>s###3</td><td>表示每行的第3个</td></tr><tr><td>g</td><td>表示用新文本替换现有文本的全部实例</td><td></td><td></td></tr><tr><td>p</td><td>表示打印原始的内容</td><td></td><td></td></tr><tr><td>w filename</td><td>将替换的结果写入文件</td><td></td><td></td></tr></tbody></table></blockquote><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#如果一行中有多个符合的字符串，如果没有标志位定义，那么只会替换第一个字符串，其他的就被忽略掉了，为了能精确替换，可以使用数字位做定义。</span></span><br><span class="line"><span class="comment">#替换一行中的第二处dog为cat</span></span><br><span class="line">$ sed <span class="string">&#x27;s/dog/cat/2&#x27;</span> test.txt</span><br><span class="line">1 the quick brown fox jumps over the lazy dog . <span class="built_in">cat</span></span><br><span class="line">2 the quick brown fox jumps over the lazy dog . <span class="built_in">cat</span></span><br><span class="line">3 the quick brown fox jumps over the lazy dog . <span class="built_in">cat</span></span><br><span class="line">4 the quick brown fox jumps over the lazy dog . <span class="built_in">cat</span></span><br><span class="line">5 the quick brown fox jumps over the lazy dog . <span class="built_in">cat</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#g标志:将一行中的所有符合的字符串全部执行替换</span></span><br><span class="line"><span class="comment">#将data1文件中的所有dog替换为cat</span></span><br><span class="line">$ sed <span class="string">&#x27;s/dog/cat/g&#x27;</span> test.txt</span><br><span class="line">1 the quick brown fox jumps over the lazy <span class="built_in">cat</span> . <span class="built_in">cat</span></span><br><span class="line">2 the quick brown fox jumps over the lazy <span class="built_in">cat</span> . <span class="built_in">cat</span></span><br><span class="line">3 the quick brown fox jumps over the lazy <span class="built_in">cat</span> . <span class="built_in">cat</span></span><br><span class="line">4 the quick brown fox jumps over the lazy <span class="built_in">cat</span> . <span class="built_in">cat</span></span><br><span class="line">5 the quick brown fox jumps over the lazy <span class="built_in">cat</span> . <span class="built_in">cat</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#p标志：打印文本内容，类似于-p命令选项</span></span><br><span class="line">$ sed  <span class="string">&#x27;3s/dog/cat/p&#x27;</span> test.txt</span><br><span class="line">1 the quick brown fox jumps over the lazy dog . dog</span><br><span class="line">2 the quick brown fox jumps over the lazy dog . dog</span><br><span class="line">3 the quick brown fox jumps over the lazy <span class="built_in">cat</span> . dog</span><br><span class="line">3 the quick brown fox jumps over the lazy <span class="built_in">cat</span> . dog</span><br><span class="line">4 the quick brown fox jumps over the lazy dog . dog</span><br><span class="line">5 the quick brown fox jumps over the lazy dog . dog</span><br><span class="line"></span><br><span class="line"><span class="comment">#w filename标志:将修改的内容存入filename文件中</span></span><br><span class="line">$ sed  <span class="string">&#x27;3s/dog/cat/w text&#x27;</span> test.txt</span><br><span class="line">1 the quick brown fox jumps over the lazy dog . dog</span><br><span class="line">2 the quick brown fox jumps over the lazy dog . dog</span><br><span class="line">3 the quick brown fox jumps over the lazy <span class="built_in">cat</span> . dog</span><br><span class="line">4 the quick brown fox jumps over the lazy dog . dog</span><br><span class="line">5 the quick brown fox jumps over the lazy dog . dog</span><br></pre></td></tr></table></figure><h3 id="⭐其它用法">⭐其它用法</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#$=统计test.txt有多少行</span></span><br><span class="line">$ sed -n <span class="string">&#x27;$=&#x27;</span> test.txt</span><br><span class="line">5</span><br><span class="line"></span><br><span class="line"><span class="comment">#打印test.txt内容时加上行号</span></span><br><span class="line">$ sed  <span class="string">&#x27;=&#x27;</span> test.txt</span><br><span class="line">1</span><br><span class="line">1 the quick brown fox jumps over the lazy dog . dog</span><br><span class="line">2</span><br><span class="line">2 the quick brown fox jumps over the lazy dog . dog</span><br><span class="line">3</span><br><span class="line">3 the quick brown fox jumps over the lazy dog . dog</span><br><span class="line">4</span><br><span class="line">4 the quick brown fox jumps over the lazy dog . dog</span><br><span class="line">5</span><br><span class="line">5 the quick brown fox jumps over the lazy dog . dog</span><br><span class="line"></span><br><span class="line"><span class="comment">#输出包含the的所在行的行号（= 用来输出行号）</span></span><br><span class="line">$ sed -n <span class="string">&#x27;/the/=&#x27;</span> test.txt </span><br><span class="line"></span><br><span class="line"><span class="comment">#输出以PI开头的行</span></span><br><span class="line">$ sed -n <span class="string">&#x27;/^PI/p&#x27;</span> test.txt </span><br><span class="line"></span><br><span class="line"><span class="comment">#输出以数字结尾的行</span></span><br><span class="line">$ sed -n <span class="string">&#x27;/[0-9]$/p&#x27;</span> test.txt </span><br><span class="line"></span><br><span class="line"><span class="comment">#输出包含单词wood的行 \&lt; ,\&gt;表示单词边界</span></span><br><span class="line">$ sed -n <span class="string">&#x27;/\&lt;wood\&gt;/p&#x27;</span> test.txt </span><br><span class="line">a wood cross!</span><br><span class="line"></span><br><span class="line"><span class="comment">#每行开始添加#字符</span></span><br><span class="line">$ sed <span class="string">&#x27;s/^/#/&#x27;</span> test.txt </span><br><span class="line"></span><br><span class="line"><span class="comment">#在包含the的每行行首添加#字符</span></span><br><span class="line">$ sed <span class="string">&#x27;/the/s/^/#/&#x27;</span> test.txt </span><br><span class="line"></span><br><span class="line"><span class="comment">#在每行末尾添加EOF字符</span></span><br><span class="line">$ sed <span class="string">&#x27;s/$/EOF/&#x27;</span> test.txt </span><br><span class="line"></span><br><span class="line"><span class="comment">#将3-5行所有的the替换为THE  </span></span><br><span class="line">$ sed <span class="string">&#x27;3,5s/the/THE/g&#x27;</span> test.txt </span><br><span class="line"></span><br><span class="line"><span class="comment">#将包含the的行中的o替换为O</span></span><br><span class="line">$ sed <span class="string">&#x27;/the/s/o/O/g&#x27;</span> test.txt </span><br></pre></td></tr></table></figure><h3 id="⭐迁移符合条件的文本">⭐迁移符合条件的文本</h3><blockquote><p>H 复制到剪贴板；</p><p>g，G 将剪贴板中的数据覆盖/追加到指定行；</p><p>w保存为文件；</p><p>r读取指定文件；</p><p>a 追加指定内容。</p><p>l, i:忽略大小写</p></blockquote><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#将包含1的行迁移到行尾（H复制到剪贴板---d删除---$G追加到行尾---&quot;；&quot;用于多个操作)</span></span><br><span class="line">$ sed <span class="string">&#x27;/1/&#123;H;d&#125;;$G&#x27;</span> test.txt | sed <span class="string">&#x27;/^$/d&#x27;</span></span><br><span class="line">2 the quick brown fox jumps over the lazy dog . dog</span><br><span class="line">3 the quick brown fox jumps over the lazy dog . dog</span><br><span class="line">4 the quick brown fox jumps over the lazy dog . dog</span><br><span class="line">5 the quick brown fox jumps over the lazy dog . dog</span><br><span class="line">1 the quick brown fox jumps over the lazy dog . dog</span><br><span class="line"></span><br><span class="line"><span class="comment">#将1-3行迁移到5行后</span></span><br><span class="line">$ sed <span class="string">&#x27;1,3&#123;H;d&#125;;5G&#x27;</span> test.txt</span><br><span class="line">4 the quick brown fox jumps over the lazy dog . dog</span><br><span class="line">5 the quick brown fox jumps over the lazy dog . dog</span><br><span class="line"></span><br><span class="line">1 the quick brown fox jumps over the lazy dog . dog</span><br><span class="line">2 the quick brown fox jumps over the lazy dog . dog</span><br><span class="line">3 the quick brown fox jumps over the lazy dog . dog</span><br><span class="line"></span><br><span class="line"><span class="comment">#在包含the每行后添加文件hostname内容</span></span><br><span class="line">$ sed <span class="string">&#x27;/the/r /etc/hostname&#x27;</span> test.txt </span><br><span class="line"></span><br><span class="line"><span class="comment">#在第3行后插入新行，内容为New</span></span><br><span class="line">$ sed <span class="string">&#x27;3aNew&#x27;</span> test.txt </span><br><span class="line"></span><br><span class="line"><span class="comment">#在包含the的每行后插入新行</span></span><br><span class="line">$ sed <span class="string">&#x27;/the/aNew&#x27;</span> test.txt </span><br><span class="line"></span><br><span class="line"><span class="comment">#在第3行后插入多行（\n 换行符）</span></span><br><span class="line">$ sed <span class="string">&#x27;3aNew1\nNew2&#x27;</span> test.txt </span><br></pre></td></tr></table></figure><h3 id="⭐-后向引用，反向引用（括号先保护在使用）">⭐ <strong>后向引用</strong>，<strong>反向引用</strong>（括号先保护在使用）</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">echo</span> 123456 | sed -r <span class="string">&#x27;s#(.*)#&lt;/1&gt;#g&#x27;</span></span><br><span class="line">&lt;123456&gt;</span><br></pre></td></tr></table></figure><hr><h1 id="4）awk">4）awk</h1><h2 id="4-1-简介">4.1 简介</h2><p>awk在其对数据分析并生成报告时，显得尤为强大。简单来说awk就是把文件逐行的读入，以空格为默认分隔符将每行切片，切开的部分再进行各种分析处理。</p><h2 id="4-2-执行过程">4.2 执行过程</h2><p><span style="color:blue;">找谁{干啥}，条件{动作}，pattern{action}</span></p><h2 id="4-3-语法">4.3 语法</h2><p>📌<strong>语法</strong>：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">awk <span class="string">&#x27;pattern&#123;action&#125;&#x27;</span> &#123;filenames&#125;</span><br></pre></td></tr></table></figure><h2 id="4-4基础用法">4.4基础用法</h2><ul><li><p><strong>行row</strong>：在awk中叫记录（record）。每一行默认通过回车分割。</p></li><li><p><strong>列column</strong>：在awk中叫字段，域（field）。每一列默认通过空格分割。</p></li></ul><h3 id="📌取行">📌<strong>取行</strong></h3><table><thead><tr><th>内置变量</th><th>说明</th></tr></thead><tbody><tr><td>NR==1</td><td>取出第一行</td></tr><tr><td>NR&gt;=1 &amp;&amp; NR&lt;=5</td><td>取出第一行至第五行</td></tr><tr><td>/正则/</td><td>取出匹配条件的行</td></tr><tr><td>//，//</td><td>取出多条匹配条件，并逐行显示</td></tr></tbody></table><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ awk -F: <span class="string">&#x27;NR==1&#x27;</span> /etc/passwd</span><br></pre></td></tr></table></figure><h3 id="📌取列">📌<strong>取列</strong></h3><table><thead><tr><th>内置变量</th><th>说明</th><th></th></tr></thead><tbody><tr><td>-F :</td><td>同<code>-v FS=:</code>读取时指定每一列的分隔符为<code>：</code>（默认空格，连续空格，tab）</td><td></td></tr><tr><td>$数字</td><td>取出某一列,awk中$只表示取列</td><td></td></tr><tr><td>$0</td><td>整行内容</td><td></td></tr><tr><td>$NF</td><td>取出最后一列</td><td></td></tr><tr><td>-vOFS=:</td><td>写入时格式化输出分隔符为<code>:</code></td><td></td></tr></tbody></table><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 将末尾列和第一列对调</span></span><br><span class="line">$ awk -F: <span class="string">&#x27;NR==1 &#123;print $NF,$2,$3,$4,$5,$6,$1&#125;&#x27;</span> /etc/passwd</span><br><span class="line">/bin/bash x 0 0 root /root root</span><br></pre></td></tr></table></figure><h2 id="4-5-条件匹配">4.5 条件匹配</h2><table><caption>表 1 awk支持的主要条件类型</caption><tbody><tr><th>条件类型</th><th>条&nbsp;件</th><th>说&nbsp;明</th></tr><tr><td>awk保留字</td><td>BEGIN</td><td>在 awk 程序一开始，尚未读取任何数据之前执行。BEGIN 后的动作只在程序开始时执行一次</td></tr><tr><td>awk保留字</td><td>END</td><td>在 awk 程序处理完所有数据，即将结束时执行?END 后的动作只在程序结束时执行一次</td></tr><tr><td rowspan="8">关系运算符</td><td>&gt;</td><td>大于</td></tr><tr><td>&lt;</td><td>小于</td></tr><tr><td>&gt;=</td><td>大于等于</td></tr><tr><td>&lt;=</td><td>小于等于</td></tr><tr><td>==</td><td>等于。用于判断两个值是否相等。如果是给变童赋值，则使用"=”</td></tr><tr><td>!=</td><td>不等于</td></tr><tr><td>A~B</td><td>判断字符串 A 中是否包含能匹配 B 表达式的子字符串</td></tr><tr><td>A!~B</td><td>判断字符串 A 中是否不包含能匹配 B 表达式的子字符串</td></tr><tr><td>正则表达式</td><td>/正则/</td><td>如果在“//”中可以写入字符，则也可以支持正则表达式</td></tr></tbody></table><h3 id="📌BEGIN">📌BEGIN</h3><p>BEGIN 是 awk 的保留字，是一种特殊的条件类型。BEGIN 的执行时机是&quot;在 awk 程序一开始，尚未读取任何数据之前&quot;。一旦 BEGIN 后的动作执行一次，当 awk 开始从文件中读入数据时，BEGIN 的条件就不再成立。</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">$ awk <span class="string">&#x27;BEGIN&#123;printf &quot;This is a transcript\n&quot;&#125; &#123;printf $2 &quot;\t&quot; $6 &quot;\n&quot;&#125;&#x27;</span> student.txt</span><br><span class="line"><span class="comment">#awk命令只要检测不到完整的单引号就不会执行，所以这条命令的换行不用加入&quot;\&quot;，就是一行命令</span></span><br><span class="line"><span class="comment">#这里定义了两个动作</span></span><br><span class="line"><span class="comment">#第一个动作使用BEGIN条件，所以会在读入文件数据前打印&quot;这是一张成绩单&quot;（只会执行一次）</span></span><br><span class="line"><span class="comment">#第二个动作会打印文件的第二个字段和第六个字段</span></span><br><span class="line">This is a transcript</span><br><span class="line">Name Average</span><br><span class="line">Liming 87.66</span><br><span class="line">Sc 85.66</span><br><span class="line">Gao 91.66</span><br></pre></td></tr></table></figure><h3 id="📌END">📌END</h3><p>END 也是 awk 的保留字，不过刚好和 BEGIN 相反。END 是在 awk 程序处理完所有数据，即将结束时执行的。END 后的动作只在程序结束时执行一次。</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$ awk <span class="string">&#x27;END&#123;printf &quot;The End&quot;&#125; &#123;printf $2 &quot;\t&quot; $6 &quot;\n&quot;&#125;&#x27;</span> student.txt</span><br><span class="line"><span class="comment">#输出结尾输入&quot;The End&quot;，这并不是文档本身的内容，而且只会执行一次</span></span><br><span class="line">Name Average</span><br><span class="line">Liming 87.66</span><br><span class="line">Sc 85.66</span><br><span class="line">Gao 91.66</span><br><span class="line">The End</span><br></pre></td></tr></table></figure><h3 id="📌关系运算符">📌关系运算符</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">cat</span> student.txt | grep -v Name |awk<span class="string">&#x27;$6 &gt;= 87 &#123;printf $2&#x27;</span>\n<span class="string">&quot;&#125;&#x27;</span></span><br><span class="line"><span class="string">#使用cat输出文件内容，用grep取反包含&quot;</span>Name<span class="string">&quot;的行</span></span><br><span class="line"><span class="string">#判断第六个字段（平均成绩）大于等于87分的行，如果判断式成立，则打印第六列（学员名）</span></span><br><span class="line"><span class="string">Liming</span></span><br><span class="line"><span class="string">Gao</span></span><br></pre></td></tr></table></figure><h3 id="📌正则表达式">📌正则表达式</h3><p>如果想让 awk 识别字符串，则必须使用&quot;//&quot;包含</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ awk <span class="string">&#x27;/Liming/ &#123;print&#125;&#x27;</span> student.txt</span><br><span class="line"><span class="comment">#打印Liming的成绩</span></span><br><span class="line">1 Liming 82 95 86 87.66</span><br></pre></td></tr></table></figure><p>当使用 df 命令査看分区的使用情况时，如果我只想査看真正的系统分区的使用情况，而不想査看光盘和临时分区的使用情况，则可以这样做</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">df</span> -h | awk <span class="string">&#x27;/sda[0-9]/ &#123;printf $1 &quot;\t&quot; $5 &quot;\n&quot;&#125;&#x27;</span></span><br><span class="line"><span class="comment">#查询包含&quot;sda数字&quot;的行，并打印第一个字段和第五个字段</span></span><br><span class="line">/dev/sda2       12%</span><br><span class="line">/dev/sda1       42%</span><br></pre></td></tr></table></figure><h2 id="4-6数组">4.6数组</h2><p>📌建立数组</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">array[index] = value <span class="comment">#数组名array，下标index以及相应的值value。</span></span><br></pre></td></tr></table></figure><p>📌读取数组值</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#123;<span class="keyword">for</span> (item <span class="keyword">in</span> array)  <span class="built_in">print</span> array[item]&#125; <span class="comment"># 输出的顺序是随机的</span></span><br><span class="line">&#123;<span class="keyword">for</span>(i=1;i&lt;=len;i++)  <span class="built_in">print</span> array[i]&#125; <span class="comment"># Len 是数组的长度</span></span><br></pre></td></tr></table></figure><p>4.7 循环</p><p>4.8 判断</p>]]></content>
    
    
      
      
    <summary type="html">&lt;meta name=&quot;referrer&quot; content=&quot;no-referrer&quot; /&gt;
&lt;h1 id=&quot;1）三剑客的特点及应用场景&quot;&gt;1）三剑客的特点及应用场景&lt;/h1&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;命令&lt;/th&gt;
&lt;th&gt;特点&lt;/th&gt;
&lt;th&gt;场景</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>OpenWRT旁路由环境下使用Cloudflare动态DNS（DDNS）服务</title>
    <link href="https://blog.halfsummer.xyz/posts/80ad88a9.html"/>
    <id>https://blog.halfsummer.xyz/posts/80ad88a9.html</id>
    <published>2023-03-03T10:54:15.000Z</published>
    <updated>2023-03-11T12:51:07.426Z</updated>
    
    <content type="html"><![CDATA[<meta name="referrer" content="no-referrer" /><p><strong>服务 -&gt; 动态dns -&gt; ipv4修改</strong>：（没有则自己新建）</p><p><img src="https://images.halfsummer.xyz/i/pictures/niubb/2023/20230303-640161d865334.png" alt="image-20230303105616266"></p><p><strong>基本设置</strong>：</p><ul><li>域名处要注意使用<code>@</code>符分割。</li><li>用户名使用登入邮箱</li><li>密码要使用全局秘钥</li></ul><p><img src="https://images.halfsummer.xyz/i/pictures/niubb/2023/20230303-6401631b56a31.png" alt="image-20230303110146012"></p><p><strong>高级设置</strong>：</p><p>旁路由模式需要修改为url。</p><p><img src="https://images.halfsummer.xyz/i/pictures/niubb/2023/20230303-640163c646e3e.png" alt="image-20230303110436747"></p><p><strong>保存修改即可</strong></p>]]></content>
    
    
      
      
    <summary type="html">&lt;meta name=&quot;referrer&quot; content=&quot;no-referrer&quot; /&gt;
&lt;p&gt;&lt;strong&gt;服务 -&amp;gt; 动态dns -&amp;gt; ipv4修改&lt;/strong&gt;：（没有则自己新建）&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://images.hal</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>正则表达式学习笔记</title>
    <link href="https://blog.halfsummer.xyz/posts/7cb564cd.html"/>
    <id>https://blog.halfsummer.xyz/posts/7cb564cd.html</id>
    <published>2023-03-03T10:16:10.000Z</published>
    <updated>2023-03-11T12:51:07.430Z</updated>
    
    <content type="html"><![CDATA[<meta name="referrer" content="no-referrer" /><h1 id="Regular-Expression（正则表达式）">Regular Expression（正则表达式）</h1><p><a href="https://jex.im/regulex/#!flags=&amp;re=%5E(a%7Cb)*%3F%24">可视化工具</a></p><h2 id="一、基础正则表达式">一、基础正则表达式</h2><h3 id="1-字符">1.字符</h3><table>  <tbody>    <tr>      <td><strong>表达式</strong></td>      <td><strong>描述</strong></td>    </tr>    <tr>      <td><code>[abc]</code></td>      <td>字符集。匹配集合中所含的任一字符。</td>    </tr>    <tr>      <td><code>[^abc]</code></td>      <td>否定字符集。匹配任何不在集合中的字符。</td>    </tr>    <tr>      <td><code>[a-z]</code></td>      <td>字符范围。匹配指定范围内的任意字符。</td>    </tr>    <tr>      <td><code>.</code></td>      <td>匹配除换行符以外的任何单个字符。</td>    </tr>    <tr>      <td><code>\</code></td>      <td>转义字符。</td>    </tr>    <tr>      <td><code>\w</code></td>      <td>匹配任何字母、数字，包括下划线（等价于<code>[A-Za-z0-9_]</code>）。</td>    </tr>    <tr>      <td><code>\W</code></td>      <td>匹配任何非字母、数字（等价于<code>[^A-Za-z0-9_]</code>）。</td>    </tr>    <tr>      <td><code>\d</code></td>      <td>数字。匹配任何数字。</td>    </tr>    <tr>      <td><code>\D</code></td>      <td>非数字。匹配任何非数字字符。</td>    </tr>    <tr>      <td><code>\s</code></td>      <td>空白。匹配任何空白字符，包括空格、制表符等。</td>    </tr>    <tr>      <td><code>\S</code></td>      <td>非空白。匹配任何非空白字符。</td>    </tr>  </tbody></table><h3 id="2-分组和引用">2.分组和引用</h3><table>  <tbody>    <tr>      <td><strong>表达式</strong></td>      <td><strong>描述</strong></td>    </tr>    <tr>      <td><code>(expression)</code></td>      <td>分组。匹配括号里的整个表达式。</td>    </tr>    <tr>      <td><code>(?:expression)</code></td>      <td>        非捕获分组。匹配括号里的整个字符串但不获取匹配结果，拿不到分组引用。      </td>    </tr>    <tr>      <td><code>\num</code></td>      <td>        对前面所匹配分组的引用。比如<code>(\d)\1</code>可以匹配两个相同的数字，<code>(Code)(Sheep)\1\2</code>则可以匹配<code>CodeSheepCodeSheep</code>。      </td>    </tr>  </tbody></table><h3 id="3-锚点-边界">3.锚点/边界</h3><table>  <tbody>    <tr>      <td><strong>表达式</strong></td>      <td><strong>描述</strong></td>    </tr>    <tr>      <td><code>^</code></td>      <td>匹配字符串或行开头。</td>    </tr>    <tr>      <td><code>$</code></td>      <td>匹配字符串或行结尾。</td>    </tr>    <tr>      <td><code>\b</code></td>      <td>        匹配单词边界。比如<code>Sheep\b</code>可以匹配<code>CodeSheep</code>末尾的<code>Sheep</code>，不能匹配<code>CodeSheepCode</code>中的<code          >Sheep</code        >      </td>    </tr>    <tr>      <td><code>\B</code></td>      <td>        匹配非单词边界。比如<code>Code\B</code>可以匹配<code>HelloCodeSheep</code>中的<code>Code</code>，不能匹配<code>HelloCode</code>中的<code>Code</code>。      </td>    </tr>  </tbody></table><h3 id="4-数量表示">4.数量表示</h3><table>  <tbody>    <tr>      <td><strong>表达式</strong></td>      <td><strong>描述</strong></td>    </tr>    <tr>      <td><code>?</code></td>      <td>匹配前面的表达式0个或1个。即表示可选项。</td>    </tr>    <tr>      <td><code>+</code></td>      <td>匹配前面的表达式至少1个。</td>    </tr>    <tr>      <td><code>*</code></td>      <td>匹配前面的表达式0个或多个。</td>    </tr>    <tr>      <td><code>|</code></td>      <td>或运算符。并集，可以匹配符号前后的表达式。</td>    </tr>    <tr>      <td><code>&#123;m&#125;</code></td>      <td>匹配前面的表达式m个。</td>    </tr>    <tr>      <td><code>&#123;m,&#125;</code></td>      <td>匹配前面的表达式最少m个。</td>    </tr>    <tr>      <td><code>&#123;m,n&#125;</code></td>      <td>匹配前面的表达式最少m个，最多n个。</td>    </tr>  </tbody></table><h3 id="5-预查断言">5.预查断言</h3><table>  <tbody>    <tr>      <td><strong>表达式</strong></td>      <td><strong>描述</strong></td>    </tr>    <tr>      <td><code>(?=)</code></td>      <td>        正向预查。比如<code>Code(?=Sheep)</code>能匹配<code>CodeSheep</code>中的<code>Code</code>，但不能匹配<code>CodePig</code>中的<code>Code</code>。      </td>    </tr>    <tr>      <td><code>(?!)</code></td>      <td>        正向否定预查。比如<code>Code(?!Sheep)</code>不能匹配<code>CodeSheep</code>中的<code>Code</code>，但能匹配<code>CodePig</code>中的<code>Code</code>。      </td>    </tr>    <tr>      <td><code>(?&lt;=)</code></td>      <td>        反向预查。比如<code>(?&lt;=Code)Sheep</code>能匹配<code>CodeSheep</code>中的<code>Sheep</code>，但不能匹配<code>ReadSheep</code>中的<code>Sheep</code>。      </td>    </tr>    <tr>      <td><code>(?&lt;!)</code></td>      <td>        反向否定预查。比如<code>(?&lt;!Code)Sheep</code>不能匹配<code>CodeSheep</code>中的<code>Sheep</code>，但能匹配<code>ReadSheep</code>中的<code>Sheep</code>。      </td>    </tr>  </tbody></table><h3 id="6-特殊标志">6.特殊标志</h3><table>  <tbody>    <tr>      <td><strong>表达式</strong></td>      <td><strong>描述</strong></td>    </tr>    <tr>      <td><code>/.../i</code></td>      <td>忽略大小写。</td>    </tr>    <tr>      <td><code>/.../g</code></td>      <td>全局匹配。</td>    </tr>    <tr>      <td><code>/.../m</code></td>      <td>多行修饰符。用于多行匹配。</td>    </tr>  </tbody></table><h2 id="二、常用正则表达式">二、常用正则表达式</h2><h3 id="1-数字效验">1.数字效验</h3><table>  <tbody>    <tr>      <td><strong>描述</strong></td>      <td><strong>正则表达式</strong></td>      <td><strong>备注</strong></td>    </tr>    <tr>      <td>数字</td>      <td><code>^[0-9]*$</code></td>      <td></td>    </tr>    <tr>      <td>n位数字</td>      <td><code>^\d&#123;n&#125;$</code></td>      <td></td>    </tr>    <tr>      <td>至少n位数字</td>      <td><code>^\d&#123;n,&#125;$</code></td>      <td></td>    </tr>    <tr>      <td>m~n位数字</td>      <td><code>^\d&#123;m,n&#125;$</code></td>      <td></td>    </tr>    <tr>      <td>整数</td>      <td><code>^(-?[1-9]\d*)$</code></td>      <td>非0开头，包括正整数和负整数</td>    </tr>    <tr>      <td>正整数</td>      <td><code>^[1-9]\d*$</code></td>      <td></td>    </tr>    <tr>      <td>负整数</td>      <td><code>^-[1-9]\d*$</code></td>      <td></td>    </tr>    <tr>      <td>非负整数</td>      <td><code>^(([1-9]\d*)|0)$</code></td>      <td></td>    </tr>    <tr>      <td>非正整数</td>      <td><code>^((-[1-9]\d*)|0)$</code></td>      <td></td>    </tr>    <tr>      <td>浮点数</td>      <td><code>^-?(?:[1-9]\d*\.\d*|0\.\d*[1-9]\d*|0\.0+|0)$</code></td>      <td>包括正浮点数和负浮点数</td>    </tr>    <tr>      <td>正浮点数</td>      <td><code>^(?:[1-9]\d*\.\d*|0\.\d*[1-9]\d*)$</code></td>      <td></td>    </tr>    <tr>      <td>负浮点数</td>      <td><code>^-(?:[1-9]\d*\.\d*|0\.\d*[1-9]\d*)$</code></td>      <td></td>    </tr>    <tr>      <td>非正浮点数</td>      <td><code>^(?:-(?:[1-9]\d*\.\d+|0\.\d*[1-9]\d*)|0\.0+|0)$</code></td>      <td>包含0</td>    </tr>    <tr>      <td>非负浮点数</td>      <td><code>^(?:[1-9]\d*\.\d+|0\.\d+|0\.0+|0)$</code></td>      <td>包含0</td>    </tr>    <tr>      <td>仅一位小数</td>      <td><code>^-?(?:0|[1-9][0-9]*)\.[0-9]&#123;1&#125;$</code></td>      <td></td>    </tr>    <tr>      <td>最少一位小数</td>      <td><code>^-?(?:0|[1-9][0-9]*)\.[0-9]&#123;1,&#125;$</code></td>      <td></td>    </tr>    <tr>      <td>最多两位小数</td>      <td><code>^-?(?:0|[1-9][0-9]*)\.[0-9]&#123;1,2&#125;$</code></td>      <td></td>    </tr>    <tr>      <td>连续重复的数字</td>      <td><code>^(\d)\1+$</code></td>      <td>例如：<code>111</code>，<code>222</code></td>    </tr>  </tbody></table><h3 id="2-字符校验">2.字符校验</h3><table>  <tbody>    <tr>      <td><strong>描述</strong></td>      <td><strong>正则表达式</strong></td>      <td><strong>备注</strong></td>    </tr>    <tr>      <td>中文</td>      <td><code>^[\u4E00-\u9FA5]+$</code></td>      <td></td>    </tr>    <tr>      <td>全角字符</td>      <td><code>^[\uFF00-\uFFFF]+$</code></td>      <td></td>    </tr>    <tr>      <td>半角字符</td>      <td><code>^[\u0000-\u00FF]+$</code></td>      <td></td>    </tr>    <tr>      <td>英文字符串（大写）</td>      <td><code>^[A-Z]+$</code></td>      <td></td>    </tr>    <tr>      <td>英文字符串（小写）</td>      <td><code>^[a-z]+$</code></td>      <td></td>    </tr>    <tr>      <td>英文字符串（不区分大小写）</td>      <td><code>^[A-Za-z]+$</code></td>      <td></td>    </tr>    <tr>      <td>中文和数字</td>      <td><code>^(?:[\u4E00-\u9FA5]&#123;0,&#125;|\d)+$</code></td>      <td></td>    </tr>    <tr>      <td>英文和数字</td>      <td><code>^[A-Za-z0-9]+$</code></td>      <td></td>    </tr>    <tr>      <td>数字、英文字母或者下划线组成的字符串</td>      <td><code>^\w+$</code></td>      <td></td>    </tr>    <tr>      <td>中文、英文、数字包括下划线</td>      <td><code>^[\u4E00-\u9FA5\w]+$</code></td>      <td></td>    </tr>    <tr>      <td>不含字母的字符串</td>      <td><code>^[^A-Za-z]*$</code></td>      <td></td>    </tr>    <tr>      <td>连续重复的字符串</td>      <td><code>^(.)\1+$</code></td>      <td>例如：<code>aa</code>，<code>bb</code></td>    </tr>    <tr>      <td>长度为n的字符串</td>      <td><code>^.&#123;n&#125;$</code></td>      <td></td>    </tr>    <tr>      <td>ASCII</td>      <td><code>^[ -~]$</code></td>      <td></td>    </tr>  </tbody></table><h3 id="3-日期与时间校验">3.日期与时间校验</h3><table>  <tbody>    <tr>      <td><strong>描述</strong></td>      <td><strong>正则表达式</strong></td>      <td><strong>备注</strong></td>    </tr>    <tr>      <td>日期</td>      <td>        <code>^\d&#123;1,4&#125;-(?:1[0-2]|0?[1-9])-(?:0?[1-9]|[1-2]\d|30|31)$</code>      </td>      <td>弱校验，例如：<code>2022-06-12</code></td>    </tr>    <tr>      <td>日期</td>      <td>        <code          >^(?:(?!0000)[0-9]&#123;4&#125;-(?:(?:0[1-9]|1[0-2])-(?:0[1-9]|1[0-9]|2[0-8])|(?:0[13-9]|1[0-2])-(?:29|30)|(?:0[13578]|1[02])-31)|(?:[0-9]&#123;2&#125;(?:0[48]|[2468][048]|[13579][26])|(?:0[48]|[2468][048]|[13579][26])00)-02-29)$</code        >      </td>      <td>严格校验，考虑平闰年</td>    </tr>    <tr>      <td>时间</td>      <td><code>^(?:1[0-2]|0?[1-9]):[0-5]\d:[0-5]\d$</code></td>      <td>12小时制，例如：<code>11:21:31</code></td>    </tr>    <tr>      <td>时间</td>      <td><code>^(?:[01]\d|2[0-3]):[0-5]\d:[0-5]\d$</code></td>      <td>24小时制，例如：<code>23:21:31</code></td>    </tr>    <tr>      <td>日期+时间</td>      <td>        <code          >^(\d&#123;1,4&#125;-(?:1[0-2]|0?[1-9])-(?:0?[1-9]|[1-2]\d|30|31))          ((?:[01]\d|2[0-3]):[0-5]\d:[0-5]\d)$</code        >      </td>      <td>例如：<code>2000-11-11 23:20:21</code></td>    </tr>  </tbody></table><h3 id="4-日常生活相关">4.日常生活相关</h3><table>  <tbody>    <tr>      <td><strong>描述</strong></td>      <td><strong>正则表达式</strong></td>      <td><strong>备注</strong></td>    </tr>    <tr>      <td>中文名</td>      <td><code>^[\u4E00-\u9FA5·]&#123;2,16&#125;$</code></td>      <td></td>    </tr>    <tr>      <td>英文名</td>      <td><code>^[a-zA-Z][a-zA-Z\s]&#123;0,20&#125;[a-zA-Z]$</code></td>      <td></td>    </tr>    <tr>      <td>车牌号</td>      <td>        <code          >^[京津沪渝冀豫云辽黑湘皖鲁新苏浙赣鄂桂甘晋蒙陕吉闽贵粤青藏川宁琼使领][A-HJ-NP-Z][A-HJ-NP-Z0-9]&#123;4&#125;[A-HJ-NP-Z0-9挂学警港澳]$</code        >      </td>      <td>不含新能源</td>    </tr>    <tr>      <td>车牌号</td>      <td>        <code          >^[京津沪渝冀豫云辽黑湘皖鲁新苏浙赣鄂桂甘晋蒙陕吉闽贵粤青藏川宁琼使领][A-HJ-NP-Z](?:(?:[A-HJ-NP-Z0-9]&#123;4&#125;[A-HJ-NP-Z0-9挂学警港澳])|(?:(?:\d&#123;5&#125;[A-HJK])|(?:[A-HJK][A-HJ-NP-Z0-9][0-9]&#123;4&#125;)))$</code        >      </td>      <td>包含新能源</td>    </tr>    <tr>      <td>火车车次</td>      <td><code>^[GCDZTSPKXLY1-9]\d&#123;1,4&#125;$</code></td>      <td>例如：<code>G1234</code></td>    </tr>    <tr>      <td>手机号</td>      <td><code>^(?:(?:\+|00)86)?1[3-9]\d&#123;9&#125;$</code></td>      <td>弱匹配</td>    </tr>    <tr>      <td>手机号</td>      <td>        <code          >^(?:(?:\+|00)86)?1(?:(?:3[\d])|(?:4[5-79])|(?:5[0-35-9])|(?:6[5-7])|(?:7[0-8])|(?:8[\d])|(?:9[189]))\d&#123;8&#125;$</code        >      </td>      <td>严格匹配</td>    </tr>    <tr>      <td>固话号码</td>      <td><code>^(?:(?:\d&#123;3&#125;-)?\d&#123;8&#125;|^(?:\d&#123;4&#125;-)?\d&#123;7,8&#125;)(?:-\d+)?$</code></td>      <td></td>    </tr>    <tr>      <td>手机IMEI码</td>      <td><code>^\d&#123;15,17&#125;$</code></td>      <td>一般是15位</td>    </tr>    <tr>      <td>邮编</td>      <td>        <code          >^(?:0[1-7]|1[0-356]|2[0-7]|3[0-6]|4[0-7]|5[1-7]|6[1-7]|7[0-5]|8[013-6])\d&#123;4&#125;$</code        >      </td>      <td>例如：<code>211100</code></td>    </tr>    <tr>      <td>统一社会信用代码</td>      <td><code>^[0-9A-HJ-NPQRTUWXY]&#123;2&#125;\d&#123;6&#125;[0-9A-HJ-NPQRTUWXY]&#123;10&#125;$</code></td>      <td></td>    </tr>    <tr>      <td>身份证号码(1代)</td>      <td>        <code>^[1-9]\d&#123;7&#125;(?:0\d|10|11|12)(?:0[1-9]|[1-2][\d]|30|31)\d&#123;3&#125;$</code>      </td>      <td>15位数字</td>    </tr>    <tr>      <td>身份证号码(2代)</td>      <td>        <code          >^[1-9]\d&#123;5&#125;(?:18|19|20)\d&#123;2&#125;(?:0[1-9]|10|11|12)(?:0[1-9]|[1-2]\d|30|31)\d&#123;3&#125;[0-9Xx]$</code        >      </td>      <td>18位数字</td>    </tr>    <tr>      <td>QQ号</td>      <td><code>^[1-9][0-9]&#123;4,&#125;$</code></td>      <td>一般是5到10位</td>    </tr>    <tr>      <td>微信号</td>      <td><code>^[a-zA-Z][-_a-zA-Z0-9]&#123;5,19&#125;$</code></td>      <td>一般6~20位，字母开头，可包含字母、数字、-、_，不含特殊字符</td>    </tr>    <tr>      <td>股票代码</td>      <td>        <code          >^(s[hz]|S[HZ])(000[\d]&#123;3&#125;|002[\d]&#123;3&#125;|300[\d]&#123;3&#125;|600[\d]&#123;3&#125;|60[\d]&#123;4&#125;)$</code        >      </td>      <td>A股，例如：<code>600519</code></td>    </tr>    <tr>      <td>银行卡卡号</td>      <td><code>^[1-9]&#123;1&#125;(?:\d&#123;15&#125;|\d&#123;18&#125;)$</code></td>      <td>一般为19位</td>    </tr>  </tbody></table><h3 id="5-互联网相关">5.互联网相关</h3><table>  <tbody>    <tr>      <td><strong>描述</strong></td>      <td><strong>正则表达式</strong></td>      <td><strong>备注</strong></td>    </tr>    <tr>      <td>域名</td>      <td>        <code          >^[a-zA-Z0-9][-a-zA-Z0-9]&#123;0,62&#125;(?:\.[a-zA-Z0-9][-a-zA-Z0-9]&#123;0,62&#125;)+$</code        >      </td>      <td>例如：<code>r2coding.com</code></td>    </tr>    <tr>      <td>网址</td>      <td>        <code          >^(?:https?:\/\/)?[a-zA-Z0-9][-a-zA-Z0-9]&#123;0,62&#125;(?:\.[a-zA-Z0-9][-a-zA-Z0-9]&#123;0,62&#125;)+$</code        >      </td>      <td>例如：<code>https://www.r2coding.com/</code></td>    </tr>    <tr>      <td>带端口号的网址(或IP)</td>      <td><code>^(?:https?:\/\/)?[\w-]+(?:\.[\w-]+)+:\d&#123;1,5&#125;\/?$</code></td>      <td>例如：<code>http://127.0.0.1:8888/</code></td>    </tr>    <tr>      <td>URL</td>      <td>        <code          >^https?:\/\/(?:www\.)?[-a-zA-Z0-9@:%._\+~#=]&#123;1,256&#125;\.[a-zA-Z0-9()]&#123;1,6&#125;\b(?:[-a-zA-Z0-9()!@:%_\+.~#?&amp;\/\/=]*)$</code        >      </td>      <td>例如：<code>https://www.r2coding.com/#/README?id=1</code></td>    </tr>    <tr>      <td>邮箱email</td>      <td>        <code          >^[A-Za-z0-9\u4e00-\u9fa5]+@[a-zA-Z0-9][-a-zA-Z0-9]&#123;0,62&#125;(?:\.[a-zA-Z0-9][-a-zA-Z0-9]&#123;0,62&#125;)+$</code        >      </td>      <td>支持中文，例如：<code>codesheep@cs.com</code></td>    </tr>    <tr>      <td>用户名</td>      <td><code>^[a-zA-Z0-9_-]&#123;4,20&#125;$</code></td>      <td>4到20位</td>    </tr>    <tr>      <td>弱密码</td>      <td><code>^[\w]&#123;6,16&#125;$</code></td>      <td>6~16位，包含大小写字母和数字的组合</td>    </tr>    <tr>      <td>强密码</td>      <td>        <code          >^.*(?=.&#123;6,&#125;)(?=.*\d)(?=.*[A-Z])(?=.*[a-z])(?=.*[!@\.#$%^&amp;*?          ]).*$</code        >      </td>      <td>至少6位，包括至少1个大写字母，1个小写字母，1个数字，1个特殊字符</td>    </tr>    <tr>      <td>端口号</td>      <td>        <code          >^(?:[0-9]|[1-9][0-9]&#123;1,3&#125;|[1-5][0-9]&#123;4&#125;|6[0-4][0-9]&#123;3&#125;|65[0-4][0-9]&#123;2&#125;|655[0-2][0-9]|6553[0-5])$</code        >      </td>      <td>例如：<code>65535</code></td>    </tr>    <tr>      <td>IPv4地址</td>      <td>        <code          >^(?:(?:\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.)&#123;3&#125;(?:\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])$</code        >      </td>      <td>例如：<code>192.168.31.1</code></td>    </tr>    <tr>      <td>IPv4地址+端口</td>      <td>        <code          >^(?:(?:\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.)&#123;3&#125;(?:\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])(?::(?:[0-9]|[1-9][0-9]&#123;1,3&#125;|[1-5][0-9]&#123;4&#125;|6[0-4][0-9]&#123;3&#125;|65[0-4][0-9]&#123;2&#125;|655[0-2][0-9]|6553[0-5]))?$</code        >      </td>      <td>例如：<code>192.168.31.1:8080</code></td>    </tr>    <tr>      <td>IPv6地址</td>      <td>        <code          >^(([0-9a-fA-F]&#123;1,4&#125;:)&#123;7,7&#125;[0-9a-fA-F]&#123;1,4&#125;|([0-9a-fA-F]&#123;1,4&#125;:)&#123;1,7&#125;:|([0-9a-fA-F]&#123;1,4&#125;:)&#123;1,6&#125;:[0-9a-fA-F]&#123;1,4&#125;|([0-9a-fA-F]&#123;1,4&#125;:)&#123;1,5&#125;(:[0-9a-fA-F]&#123;1,4&#125;)&#123;1,2&#125;|([0-9a-fA-F]&#123;1,4&#125;:)&#123;1,4&#125;(:[0-9a-fA-F]&#123;1,4&#125;)&#123;1,3&#125;|([0-9a-fA-F]&#123;1,4&#125;:)&#123;1,3&#125;(:[0-9a-fA-F]&#123;1,4&#125;)&#123;1,4&#125;|([0-9a-fA-F]&#123;1,4&#125;:)&#123;1,2&#125;(:[0-9a-fA-F]&#123;1,4&#125;)&#123;1,5&#125;|[0-9a-fA-F]&#123;1,4&#125;:((:[0-9a-fA-F]&#123;1,4&#125;)&#123;1,6&#125;)|:((:[0-9a-fA-F]&#123;1,4&#125;)&#123;1,7&#125;|:)|fe80:(:[0-9a-fA-F]&#123;0,4&#125;)&#123;0,4&#125;%[0-9a-zA-Z]&#123;1,&#125;|::(ffff(:0&#123;1,4&#125;)&#123;0,1&#125;:)&#123;0,1&#125;((25[0-5]|(2[0-4]|1&#123;0,1&#125;[0-9])&#123;0,1&#125;[0-9])\.)&#123;3,3&#125;(25[0-5]|(2[0-4]|1&#123;0,1&#125;[0-9])&#123;0,1&#125;[0-9])|([0-9a-fA-F]&#123;1,4&#125;:)&#123;1,4&#125;:((25[0-5]|(2[0-4]|1&#123;0,1&#125;[0-9])&#123;0,1&#125;[0-9])\.)&#123;3,3&#125;(25[0-5]|(2[0-4]|1&#123;0,1&#125;[0-9])&#123;0,1&#125;[0-9]))$</code        >      </td>      <td>例如：<code>CDCD:910A:2222:5498:8475:1111:3900:2020</code></td>    </tr>    <tr>      <td>IPv6地址+端口</td>      <td>        <code          >^\[(([0-9a-fA-F]&#123;1,4&#125;:)&#123;7,7&#125;[0-9a-fA-F]&#123;1,4&#125;|([0-9a-fA-F]&#123;1,4&#125;:)&#123;1,7&#125;:|([0-9a-fA-F]&#123;1,4&#125;:)&#123;1,6&#125;:[0-9a-fA-F]&#123;1,4&#125;|([0-9a-fA-F]&#123;1,4&#125;:)&#123;1,5&#125;(:[0-9a-fA-F]&#123;1,4&#125;)&#123;1,2&#125;|([0-9a-fA-F]&#123;1,4&#125;:)&#123;1,4&#125;(:[0-9a-fA-F]&#123;1,4&#125;)&#123;1,3&#125;|([0-9a-fA-F]&#123;1,4&#125;:)&#123;1,3&#125;(:[0-9a-fA-F]&#123;1,4&#125;)&#123;1,4&#125;|([0-9a-fA-F]&#123;1,4&#125;:)&#123;1,2&#125;(:[0-9a-fA-F]&#123;1,4&#125;)&#123;1,5&#125;|[0-9a-fA-F]&#123;1,4&#125;:((:[0-9a-fA-F]&#123;1,4&#125;)&#123;1,6&#125;)|:((:[0-9a-fA-F]&#123;1,4&#125;)&#123;1,7&#125;|:)|fe80:(:[0-9a-fA-F]&#123;0,4&#125;)&#123;0,4&#125;%[0-9a-zA-Z]&#123;1,&#125;|::(ffff(:0&#123;1,4&#125;)&#123;0,1&#125;:)&#123;0,1&#125;((25[0-5]|(2[0-4]|1&#123;0,1&#125;[0-9])&#123;0,1&#125;[0-9])\.)&#123;3,3&#125;(25[0-5]|(2[0-4]|1&#123;0,1&#125;[0-9])&#123;0,1&#125;[0-9])|([0-9a-fA-F]&#123;1,4&#125;:)&#123;1,4&#125;:((25[0-5]|(2[0-4]|1&#123;0,1&#125;[0-9])&#123;0,1&#125;[0-9])\.)&#123;3,3&#125;(25[0-5]|(2[0-4]|1&#123;0,1&#125;[0-9])&#123;0,1&#125;[0-9]))\](?::(?:[0-9]|[1-9][0-9]&#123;1,3&#125;|[1-5][0-9]&#123;4&#125;|6[0-4][0-9]&#123;3&#125;|65[0-4][0-9]&#123;2&#125;|655[0-2][0-9]|6553[0-5]))?$</code        >      </td>      <td>例如：<code>[CDCD:910A:2222:5498:8475:1111:3900:2020]:9800</code></td>    </tr>    <tr>      <td>子网掩码</td>      <td>        <code          >^(?:254|252|248|240|224|192|128)\.0\.0\.0|255\.(?:254|252|248|240|224|192|128|0)\.0\.0|255\.255\.(?:254|252|248|240|224|192|128|0)\.0|255\.255\.255\.(?:255|254|252|248|240|224|192|128|0)$</code        >      </td>      <td>例如：<code>255.255.255.0</code></td>    </tr>    <tr>      <td>MAC地址</td>      <td>        <code          >^(?:(?:[a-f0-9A-F]&#123;2&#125;:)&#123;5&#125;|(?:[a-f0-9A-F]&#123;2&#125;-)&#123;5&#125;)[a-f0-9A-F]&#123;2&#125;$</code        >      </td>      <td></td>    </tr>    <tr>      <td>Version版本号</td>      <td><code>^\d+(?:\.\d+)&#123;2&#125;$</code></td>      <td>例如：<code>12.1.1</code></td>    </tr>    <tr>      <td>图片后缀</td>      <td><code>\.(gif|png|jpg|jpeg|webp|svg|psd|bmp|tif)+</code></td>      <td>可按需增删扩展名集合</td>    </tr>    <tr>      <td>视频后缀</td>      <td><code>\.(swf|avi|flv|mpg|rm|mov|wav|asf|3gp|mkv|rmvb|mp4)+</code></td>      <td>可按需增删扩展名集合</td>    </tr>    <tr>      <td>图片链接</td>      <td>        <code          >(?:https?:\/\/)?[a-zA-Z0-9][-a-zA-Z0-9]&#123;0,62&#125;(?:\.[a-zA-Z0-9][-a-zA-Z0-9]&#123;0,62&#125;)+.+\.(gif|png|jpg|jpeg|webp|svg|psd|bmp|tif)</code        >      </td>      <td>可按需增删扩展名集合</td>    </tr>    <tr>      <td>视频链接</td>      <td>        <code          >(?:https?:\/\/)?[a-zA-Z0-9][-a-zA-Z0-9]&#123;0,62&#125;(?:\.[a-zA-Z0-9][-a-zA-Z0-9]&#123;0,62&#125;)+.+\.(swf|avi|flv|mpg|rm|mov|wav|asf|3gp|mkv|rmvb|mp4)</code        >      </td>      <td>可按需增删扩展名集合</td>    </tr>    <tr>      <td>迅雷链接</td>      <td><code>thunderx?:\/\/[a-zA-Z\d]+=</code></td>      <td></td>    </tr>    <tr>      <td>ed2k链接</td>      <td><code>ed2k:\/\/\|file\|.+\|\/</code></td>      <td></td>    </tr>    <tr>      <td>磁力链接</td>      <td><code>magnet:\?xt=urn:btih:[0-9a-fA-F]&#123;40,&#125;.*</code></td>      <td></td>    </tr>  </tbody></table><h3 id="6-其它">6.其它</h3><table>  <tbody>    <tr>      <td><strong>描述</strong></td>      <td><strong>正则表达式</strong></td>      <td><strong>备注</strong></td>    </tr>    <tr>      <td>MD5格式</td>      <td><code>^(?:[a-f\d]&#123;32&#125;|[A-F\d]&#123;32&#125;)$</code></td>      <td>32位MD5，例如：<code>7552E7071B118CBFFEC8C930455B4297</code></td>    </tr>    <tr>      <td>BASE64格式</td>      <td>        <code          >^\s*data:(?:[a-z]+\/[a-z0-9-+.]+(?:;[a-z-]+=[a-z0-9-]+)?)?(?:;base64)?,([a-z0-9!$&amp;',()*+;=\-._~:@/?%\s]*?)\s*$</code        >      </td>      <td>例如：<code>data:image/jpeg;base64,xxxx==</code></td>    </tr>    <tr>      <td>UUID</td>      <td><code>^[a-f\d]&#123;4&#125;(?:[a-f\d]&#123;4&#125;-)&#123;4&#125;[a-f\d]&#123;12&#125;$</code></td>      <td>例如：<code>94f9d45a-71b0-4b3c-b69d-20c4bc9c8fdd</code></td>    </tr>    <tr>      <td>16进制</td>      <td><code>^[A-Fa-f0-9]+$</code></td>      <td>例如：<code>FFFFFF</code></td>    </tr>    <tr>      <td>16进制颜色</td>      <td><code>^#?([0-9a-fA-F]&#123;3&#125;|[0-9a-fA-F]&#123;6&#125;)$</code></td>      <td>例如：<code>#FFFFFF</code></td>    </tr>    <tr>      <td>SQL语句</td>      <td><code>^(?:select|drop|delete|create|update|insert).*$</code></td>      <td></td>    </tr>    <tr>      <td>Java包名</td>      <td><code>^(?:[a-zA-Z_]\w*)+(?:[.][a-zA-Z_]\w*)+$</code></td>      <td>例如：<code>com.r2coding.controller</code></td>    </tr>    <tr>      <td>文件扩展名</td>      <td><code>\.(?:doc|pdf|txt)</code></td>      <td>可按需增删扩展名集合</td>    </tr>    <tr>      <td>Windows文件路径</td>      <td>        <code>^[a-zA-Z]:(?:\\[\w\u4E00-\u9FA5\s]+)+[.\w\u4E00-\u9FA5\s]+$</code>      </td>      <td>例如：<code>C:\Users\Administrator\Desktop\a.txt</code></td>    </tr>    <tr>      <td>Windows文件夹路径</td>      <td><code>^[a-zA-Z]:(?:\\[\w\u4E00-\u9FA5\s]+)+$</code></td>      <td>例如：<code>C:\Users\Administrator\Desktop</code></td>    </tr>    <tr>      <td>Linux文件路径</td>      <td><code>^\/(?:[^/]+\/)*[^/]+$</code></td>      <td>例如：<code>/root/library/a.txt</code></td>    </tr>    <tr>      <td>Linux文件夹路径</td>      <td><code>^\/(?:[^/]+\/)*$</code></td>      <td>例如：<code>/root/library/</code></td>    </tr>  </tbody></table>]]></content>
    
    
      
      
    <summary type="html">&lt;meta name=&quot;referrer&quot; content=&quot;no-referrer&quot; /&gt;
&lt;h1 id=&quot;Regular-Expression（正则表达式）&quot;&gt;Regular Expression（正则表达式）&lt;/h1&gt;
&lt;p&gt;&lt;a href=&quot;https://jex.im/</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>Flask 学习笔记</title>
    <link href="https://blog.halfsummer.xyz/posts/b275d48c.html"/>
    <id>https://blog.halfsummer.xyz/posts/b275d48c.html</id>
    <published>2023-03-03T00:20:44.000Z</published>
    <updated>2023-03-11T12:51:07.430Z</updated>
    
    <content type="html"><![CDATA[<meta name="referrer" content="no-referrer" /><h1 id="1）简介">1）简介</h1><p><strong>Flask是一个轻量级的基于Python的web框架</strong>。</p><p>Flask依赖三个库：</p><ul><li>Jinja2 模板引擎</li><li>Werkzeub WSGI工具集</li><li>Itsdangerous 基于Django的签名模块</li></ul><hr><h1 id="2）安装">2）安装</h1><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ pip3 install Flask</span><br></pre></td></tr></table></figure><p>进入python交互模式看下Flask的介绍和版本：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">$ python3</span><br><span class="line"> </span><br><span class="line">&gt;&gt;&gt; import flask</span><br><span class="line">&gt;&gt;&gt; <span class="built_in">print</span>(flask.__doc__)</span><br><span class="line">    flask</span><br><span class="line">    ~~~~~</span><br><span class="line"> </span><br><span class="line">    A microframework based on Werkzeug.  It<span class="string">&#x27;s extensively documented</span></span><br><span class="line"><span class="string">    and follows best practice patterns.</span></span><br><span class="line"><span class="string">    :copyright: © 2010 by the Pallets team.</span></span><br><span class="line"><span class="string">    :license: BSD, see LICENSE for more details.</span></span><br><span class="line"><span class="string">&gt;&gt;&gt; print(flask.__version__)</span></span><br><span class="line"><span class="string">1.0.2</span></span><br></pre></td></tr></table></figure><hr><h1 id="3）基础">3）基础</h1><h2 id="3-1-Hello-World">3.1 Hello World</h2><p>📌<strong>建立Flask项目HelloWorld</strong>：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> HelloWorld</span><br><span class="line"><span class="built_in">mkdir</span> HelloWorld/static</span><br><span class="line"><span class="built_in">mkdir</span> HelloWorld/templates</span><br><span class="line"><span class="built_in">touch</span> HelloWorld/app.py</span><br></pre></td></tr></table></figure><p><code>static</code>和<code>templates</code>目录是默认配置，其中<code>static</code>用来存放静态资源，例如图片、js、css文件等。<code>templates</code>存放html模板文件。我们的网站逻辑基本在<code>app.py</code>文件中，当然，也可以给这个文件起其他的名字。</p><p>📌<strong>在<code>app.py</code>中加入以下内容</strong>：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask</span><br><span class="line"> </span><br><span class="line">app = Flask(__name__)</span><br><span class="line"> </span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">hello_world</span>():</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;Hello World!&#x27;</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run()</span><br></pre></td></tr></table></figure><p>📌<strong>运行<code>app.py</code></strong>：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ python3 app.py </span><br><span class="line"> * Running on http://127.0.0.1:5000/</span><br></pre></td></tr></table></figure><p>打开浏览器访问<code>http://127.0.0.1:5000/</code>，浏览页面上将出现<code>Hello World!</code>。终端里会显示下面的信息：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1 - - [16/May/2014 10:29:08] <span class="string">&quot;GET / HTTP/1.1&quot;</span> 200 -</span><br></pre></td></tr></table></figure><p>变量app是一个Flask实例，通过下面的方式：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">hello_world</span>():</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;Hello World!&#x27;</span></span><br></pre></td></tr></table></figure><p>当客户端访问<code>/</code>时，将响应<code>hello_world()</code>函数返回的内容。注意，这不是返回<code>Hello World!</code>这么简单，<code>Hello World!</code>只是HTTP响应报文的实体部分，状态码等信息既可以由Flask自动处理，也可以通过编程来制定。</p><h2 id="3-2-修改Flask的配置">3.2 修改Flask的配置</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">app = Flask(__name__)</span><br></pre></td></tr></table></figure><p>上面的代码中，python内置变量<code>__name__</code>的值是字符串<code>__main__</code> 。Flask类将这个参数作为程序名称。当然这个是可以自定义的，比如<code>app = Flask(&quot;my-app&quot;)</code>。</p><p>Flask默认使用<code>static</code>目录存放静态资源，<code>templates</code>目录存放模板，这是可以通过设置参数更改的：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">app = Flask(<span class="string">&quot;my-app&quot;</span>, static_folder=<span class="string">&quot;path1&quot;</span>, template_folder=<span class="string">&quot;path2&quot;</span>)</span><br></pre></td></tr></table></figure><p>更多参数请参考<code>__doc__</code>：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask</span><br><span class="line"><span class="built_in">print</span>(Flask.__doc__)</span><br></pre></td></tr></table></figure><h2 id="3-3-调试模式">3.3 调试模式</h2><p>上面的app.py中以<code>app.run()</code>方式运行，这种方式下，如果服务器端出现错误是不会在客户端显示的。但是在开发环境中，显示错误信息是很有必要的，要显示错误信息，应该以下面的方式运行Flask：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">app.run(debug=True)</span><br></pre></td></tr></table></figure><p>将<code>debug</code>设置为<code>True</code>的另一个好处是，程序启动后，会自动检测源码是否发生变化，若有变化则自动重启程序。这可以帮我们省下很多时间。</p><h3 id="3-4-绑定IP和端口">3.4 绑定IP和端口</h3><p>默认情况下，Flask绑定IP为<code>127.0.0.1</code>，端口为<code>5000</code>。我们也可以通过下面的方式自定义：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">app.run(host=<span class="string">&#x27;0.0.0.0&#x27;</span>, port=<span class="number">80</span>, debug=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure><p><code>0.0.0.0</code>代表电脑所有的IP。<code>80</code>是HTTP网站服务的默认端口。什么是默认？比如，我们访问网站<code>http://www.example.com</code>，其实是访问的<code>http://www.example.com:80</code>，只不过<code>:80</code>可以省略不写。</p><p>由于绑定了80端口，需要使用root权限运行<code>app.py</code>。也就是：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo python3 app.py</span><br></pre></td></tr></table></figure><h1 id="4）">4）</h1><h1 id="📌request">📌request</h1><p><strong>传递参数</strong>：</p><p><a href="http://app.py">app.py</a></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, request</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">hello_world</span>():  <span class="comment"># put application&#x27;s code here</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;Hello World!&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 带参数的url：将参数固定到path中</span></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/blog/&lt;int:blog_id&gt;&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">blog_detail</span>(<span class="params">blog_id</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;您访问的是第 %s 号博客&quot;</span> % blog_id</span><br><span class="line"></span><br><span class="line"><span class="comment"># /book/list：会返回第一页的数据</span></span><br><span class="line"><span class="comment"># /book/list?page=2：会返回第二页的数据</span></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/book/list&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">book_list</span>():</span><br><span class="line">    <span class="comment"># argument:参数</span></span><br><span class="line">    <span class="comment"># request.args：类字典类型</span></span><br><span class="line">    page = request.args.get(<span class="string">&quot;page&quot;</span>, default=<span class="number">1</span>, <span class="built_in">type</span>=<span class="built_in">int</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="string">f&quot;您获取的是<span class="subst">&#123;page&#125;</span>页！&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run()</span><br></pre></td></tr></table></figure><h1 id="📌-render-template-封装了Jinja2">📌 render_template(封装了Jinja2)</h1><p>index.html</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>您访问的博客是： &#123;&#123; blog_id &#125;&#125;<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p><a href="http://app2.py">app2.py</a></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, render_template</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">hello_world</span>():  <span class="comment"># put application&#x27;s code here</span></span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&quot;index.html&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/blog/&lt;int:blog_id&gt;&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">blog_detail</span>(<span class="params">blog_id</span>):</span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&quot;blog_detail.html&quot;</span>, blog_id=blog_id)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run()</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;meta name=&quot;referrer&quot; content=&quot;no-referrer&quot; /&gt;
&lt;h1 id=&quot;1）简介&quot;&gt;1）简介&lt;/h1&gt;
&lt;p&gt;&lt;strong&gt;Flask是一个轻量级的基于Python的web框架&lt;/strong&gt;。&lt;/p&gt;
&lt;p&gt;Flask依赖三个库：&lt;/p</summary>
      
    
    
    
    <category term="python" scheme="https://blog.halfsummer.xyz/categories/python/"/>
    
    <category term="flask" scheme="https://blog.halfsummer.xyz/categories/python/flask/"/>
    
    
  </entry>
  
  <entry>
    <title>Python xlwings 将数据写入excel表格</title>
    <link href="https://blog.halfsummer.xyz/posts/6a75650e.html"/>
    <id>https://blog.halfsummer.xyz/posts/6a75650e.html</id>
    <published>2023-03-03T00:20:44.000Z</published>
    <updated>2023-03-11T12:51:07.430Z</updated>
    
    <content type="html"><![CDATA[<p>利用xlwings，操作Excel文件，制作下述表格内容：</p><p><img src="https://cos.halfsummer.xyz/pictures/niubb/2023/20230311-640c789a00faa.png" alt="image-20230311204818671"></p><p>命令：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> xlwings <span class="keyword">as</span> xw</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line">app = xw.App(visible=<span class="literal">False</span>, add_book=<span class="literal">False</span>)</span><br><span class="line">app.display_alerts = <span class="literal">False</span></span><br><span class="line">app.screen_updating = <span class="literal">False</span></span><br><span class="line">wb = app.books.add()</span><br><span class="line">sht = wb.sheets[<span class="string">&#x27;Sheet1&#x27;</span>]</span><br><span class="line">sht.<span class="built_in">range</span>(<span class="string">&#x27;A1&#x27;</span>).value = <span class="string">&#x27;个人信息表&#x27;</span></span><br><span class="line"><span class="comment">#设置合并</span></span><br><span class="line">sht.<span class="built_in">range</span>(<span class="string">&#x27;A1:G1&#x27;</span>).api.Merge()</span><br><span class="line"></span><br><span class="line"><span class="comment"># xlwings设置excel单元格对齐方式</span></span><br><span class="line">sht.<span class="built_in">range</span>(<span class="string">&#x27;A1:G1&#x27;</span>).api.HorizontalAlignment =-<span class="number">4108</span></span><br><span class="line">sht.<span class="built_in">range</span>(<span class="string">&#x27;A1:G1&#x27;</span>).api.VerticalAlignment = -<span class="number">4108</span></span><br><span class="line"><span class="comment">#数据写入的是excel行方向</span></span><br><span class="line">sht.<span class="built_in">range</span>(<span class="string">&#x27;A2:F2&#x27;</span>).value = [<span class="string">&#x27;序号&#x27;</span>,<span class="string">&#x27;学号&#x27;</span>,<span class="string">&#x27;姓名&#x27;</span>,<span class="string">&#x27;英语&#x27;</span>,<span class="string">&#x27;数学&#x27;</span>,<span class="string">&#x27;物理&#x27;</span>,<span class="string">&#x27;总分&#x27;</span>]</span><br><span class="line"><span class="comment">#数据写入的是excel列方向</span></span><br><span class="line">sht.<span class="built_in">range</span>(<span class="string">&#x27;A3:A8&#x27;</span>).options(transpose=<span class="literal">True</span>).value=[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>]</span><br><span class="line">sht.<span class="built_in">range</span>(<span class="string">&#x27;B3:B8&#x27;</span>).options(transpose=<span class="literal">True</span>).value=[<span class="string">&#x27;id01&#x27;</span>,<span class="string">&#x27;id02&#x27;</span>,<span class="string">&#x27;id03&#x27;</span>,<span class="string">&#x27;id04&#x27;</span>,<span class="string">&#x27;id05&#x27;</span>,<span class="string">&#x27;id06&#x27;</span>]</span><br><span class="line">sht.<span class="built_in">range</span>(<span class="string">&#x27;C3:C8&#x27;</span>).options(transpose=<span class="literal">True</span>).value=[<span class="string">&#x27;A01&#x27;</span>,<span class="string">&#x27;A02&#x27;</span>,<span class="string">&#x27;A03&#x27;</span>,<span class="string">&#x27;A04&#x27;</span>,<span class="string">&#x27;A05&#x27;</span>,<span class="string">&#x27;A06&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment">#以表格方式填入数据</span></span><br><span class="line">tables=[]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">6</span>):<span class="comment">#列</span></span><br><span class="line">    rol=[]</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">3</span>):<span class="comment">#行</span></span><br><span class="line">        rol.append(random.randint(<span class="number">0</span>,<span class="number">101</span>))  </span><br><span class="line">    tables.append(rol)</span><br><span class="line">sht.<span class="built_in">range</span>(<span class="string">&#x27;D3&#x27;</span>).options(expand=<span class="string">&#x27;table&#x27;</span>).value=tables</span><br><span class="line"></span><br><span class="line"><span class="comment">#利用公式计算</span></span><br><span class="line">sht.<span class="built_in">range</span>(<span class="string">&#x27;G3&#x27;</span>).formula=<span class="string">&#x27;=SUM(D3:F3)&#x27;</span></span><br><span class="line">sht.<span class="built_in">range</span>(<span class="string">&#x27;G4&#x27;</span>).formula=<span class="string">&#x27;=SUM(D4:F4)&#x27;</span></span><br><span class="line">sht.<span class="built_in">range</span>(<span class="string">&#x27;G5&#x27;</span>).formula=<span class="string">&#x27;=SUM(D5:F5)&#x27;</span></span><br><span class="line">sht.<span class="built_in">range</span>(<span class="string">&#x27;G6&#x27;</span>).formula=<span class="string">&#x27;=SUM(D6:F6)&#x27;</span></span><br><span class="line">sht.<span class="built_in">range</span>(<span class="string">&#x27;G7&#x27;</span>).formula=<span class="string">&#x27;=SUM(D7:F7)&#x27;</span></span><br><span class="line">sht.<span class="built_in">range</span>(<span class="string">&#x27;G8&#x27;</span>).formula=<span class="string">&#x27;=SUM(D8:F8)&#x27;</span></span><br><span class="line">sht.<span class="built_in">range</span>(<span class="string">&#x27;D9&#x27;</span>).formula=<span class="string">&#x27;=SUM(D3:D8)&#x27;</span></span><br><span class="line">sht.<span class="built_in">range</span>(<span class="string">&#x27;E9&#x27;</span>).formula=<span class="string">&#x27;=SUM(E3:E8)&#x27;</span></span><br><span class="line">sht.<span class="built_in">range</span>(<span class="string">&#x27;F9&#x27;</span>).formula=<span class="string">&#x27;=SUM(F3:F8)&#x27;</span></span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;利用xlwings，操作Excel文件，制作下述表格内容：&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://cos.halfsummer.xyz/pictures/niubb/2023/20230311-640c789a00faa.png&quot; alt=&quot;image-2023</summary>
      
    
    
    
    <category term="python" scheme="https://blog.halfsummer.xyz/categories/python/"/>
    
    
  </entry>
  
  <entry>
    <title>Docker 安装 Alist</title>
    <link href="https://blog.halfsummer.xyz/posts/f463bb27.html"/>
    <id>https://blog.halfsummer.xyz/posts/f463bb27.html</id>
    <published>2023-02-27T01:31:30.000Z</published>
    <updated>2023-03-11T12:51:07.430Z</updated>
    
    <content type="html"><![CDATA[<meta name="referrer" content="no-referrer" /><blockquote><p><a href="https://alist.nn.ci/zh/">Alist官网</a> <a href="https://github.com/alist-org/alist">Github</a></p><p><img src="https://gitee.com/aceniu/images/raw/master/article_images/typora_images/image-20230227074909040.png" alt="image-20230227074909040"></p></blockquote><h1 id="1）安装">1）安装</h1><h2 id="docker-cli">docker-cli</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -d --restart=always -v /etc/alist:/opt/alist/data -p 5244:5244 -e PUID=0 -e PGID=0 -e UMASK=022 --name=<span class="string">&quot;alist&quot;</span> xhofe/alist:latest</span><br></pre></td></tr></table></figure><h2 id="docker-compose">docker-compose</h2><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">version:</span> <span class="string">&#x27;3.3&#x27;</span></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line">    <span class="attr">alist:</span></span><br><span class="line">        <span class="attr">restart:</span> <span class="string">always</span></span><br><span class="line">        <span class="attr">volumes:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">&#x27;/etc/alist:/opt/alist/data&#x27;</span></span><br><span class="line">        <span class="attr">ports:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">&#x27;5244:5244&#x27;</span></span><br><span class="line">        <span class="attr">environment:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">PUID=0</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">PGID=0</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">UMASK=022</span></span><br><span class="line">        <span class="attr">container_name:</span> <span class="string">alist</span></span><br><span class="line">        <span class="attr">image:</span> <span class="string">&#x27;xhofe/alist:latest&#x27;</span></span><br></pre></td></tr></table></figure><h2 id="aria2版本">aria2版本</h2><p>如果你想使用aria2离线下载，推荐你使用这个下面这个版本，它预装了aria2。</p><p><a href="https://hub.docker.com/r/xhofe/alist-aria2">https://hub.docker.com/r/xhofe/alist-aria2</a></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -d --restart=always -v /etc/alist:/opt/alist/data -p 5244:5244 -e PUID=0 -e PGID=0 -e UMASK=022 --name=<span class="string">&quot;alist&quot;</span> xhofe/alist-aria2:latest</span><br></pre></td></tr></table></figure><h1 id="2）查询密码">2）查询密码</h1><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker <span class="built_in">exec</span> -it alist ./alist admin</span><br></pre></td></tr></table></figure><h1 id="3）更新">3）更新</h1><h2 id="docker-cli-v2">docker-cli</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">docker stop alist</span><br><span class="line">docker <span class="built_in">rm</span> alist</span><br><span class="line">docker pull xhofe/alist:latest</span><br></pre></td></tr></table></figure><p>然后再次输入安装命令</p><h2 id="docker-compose-v2">docker-compose</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">docker-compose down</span><br><span class="line">docker-compose pull</span><br><span class="line">docker-compose up -d</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">Alist 一个支持多种存储的文件列表程序，使用 Gin 和 Solidjs。</summary>
    
    
    
    <category term="Tool" scheme="https://blog.halfsummer.xyz/categories/Tool/"/>
    
    
  </entry>
  
  <entry>
    <title>Debian设置为静态网络</title>
    <link href="https://blog.halfsummer.xyz/posts/559234b6.html"/>
    <id>https://blog.halfsummer.xyz/posts/559234b6.html</id>
    <published>2023-02-26T22:06:11.000Z</published>
    <updated>2023-03-11T12:51:07.430Z</updated>
    
    <content type="html"><![CDATA[<meta name="referrer" content="no-referrer" /><h1 id="1）查看网卡">1）查看网卡</h1><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ifconfig</span><br><span class="line"><span class="comment">#或</span></span><br><span class="line">ip addr</span><br></pre></td></tr></table></figure><h1 id="2）修改配置文件">2）修改配置文件</h1><p>查看配置文件：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span> /etc/network/interfaces</span><br><span class="line"><span class="built_in">cd</span> /etc/network/interfaces/interfaces.d</span><br><span class="line">sudo <span class="built_in">touch</span> eth1</span><br><span class="line">vi eth1</span><br></pre></td></tr></table></figure><p>比如我要修改eth1：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">auto eth1</span><br><span class="line">iface eth1 inet static</span><br><span class="line">address 10.10.10.155</span><br><span class="line">netmask 255.255.255.0</span><br><span class="line">gateway 10.10.10.2</span><br><span class="line">dns-nameservers 8.8.4.4 8.8.8.8</span><br></pre></td></tr></table></figure><blockquote><p>auto eth1 #开机自动连接网络<br>iface eth1 inet static #static表示使用固定ip，dhcp表述使用动态ip<br>address 10.10.10.155 #设置ip地址<br>netmask 255.255.255.0 #设置子网掩码<br>gateway 10.10.10.2 #设置网关<br>dns-nameservers 8.8.4.4 8.8.8.8</p></blockquote><h1 id="3）重启系统服务">3）重启系统服务</h1><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo systemctl restart NetworkManager.service</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;meta name=&quot;referrer&quot; content=&quot;no-referrer&quot; /&gt;
&lt;h1 id=&quot;1）查看网卡&quot;&gt;1）查看网卡&lt;/h1&gt;
&lt;figure class=&quot;highlight sh&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;</summary>
      
    
    
    
    <category term="OS" scheme="https://blog.halfsummer.xyz/categories/OS/"/>
    
    <category term="Debian" scheme="https://blog.halfsummer.xyz/categories/OS/Debian/"/>
    
    
  </entry>
  
  <entry>
    <title>Docker 安装 openwrt</title>
    <link href="https://blog.halfsummer.xyz/posts/39dcc97.html"/>
    <id>https://blog.halfsummer.xyz/posts/39dcc97.html</id>
    <published>2023-02-26T21:32:20.000Z</published>
    <updated>2023-03-11T12:51:07.430Z</updated>
    
    <content type="html"><![CDATA[<meta name="referrer" content="no-referrer" /><h1 id="更新日志：">更新日志：</h1><p><strong>v1.0 Docker 安装openwrt（20230226）</strong></p><h1 id="1）打开网卡混杂模式">1）打开网卡混杂模式</h1><p>查看本机的网卡信息：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ ip a</span><br></pre></td></tr></table></figure><ul><li><p><strong>临时打开</strong></p><p>打开<code>eth0</code>混杂模式：(根据自己的网卡修改)</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo ip <span class="built_in">link</span> <span class="built_in">set</span> eth0 promisc on</span><br></pre></td></tr></table></figure></li><li><p><strong>永久打开</strong></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ vi /etc/rc.local</span><br><span class="line">ip <span class="built_in">link</span> <span class="built_in">set</span> eth0 promisc on</span><br></pre></td></tr></table></figure></li></ul><p>打开后网卡信息：</p><p><img src="https://images.halfsummer.xyz/i/pictures/niubb/2023/20230305-64042600de3c3.png" alt="0"></p><hr><h1 id="2）在docker中为openwrt设定网络">2）在docker中为openwrt设定网络</h1><p>(根据自己的网卡修改<code>parent=eth0</code>)</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker network create -d macvlan --subnet=192.168.123.0/24 --gateway=192.168.123.1 -o parent=eth0 openwrt</span><br></pre></td></tr></table></figure><hr><h1 id="3）启动openwrt容器">3）启动openwrt容器</h1><p>1️⃣查看自己机器的架构：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">uname</span> -a</span><br></pre></td></tr></table></figure><p>选择合适的版本：</p><p>原项目地址：<a href="https://github.com/SuLingGG/OpenWrt-Docker">https://github.com/SuLingGG/OpenWrt-Docker</a></p><table><thead><tr><th align="center">支持设备/平台</th><th align="center">DockerHub</th><th align="center">阿里云镜像仓库 (上海)</th></tr></thead><tbody><tr><td align="center">树莓派 1B</td><td align="center">sulinggg/openwrt:rpi1</td><td align="center">registry.cn-shanghai.aliyuncs.com/suling/openwrt:rpi1</td></tr><tr><td align="center">树莓派 2B</td><td align="center">sulinggg/openwrt:rpi2</td><td align="center">registry.cn-shanghai.aliyuncs.com/suling/openwrt:rpi2</td></tr><tr><td align="center">树莓派 3B / 3B+</td><td align="center">sulinggg/openwrt:rpi3</td><td align="center">registry.cn-shanghai.aliyuncs.com/suling/openwrt:rpi3</td></tr><tr><td align="center">树莓派 4B</td><td align="center">sulinggg/openwrt:rpi4</td><td align="center">registry.cn-shanghai.aliyuncs.com/suling/openwrt:rpi4</td></tr><tr><td align="center">armv7</td><td align="center">sulinggg/openwrt:armv7</td><td align="center">registry.cn-shanghai.aliyuncs.com/suling/openwrt:armv7</td></tr><tr><td align="center">arm8/aarch64</td><td align="center">sulinggg/openwrt:armv8</td><td align="center">registry.cn-shanghai.aliyuncs.com/suling/openwrt:armv8</td></tr><tr><td align="center">x86_64/amd64</td><td align="center">sulinggg/openwrt:x86_64</td><td align="center">registry.cn-shanghai.aliyuncs.com/suling/openwrt:x86_64</td></tr></tbody></table><p>2️⃣启动openwrt容器：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$ sudo docker run --privileged=<span class="literal">true</span> --restart=always \</span><br><span class="line">--network=openwrt \</span><br><span class="line">--name openwrt \</span><br><span class="line">-v /data/openwrt/config:/etc/config</span><br><span class="line">-d registry.cn-shanghai.aliyuncs.com/suling/openwrt:armv8 \</span><br><span class="line">/sbin/init</span><br></pre></td></tr></table></figure><p>3️⃣进入容器进行网络设置：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo docker <span class="built_in">exec</span> -it openwrt bash</span><br></pre></td></tr></table></figure><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/config/network</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/aceniu/images/raw/master/article_images/typora_images/image-20230226235724060.png" alt="image-20230226235724060"></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#旁路由参考设置</span></span><br><span class="line">config interface <span class="string">&#x27;lan&#x27;</span></span><br><span class="line">        option ifname <span class="string">&#x27;eth0&#x27;</span></span><br><span class="line">        option proto <span class="string">&#x27;static&#x27;</span></span><br><span class="line">        option netmask <span class="string">&#x27;255.255.255.0&#x27;</span></span><br><span class="line">        option gateway <span class="string">&#x27;192.168.123.1&#x27;</span></span><br><span class="line">        option ip6assign <span class="string">&#x27;60&#x27;</span></span><br><span class="line">        option dns <span class="string">&#x27; 8.8.8.8 114.114.114.114&#x27;</span></span><br><span class="line">        option ipaddr <span class="string">&#x27;192.168.123.254&#x27;</span></span><br><span class="line">        option broadcast <span class="string">&#x27;192.168.123.255&#x27;</span></span><br></pre></td></tr></table></figure><p>按<code>i</code>修改，<code>Esc</code> <code>:wq</code>保存后退出</p><p>4️⃣重启网络并退出容器</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">/etc/init.d/network restart</span><br><span class="line"><span class="built_in">exit</span></span><br></pre></td></tr></table></figure><hr><h1 id="4）设置openwrt">4）设置openwrt</h1><p>使用你设置的ip在浏览器进入openwrt登入界面，默认密码为<code>password</code></p><p>首先网络配置：</p><p><img src="https://gitee.com/aceniu/images/raw/master/article_images/typora_images/image-20230227001542449.png" alt="image-20230227001542449"></p><p><img src="https://gitee.com/aceniu/images/raw/master/article_images/typora_images/image-20230227003458427.png" alt="image-20230227003458427"></p><p><img src="https://gitee.com/aceniu/images/raw/master/article_images/typora_images/image-20230227002329803.png" alt="image-20230227002329803"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;meta name=&quot;referrer&quot; content=&quot;no-referrer&quot; /&gt;
&lt;h1 id=&quot;更新日志：&quot;&gt;更新日志：&lt;/h1&gt;
&lt;p&gt;&lt;strong&gt;v1.0 Docker 安装openwrt（20230226）&lt;/strong&gt;&lt;/p&gt;
&lt;h1 id=&quot;1）打</summary>
      
    
    
    
    <category term="openwrt" scheme="https://blog.halfsummer.xyz/categories/openwrt/"/>
    
    
  </entry>
  
  <entry>
    <title>常用 SSH 工具介绍</title>
    <link href="https://blog.halfsummer.xyz/posts/c671c1ec.html"/>
    <id>https://blog.halfsummer.xyz/posts/c671c1ec.html</id>
    <published>2023-02-26T17:12:09.000Z</published>
    <updated>2023-03-11T12:51:07.430Z</updated>
    
    <content type="html"><![CDATA[<meta name="referrer" content="no-referrer" /><h1 id="1）Putty">1）Putty</h1><p>putty是最简单的SSH工具，无需安装，支持多系统版本，下载后就可以直接使用。</p><p>推荐指数：⭐⭐<br>下载地址：<a href="https://www.chiark.greenend.org.uk/~sgtatham/putty/">https://www.chiark.greenend.org.uk/~sgtatham/putty/</a></p><h1 id="2）XShell">2）XShell</h1><p>XShell 功能较为强大，且操作方便简单，它选项卡式界面，可以同时在一个窗口显示连接多个主机，还有树状直观的主机连接管理。</p><p>推荐指数：⭐⭐⭐<br>下载地址：<a href="https://xshell.en.softonic.com/">https://xshell.en.softonic.com/</a></p><h1 id="3）Mobaxterm">3）Mobaxterm</h1><p>mobaxterm工具其 主要面向的用户是网络管理人员，但也可以用来当ssh工具使用。可以说这是我目前用过的最满意的一款SSH工具，可以说是一个神器，它本身支持SSH、FTP、SFTP浏览器、Xserver等系列工具，各位老爷感兴趣的可以自己去发掘。</p><p>推荐指数：⭐⭐⭐⭐⭐<br>下载地址：<a href="https://mobaxterm.mobatek.net/">https://mobaxterm.mobatek.net/</a></p><h1 id="4）FinalShell">4）FinalShell</h1><p>高效，是我对这款软件的第一印象。软件打开时，层次分明，软件左侧是系统信息，包含服务器的IP地址、运行时间，负载均衡、以及CPU、内存与交换的直观展示。在软件的中部是命令操作界面，深色的底蕴加上白色的文字，显得恰到好处。下方是文件管理，不需要多余的操作就能方便的管理文件，直接拖拽就能上下载文件。而且，值得一说的这是国人开发的，不需要考虑汉化的问题。</p><p>推荐指数：⭐⭐⭐⭐<br>下载地址：<a href="http://www.hostbuf.com/">http://www.hostbuf.com/</a></p><h1 id="5）SecureCRT">5）SecureCRT</h1><p>SecureCRT这也是我用的比较长时间一款SSH工具，功能和xshell差不多，总的感觉就是比上不足、比下有余。</p><p>推荐指数：⭐⭐⭐<br>下载地址：<a href="https://www.vandyke.com/">https://www.vandyke.com/</a></p><h1 id="6）Rstudio">6）Rstudio</h1><p>现在的Rstudio能都连接本地终端，如果是在服务器端，就可以登录服务器。也就是不需要任何工具，只在任何浏览器中登录Rstudio-server，就可以直接连接服务器，非常方便。它的优势不言自明，无需携带安装你熟悉的工具，只需要通过浏览器登录既可访问服务器。</p><p>推荐指数：⭐⭐<br>下载地址：<a href="https://posit.co/products/open-source/rstudio/">https://posit.co/products/open-source/rstudio/</a></p>]]></content>
    
    
    <summary type="html">SSH 是建立在应用层基础上的安全协议，专为远程登录会话和其他网络服务提供安全性的协议。利用 SSH 协议可以有效防止远程管理过程中的信息泄露问题。SSH最初是UNIX系统上的一个程序，后来又迅速扩展到其他操作平台。SSH在正确使用时可弥补网络中的漏洞。SSH客户端适用于多种平台。几乎所有UNIX平台—包括HP-UX、Linux、AIX、Solaris、Digital UNIX、Irix，以及其他平台，都可运行SSH。一款好的SSH工具，可以帮助我们更好的管理远程服务资源，接下来我这边推荐几款常用的SSH工具。</summary>
    
    
    
    <category term="Tool" scheme="https://blog.halfsummer.xyz/categories/Tool/"/>
    
    
  </entry>
  
  <entry>
    <title>Debian安装Docker</title>
    <link href="https://blog.halfsummer.xyz/posts/6c0b0bfc.html"/>
    <id>https://blog.halfsummer.xyz/posts/6c0b0bfc.html</id>
    <published>2023-02-26T13:30:45.000Z</published>
    <updated>2023-03-11T12:51:07.430Z</updated>
    
    <content type="html"><![CDATA[<meta name="referrer" content="no-referrer" /><h1 id="1）卸载旧版本">1）卸载旧版本</h1><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#remove：清除软件包</span></span><br><span class="line">$ sudo apt-get remove docker docker-engine docker.io containerd runc</span><br><span class="line"><span class="comment">#purge：清除软件包并删除配置文件</span></span><br><span class="line">$ sudo apt-get purge docker-ce docker-ce-cli containerd.io docker-compose-plugin</span><br><span class="line">$ sudo <span class="built_in">rm</span> -rf /var/lib/docker</span><br><span class="line">$ sudo <span class="built_in">rm</span> -rf /var/lib/containerd</span><br></pre></td></tr></table></figure><hr><h1 id="2）使用-APT-安装">2）使用 APT 安装</h1><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">$ sudo apt-get update</span><br><span class="line"></span><br><span class="line"><span class="comment"># 安装依赖包</span></span><br><span class="line">$ sudo apt-get install dialog<span class="comment"># 单独拿出来 放一起会报错</span></span><br><span class="line">$ sudo apt-get install \</span><br><span class="line">    apt-transport-https \</span><br><span class="line">    ca-certificates \</span><br><span class="line">    curl \</span><br><span class="line">    gnupg \</span><br><span class="line">    lsb-release</span><br></pre></td></tr></table></figure><p>鉴于国内网络问题，强烈建议使用国内源，官方源请在注释中查看。</p><p>为了确认所下载软件包的合法性，需要添加软件源的 GPG 密钥。</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$ curl -fsSL https://mirrors.aliyun.com/docker-ce/linux/debian/gpg | sudo gpg --dearmor -o /usr/share/keyrings/docker-archive-keyring.gpg</span><br><span class="line"></span><br><span class="line"><span class="comment">## 官方源</span></span><br><span class="line"><span class="comment"># $ curl -fsSL https://download.docker.com/linux/debian/gpg | sudo gpg --dearmor -o /usr/share/keyrings/docker-archive-keyring.gpg</span></span><br><span class="line"></span><br><span class="line">$ sudo <span class="built_in">chmod</span> a+r /usr/share/keyrings/docker-archive-keyring.gpg</span><br></pre></td></tr></table></figure><p>然后，我们需要向 sources.list 中添加 Docker 软件源：</p><p>在一些基于 Debian 的 Linux 发行版中 $(lsb_release -cs) 可能不会返回 Debian 的版本代号，例如 Kail Linux (opens new window)、 BunsenLabs Linux (opens new window)。在这些发行版中我们需要将下面命令中的 $(lsb_release -cs) 替换为 <code>https://mirrors.aliyun.com/docker-ce/linux/debian/dists/</code> 中支持的 Debian 版本代号，例如 buster。</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 写入软件源信息</span></span><br><span class="line">$ <span class="built_in">echo</span> <span class="string">&quot;deb [arch=<span class="subst">$(dpkg --print-architecture)</span> signed-by=/usr/share/keyrings/docker-archive-keyring.gpg] http://mirrors.aliyun.com/docker-ce/linux/debian <span class="subst">$(lsb_release -cs)</span> stable&quot;</span> | sudo <span class="built_in">tee</span> /etc/apt/sources.list.d/docker.list &gt; /dev/null</span><br><span class="line"></span><br><span class="line"><span class="comment"># 官方源</span></span><br><span class="line"><span class="comment"># $ echo \</span></span><br><span class="line"><span class="comment">#   &quot;deb [arch=amd64 signed-by=/usr/share/keyrings/docker-archive-keyring.gpg] https://download.docker.com/linux/debian \</span></span><br><span class="line"><span class="comment">#   $(lsb_release -cs) stable&quot; | sudo tee /etc/apt/sources.list.d/docker.list &gt; /dev/null</span></span><br></pre></td></tr></table></figure><p>以上命令会添加稳定版本的 Docker APT 源，如果需要测试版本的 Docker 请将 stable 改为 test。</p><hr><h1 id="3）安装-Docker">3）安装 Docker</h1><p>查询存储库中可用的版本</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">$ sudo apt-get update</span><br><span class="line">$ apt-cache madison docker-ce</span><br><span class="line"> docker-ce | 5:23.0.1-1~debian.11~bullseye | http://mirrors.aliyun.com/docker-ce/linux/debian bullseye/stable arm64 Packages</span><br><span class="line"> docker-ce | 5:23.0.0-1~debian.11~bullseye | http://mirrors.aliyun.com/docker-ce/linux/debian bullseye/stable arm64 Packages</span><br><span class="line"> docker-ce | 5:20.10.23~3-0~debian-bullseye | http://mirrors.aliyun.com/docker-ce/linux/debian bullseye/stable arm64 Packages</span><br><span class="line"> docker-ce | 5:20.10.22~3-0~debian-bullseye | http://mirrors.aliyun.com/docker-ce/linux/debian bullseye/stable arm64 Packages</span><br><span class="line"> docker-ce | 5:20.10.21~3-0~debian-bullseye | http://mirrors.aliyun.com/docker-ce/linux/debian bullseye/stable arm64 Packages</span><br><span class="line"> docker-ce | 5:20.10.20~3-0~debian-bullseye | http://mirrors.aliyun.com/docker-ce/linux/debian bullseye/stable arm64 Packages</span><br><span class="line">...省略部分内容...</span><br></pre></td></tr></table></figure><blockquote><p><img src="https://gitee.com/aceniu/images/raw/master/article_images/typora_images/image-20230226165608607.png" alt="image-20230226165608607"></p></blockquote><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">$ sudo apt-get update</span><br><span class="line"><span class="comment"># 安装指定版本（5:23.0.1-1~debian.11~bullseye）</span></span><br><span class="line"><span class="comment"># Docker客户端</span></span><br><span class="line">$ sudo apt-get install docker-ce=5:23.0.1-1~debian.11~bullseye <span class="comment"># Docker守护进程</span></span><br><span class="line"><span class="comment"># CLI工具用来远程控制Docker守护进程（已包括）</span></span><br><span class="line"><span class="comment">#$ sudo apt-get install docker-ce-cli=5:23.0.1-1~debian.11~bullseye</span></span><br><span class="line"><span class="comment"># Docker服务端（已包括）</span></span><br><span class="line"><span class="comment">#$ sudo apt-get install containerd.io # Docker守护进程与操作系统API接口</span></span><br><span class="line"><span class="comment"># 轻松、高效的管理容器，它是一个用于定义和运行多容器 Docker 的应用程序工具</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># docker-compose安装</span></span><br><span class="line"><span class="comment">#$ sudo apt-get install docker-compose #版本太旧</span></span><br><span class="line"><span class="comment">#$ sudo apt-get install docker-compose-plugin</span></span><br><span class="line"><span class="comment"># github拉取</span></span><br><span class="line"><span class="comment">#$ curl -L https://github.com/docker/compose/releases/download/v2.16.0/docker-compose-`uname -s`-`uname -m` -o /usr/local/bin/docker-compose</span></span><br><span class="line"><span class="comment"># 国内源拉取</span></span><br><span class="line">$ curl -L https://get.daocloud.io/docker/compose/releases/download/v2.16.0/docker-compose-`<span class="built_in">uname</span> -s`-`<span class="built_in">uname</span> -m` -o /usr/local/bin/docker-compose</span><br><span class="line"></span><br><span class="line">$ sudo <span class="built_in">chmod</span> +x /usr/local/bin/docker-compose</span><br></pre></td></tr></table></figure><hr><h1 id="4）开机自启">4）开机自启</h1><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo systemctl <span class="built_in">enable</span> docker &amp;&amp; systemctl restart docker &amp;&amp; systemctl status docker</span><br></pre></td></tr></table></figure><hr><h1 id="5）配置镜像加速">5）配置镜像加速</h1><p>请首先执行以下命令，查看是否在 <code>docker.service </code>文件中配置过镜像地址。</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ systemctl <span class="built_in">cat</span> docker | grep <span class="string">&#x27;\-\-registry\-mirror&#x27;</span></span><br></pre></td></tr></table></figure><p>如果该命令有输出，那么请执行 <code>$ systemctl cat docker</code> 查看 <code>ExecStart=</code> 出现的位置，修改对应的文件内容去掉 <code>--registry-mirror</code> 参数及其值，并按接下来的步骤进行配置。</p><p>如果以上命令没有任何输出，那么就可以在<code>/etc/docker/daemon.json</code> 中写入如下内容（如果文件不存在请新建该文件）：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo vim /etc/docker/daemon.json</span><br></pre></td></tr></table></figure><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="string">&quot;registry-mirrors&quot;</span>: [</span><br><span class="line">    <span class="string">&quot;https://hub-mirror.c.163.com&quot;</span>,</span><br><span class="line">    <span class="string">&quot;https://mirror.baidubce.com&quot;</span></span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>之后重新启动服务。</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ sudo systemctl daemon-reload</span><br><span class="line">$ sudo systemctl restart docker</span><br></pre></td></tr></table></figure><hr><h1 id="6）检查">6）检查</h1><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 基本信息</span></span><br><span class="line">$ sudo docker info</span><br><span class="line"><span class="comment"># 检查安装版本</span></span><br><span class="line">$ sudo docker --version</span><br><span class="line">$ sudo docker-compose --version</span><br><span class="line"><span class="comment"># 校验Docker CE </span></span><br><span class="line">$ sudo docker run hello-world</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;meta name=&quot;referrer&quot; content=&quot;no-referrer&quot; /&gt;
&lt;h1 id=&quot;1）卸载旧版本&quot;&gt;1）卸载旧版本&lt;/h1&gt;
&lt;figure class=&quot;highlight sh&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>Ansible 学习笔记</title>
    <link href="https://blog.halfsummer.xyz/posts/e4dd4355.html"/>
    <id>https://blog.halfsummer.xyz/posts/e4dd4355.html</id>
    <published>2023-02-25T09:43:06.000Z</published>
    <updated>2023-03-11T12:51:07.430Z</updated>
    
    <content type="html"><![CDATA[<meta name="referrer" content="no-referrer" /><h1 id="1）Ansible-安装部署">1）Ansible 安装部署</h1><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ yum -y install epel-release ansible libselinux-python</span><br></pre></td></tr></table></figure><h1 id="2）主机清单">2）主机清单</h1><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">[root@master-61 ~]<span class="comment">#vim /etc/ansible/hosts </span></span><br><span class="line"> </span><br><span class="line">[web]</span><br><span class="line">172.16.1.7 </span><br><span class="line">172.16.1.8</span><br><span class="line">172.16.1.9</span><br><span class="line"> </span><br><span class="line">[nfs]</span><br><span class="line">172.16.1.31</span><br><span class="line"> </span><br><span class="line">[backup]</span><br><span class="line">172.16.1.41</span><br></pre></td></tr></table></figure><p><strong>主机分组后，执行命令测试，批量管理一组机器</strong></p><p>管理所有的机器，使用特殊主机组，all</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">让所有的主机，远程运行hostname，返回主机名信息</span><br><span class="line">[root@master-61 ~]<span class="comment">#ansible all -m shell -a &quot;hostname&quot;</span></span><br><span class="line"> </span><br><span class="line">但是默认没配置认证方式，权限被拒绝</span><br></pre></td></tr></table></figure><h1 id="3）Ansible-连接客户端">3）Ansible 连接客户端</h1><h2 id="3-1-基于公钥认证">3.1 基于公钥认证</h2><p>生成公钥的方法：（~/.ssh/）</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh-keygen -t dsa <span class="comment">#-t : t是type的缩写，即指定密钥的类型，密钥的类型有两种：RSA、DSA</span></span><br></pre></td></tr></table></figure><p>发送公钥给目标机器</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@master-61 ~]<span class="comment">#ssh-copy-id root@172.16.1.41</span></span><br><span class="line"> </span><br><span class="line">[root@master-61 ~]<span class="comment">#ansible backup -a &quot;hostname&quot;</span></span><br><span class="line">172.16.1.41 | CHANGED | rc=0 &gt;&gt;</span><br><span class="line">rsync-41</span><br></pre></td></tr></table></figure><h2 id="3-2-基于密码认证">3.2 基于密码认证</h2><ul><li>在你的客户端机器，修改了ssh默认端口，以及密码需要修改主机清单文件才可以正确连接</li><li>注意你得配置文件允许免密登录才能进行如下测试</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/ansible/hosts  <span class="comment">#主机清单文件</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#注意，部分资料里的主机配置文件语法，旧版如下</span></span><br><span class="line"><span class="comment">#Ansible 2.0 has deprecated the “ssh” from ansible_ssh_user, ansible_ssh_host, and ansible_ssh_port to become </span></span><br><span class="line"></span><br><span class="line"><span class="comment">#这是旧版本的用法</span></span><br><span class="line">ansible_ssh_host</span><br><span class="line">ansible_ssh_port</span><br><span class="line">ansible_ssh_user</span><br><span class="line">ansible_ssh_password</span><br><span class="line"> </span><br><span class="line"><span class="comment">#新版参数去掉了中间的_ssh(如果你写旧版本的语法，新版也也认识)</span></span><br><span class="line">ansible_user</span><br><span class="line">ansible_host</span><br><span class="line">ansible_port</span><br></pre></td></tr></table></figure><p><strong>参数说明</strong>：</p><table><thead><tr><th><strong>参数</strong></th><th><strong>参数类型</strong></th><th><strong>参数说明</strong></th></tr></thead><tbody><tr><td>ansible_host</td><td>主机地址</td><td>远程主机ip</td></tr><tr><td>ansible_port</td><td>主机端口</td><td>设置SSH连接端口，默认22</td></tr><tr><td>ansible_user</td><td>主机用户</td><td>默认SSH远程连接的用户身份</td></tr><tr><td>ansible_password</td><td>用户密码</td><td>指定SSH远程主机密码</td></tr></tbody></table><p><strong>示例</strong>：</p><p>给rsync机器，进行免密认证</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">1.给rsync机器，添加密码，端口信息</span><br><span class="line">[backup]</span><br><span class="line">172.16.1.41 ansible_port=22 ansible_password=<span class="string">&#x27;123456&#x27;</span></span><br><span class="line"> </span><br><span class="line">2.如果目标机器的ssh信息都被改了，这里也得改</span><br><span class="line">172.16.1.41 ansible_port=22999 ansible_password=<span class="string">&#x27;123123&#x27;</span></span><br></pre></td></tr></table></figure><p>测试执行</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[root@master-61 ~]<span class="comment">#ansible backup -m ping</span></span><br><span class="line">172.16.1.41 | SUCCESS =&gt; &#123;</span><br><span class="line">    <span class="string">&quot;ansible_facts&quot;</span>: &#123;</span><br><span class="line">        <span class="string">&quot;discovered_interpreter_python&quot;</span>: <span class="string">&quot;/usr/bin/python&quot;</span></span><br><span class="line">    &#125;, </span><br><span class="line">    <span class="string">&quot;changed&quot;</span>: <span class="literal">false</span>, </span><br><span class="line">    <span class="string">&quot;ping&quot;</span>: <span class="string">&quot;pong&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="📌故障解决">📌故障解决</h2><p>你可能会遇见如下问题，关于新机器的指纹确认问题。</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@master-61 ~]<span class="comment">#ansible 172.16.1.9 -m ping</span></span><br><span class="line">172.16.1.9 | FAILED! =&gt; &#123;</span><br><span class="line">    <span class="string">&quot;msg&quot;</span>: <span class="string">&quot;Using a SSH password instead of a key is not possible because Host Key checking is enabled and sshpass does not support this.  Please add this host&#x27;s fingerprint to your known_hosts file to manage this host.&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>解决办法1，手动ssh连接，进行指纹确认，写入到本机的</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span> ~/.ssh/known_hosts</span><br></pre></td></tr></table></figure><p>解决办法2，ansible配置文件中忽略指纹确认</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@master-61 ~]<span class="comment">#grep &#x27;host_key_checking&#x27; /etc/ansible/ansible.cfg </span></span><br><span class="line">host_key_checking = False</span><br></pre></td></tr></table></figure><p>问题已经解决，可以正确操作web-9机器</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[root@master-61 ~]<span class="comment">#ansible 172.16.1.9 -m ping</span></span><br><span class="line">172.16.1.9 | SUCCESS =&gt; &#123;</span><br><span class="line">    <span class="string">&quot;ansible_facts&quot;</span>: &#123;</span><br><span class="line">        <span class="string">&quot;discovered_interpreter_python&quot;</span>: <span class="string">&quot;/usr/bin/python&quot;</span></span><br><span class="line">    &#125;, </span><br><span class="line">    <span class="string">&quot;changed&quot;</span>: <span class="literal">false</span>, </span><br><span class="line">    <span class="string">&quot;ping&quot;</span>: <span class="string">&quot;pong&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="📌踩坑记录-ansible缓存">📌踩坑记录(ansible缓存)</h2><p>由于ansible在对远程主机操作之前，默认会先通过setup模块获取机器的facts（静态属性），并且会生成缓存，便于加速远程主机的操作；但缓存也会导致一些奇怪的现象，比如客户端的机器信息更新了，服务端依旧使用的是旧数据，那就不准确了，因此可以删除缓存。</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">关于缓存导致bug的文章，https://serverfault.com/questions/630253/ansible-stuck-on-gathering-facts</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">清理ansible的缓存目录即可</span><br><span class="line">[root@master-61 ~]<span class="comment">#rm -rf ~/.ansible/cp/*</span></span><br></pre></td></tr></table></figure><h2 id="📌同一组连续的ip">📌同一组连续的ip</h2><p>可以修改主机清单文件如下，前提是该些主机的配置一致</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[web]</span><br><span class="line">172.16.1.[7:9]</span><br></pre></td></tr></table></figure><h2 id="📌公共变量">📌公共变量</h2><p>当主机清单里，很多主机组，有相同的变量属性，可以写成公共变量</p><p>这部分配置是针对web主机组，抽象的变量</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">[root@master-61 ~]<span class="comment">#grep -vE &#x27;^#|^$&#x27; /etc/ansible/hosts </span></span><br><span class="line">[web:vars]</span><br><span class="line">ansible_ssh_port=22999</span><br><span class="line">ansible_ssh_user=root</span><br><span class="line">ansible_ssh_pass=123123</span><br><span class="line">[web]</span><br><span class="line">172.16.1.[7:9]</span><br><span class="line">[nfs]</span><br><span class="line">172.16.1.31 ansible_ssh_port=22999 </span><br><span class="line">[backup]</span><br><span class="line">172.16.1.41 ansible_ssh_port=22999 ansible_ssh_user=root ansible_ssh_pass=123123</span><br></pre></td></tr></table></figure><p><strong>所有主机都生效的变量</strong></p><p>指定主机组名all，即可针对所有主机名生效，前提是，你要确保这个信息是所有主机通用的。</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">[root@master-61 ~]<span class="comment">#grep -vE &#x27;^#|^$&#x27; /etc/ansible/hosts </span></span><br><span class="line">[all:vars]</span><br><span class="line">ansible_port=22</span><br><span class="line">ansible_password=<span class="string">&#x27;123456&#x27;</span></span><br><span class="line"> </span><br><span class="line">[web]</span><br><span class="line">172.16.1.7</span><br><span class="line">172.16.1.8</span><br><span class="line">172.16.1.9</span><br><span class="line"> </span><br><span class="line">[nfs]</span><br><span class="line">172.16.1.31</span><br><span class="line"> </span><br><span class="line">[backup]</span><br><span class="line">172.16.1.41</span><br></pre></td></tr></table></figure><h2 id="3-3-Ansible连接指纹确认的问题">3.3 Ansible连接指纹确认的问题</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">1.master-61需要确认目标机器的指纹，记录到本地known——hosts文件</span><br><span class="line"><span class="built_in">ls</span> ~/.ssh/known_hosts文件中 这里就存放了目标机器的指纹信息</span><br><span class="line"> </span><br><span class="line">可以进行认证方式，密码，还是公钥</span><br><span class="line"> </span><br><span class="line">2.首次远程连接，需要指纹确认，可以忽略该指纹</span><br><span class="line">ssh的连接参数，忽略指纹的确认</span><br><span class="line">ansible的配置文件中也有一个参数忽略指纹的确认</span><br><span class="line"> </span><br><span class="line">一般用法是</span><br><span class="line">总之ansible就是以ssh连接标准来的</span><br><span class="line"> </span><br><span class="line">1.指纹确认 <span class="built_in">yes</span>/no</span><br><span class="line"> </span><br><span class="line">2.密码认证/公钥认证</span><br><span class="line"> </span><br><span class="line">关于ansible如何初始化的使用，有三个方案</span><br><span class="line"> </span><br><span class="line">方案一</span><br><span class="line">已经基于ssh完成了指纹确认，认证方式</span><br><span class="line">ansible直接用就可以</span><br><span class="line">你可以先一键分发公钥，实现批量化免密登录，再ansible免密远程执行命令</span><br><span class="line"> </span><br><span class="line">方案2</span><br><span class="line">ssh root@172.16.1.7</span><br><span class="line">手动确认<span class="built_in">yes</span> 写入到本地的known_hosts</span><br><span class="line">你可以手动ssh连接，确认指纹后，再ansible去远程操作，选择认证方式就行</span><br><span class="line"> </span><br><span class="line">方案3.</span><br><span class="line">你可以直接忽略指纹确认，在主机清单文件中定义好ssh连接配置参数</span><br><span class="line"> </span><br><span class="line">这个就是最简单的，修改ansible配置文件，打开忽略指纹确认的参数即可</span><br><span class="line"> </span><br><span class="line">修改如下参数即可</span><br><span class="line"> 72 <span class="comment"># uncomment this to disable SSH key host checking</span></span><br><span class="line"> 73 host_key_checking = False</span><br><span class="line"> </span><br><span class="line">后续就进入了认证方式阶段，选择密码，还是公钥，</span><br><span class="line">常见错误</span><br><span class="line">- 端口错了</span><br><span class="line">- 密码错了</span><br><span class="line">- 用户错了</span><br><span class="line"> </span><br><span class="line">如果出错</span><br><span class="line">1.找ansible的/etc/ansible/hosts中语法是否出错</span><br><span class="line">2.看目标机器，到底提供了什么样的ssh连接形式（sshd_config）</span><br></pre></td></tr></table></figure><h2 id="3-4-ssh批量管理分发（实战）">3.4 ssh批量管理分发（实战）</h2><p><a href="https://blog.csdn.net/yingcai111/article/details/127404417">https://blog.csdn.net/yingcai111/article/details/127404417</a></p><hr><h1 id="3）ad-hoc-命令行模式">3）ad-hoc 命令行模式</h1><p>Ansible的ad-hoc模式也就是ansible的命令行模式，该模式通常用来临时处理一些任务。例如</p><ul><li>临时批量查看所有被管控机器的内存、负载、磁盘</li><li>临时批量分发某个特定文件</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ansible 主机名 -m <span class="built_in">command</span> -a <span class="string">&quot;批量执行的操作&quot;</span></span><br><span class="line"><span class="comment"># -m 指定模块的参数</span></span><br><span class="line"><span class="comment"># -a 指定模块的执行动作参数</span></span><br></pre></td></tr></table></figure><h2 id="3-1-列出Ansible所有支持的模块">3.1 列出Ansible所有支持的模块</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#当前ansible支持3387个模块</span></span><br><span class="line">[root@master-61 ~]<span class="comment"># ansible-doc -l |wc -l</span></span><br><span class="line">3387</span><br></pre></td></tr></table></figure><h2 id="3-2-查看某个模块的具体用法">3.2 查看某个模块的具体用法</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">[root@master-61 ~]<span class="comment">#ansible-doc -s ping</span></span><br><span class="line">- name: Try to connect to host, verify a usable python and <span class="built_in">return</span> `pong<span class="string">&#x27; on success</span></span><br><span class="line"><span class="string">  ping:</span></span><br><span class="line"><span class="string">      data:                  # Data to return for the `ping&#x27;</span> <span class="built_in">return</span> value. If this</span><br><span class="line">                               parameter is <span class="built_in">set</span> to</span><br><span class="line">                               `crash<span class="string">&#x27;, the module</span></span><br><span class="line"><span class="string">                               will cause an</span></span><br><span class="line"><span class="string">                               exception.</span></span><br><span class="line"><span class="string">[root@master-61 ~]#ansible-doc -s shell</span></span><br><span class="line"><span class="string">- name: Execute shell commands on targets</span></span><br><span class="line"><span class="string">  shell:</span></span><br><span class="line"><span class="string">      chdir:                 # Change into this directory before running the command.</span></span><br><span class="line"><span class="string">      cmd:                   # The command to run followed by optional arguments.</span></span><br><span class="line"><span class="string">      creates:               # A filename, when it already exists, this step will</span></span><br><span class="line"><span class="string">                               *not* be run.</span></span><br><span class="line"><span class="string">      executable:            # Change the shell used to execute the command. This</span></span><br><span class="line"><span class="string">                               expects an absolute</span></span><br><span class="line"><span class="string">                               path to the executable.</span></span><br><span class="line"><span class="string">      free_form:             # The shell module takes a free form command to run, as</span></span><br><span class="line"><span class="string">                               a string. There is no</span></span><br><span class="line"><span class="string">                               actual parameter named</span></span><br><span class="line"><span class="string">                               &#x27;</span>free form<span class="string">&#x27;. See the</span></span><br><span class="line"><span class="string">                               examples on how to use</span></span><br><span class="line"><span class="string">                               this module.</span></span><br><span class="line"><span class="string">      removes:               # A filename, when it does not exist, this step will</span></span><br><span class="line"><span class="string">                               *not* be run.</span></span><br><span class="line"><span class="string">      stdin:                 # Set the stdin of the command directly to the specified</span></span><br><span class="line"><span class="string">                               value.</span></span><br><span class="line"><span class="string">      stdin_add_newline:     # Whether to append a newline to stdin data.</span></span><br><span class="line"><span class="string">      warn:                  # Whether to enable task warnings.</span></span><br></pre></td></tr></table></figure><h2 id="3-3-Ansible执行命令结果（状态颜色）">3.3 Ansible执行命令结果（状态颜色）</h2><p>可以使用模块操作，会有不同的颜色结果，都是由意义的</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">运维远程执行命令，有2个方式</span><br><span class="line">shell脚本，远程执行</span><br><span class="line">ansible模块，远程执行</span><br><span class="line"> </span><br><span class="line">区别在于</span><br><span class="line">shell脚本不够智能，不会记录上一次的执行状态，以及修改的状态，因此导致，傻瓜式的，重复性执行，效率的极其低下，不做状态记录，</span><br><span class="line"> </span><br><span class="line">ansible的模块，yum模块会记录执行的状态</span><br><span class="line">第一次执行，装完之后，的却对目标机器产生了修改的状态，会给master-61返回一个命令执行结果，执行状态，存储下来</span><br><span class="line">ansible web -m yum -a <span class="string">&quot;name=rsync  state=installed&quot;</span></span><br><span class="line"> </span><br><span class="line">ansible会检测目标机器，对比这个状态，如果状态没变，ansible就不会再执行该命令，因此效率很高</span><br><span class="line">ansible web -m yum -a <span class="string">&quot;name=rsync  state=installed&quot;</span></span><br></pre></td></tr></table></figure><p>ansible的状态，颜色区分，看到不同的状态</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">绿色：命令以用户期望的执行了，但是状态没有发生改变；</span><br><span class="line">黄色：命令以用户期望的执行了，并且状态发生了改变； </span><br><span class="line">紫色：警告信息，说明ansible提示你有更合适的用法；出现了warning警告</span><br><span class="line">红色：命令错误，执行失败；</span><br><span class="line">蓝色： 详细的执行过程；</span><br></pre></td></tr></table></figure><hr><h1 id="4）Ansible-模块（核心内容）">4）Ansible 模块（核心内容）</h1><p>Ansible自动化软件的核心功能就在于其众多的模块，可以说学习Ansible就是学习模块的使用。</p><p>剩余的是对Ansible剧本编写的熟练度。</p><h2 id="1-ping-测试连通性">.1 ping 测试连通性</h2><p>📓<a href="https://docs.ansible.com/ansible/latest/collections/ansible/builtin/ping_module.html#ansible-collections-ansible-builtin-ping-module">https://docs.ansible.com/ansible/latest/collections/ansible/builtin/ping_module.html#ansible-collections-ansible-builtin-ping-module</a></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">通过master-61机器，查看目标机器是否运行</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">[root@master-61 ~]<span class="comment">#ansible all -m ping</span></span><br><span class="line">172.16.1.8 | SUCCESS =&gt; &#123;</span><br><span class="line">    <span class="string">&quot;ansible_facts&quot;</span>: &#123;</span><br><span class="line">        <span class="string">&quot;discovered_interpreter_python&quot;</span>: <span class="string">&quot;/usr/bin/python&quot;</span></span><br><span class="line">    &#125;, </span><br><span class="line">    <span class="string">&quot;changed&quot;</span>: <span class="literal">false</span>, </span><br><span class="line">    <span class="string">&quot;ping&quot;</span>: <span class="string">&quot;pong&quot;</span></span><br><span class="line">&#125;</span><br><span class="line">172.16.1.7 | SUCCESS =&gt; &#123;</span><br><span class="line">    <span class="string">&quot;ansible_facts&quot;</span>: &#123;</span><br><span class="line">        <span class="string">&quot;discovered_interpreter_python&quot;</span>: <span class="string">&quot;/usr/bin/python&quot;</span></span><br><span class="line">    &#125;, </span><br><span class="line">    <span class="string">&quot;changed&quot;</span>: <span class="literal">false</span>, </span><br><span class="line">    <span class="string">&quot;ping&quot;</span>: <span class="string">&quot;pong&quot;</span></span><br><span class="line">&#125;</span><br><span class="line">172.16.1.31 | SUCCESS =&gt; &#123;</span><br><span class="line">    <span class="string">&quot;ansible_facts&quot;</span>: &#123;</span><br><span class="line">        <span class="string">&quot;discovered_interpreter_python&quot;</span>: <span class="string">&quot;/usr/bin/python&quot;</span></span><br><span class="line">    &#125;, </span><br><span class="line">    <span class="string">&quot;changed&quot;</span>: <span class="literal">false</span>, </span><br><span class="line">    <span class="string">&quot;ping&quot;</span>: <span class="string">&quot;pong&quot;</span></span><br><span class="line">&#125;</span><br><span class="line">172.16.1.9 | SUCCESS =&gt; &#123;</span><br><span class="line">    <span class="string">&quot;ansible_facts&quot;</span>: &#123;</span><br><span class="line">        <span class="string">&quot;discovered_interpreter_python&quot;</span>: <span class="string">&quot;/usr/bin/python&quot;</span></span><br><span class="line">    &#125;, </span><br><span class="line">    <span class="string">&quot;changed&quot;</span>: <span class="literal">false</span>, </span><br><span class="line">    <span class="string">&quot;ping&quot;</span>: <span class="string">&quot;pong&quot;</span></span><br><span class="line">&#125;</span><br><span class="line">172.16.1.41 | SUCCESS =&gt; &#123;</span><br><span class="line">    <span class="string">&quot;ansible_facts&quot;</span>: &#123;</span><br><span class="line">        <span class="string">&quot;discovered_interpreter_python&quot;</span>: <span class="string">&quot;/usr/bin/python&quot;</span></span><br><span class="line">    &#125;, </span><br><span class="line">    <span class="string">&quot;changed&quot;</span>: <span class="literal">false</span>, </span><br><span class="line">    <span class="string">&quot;ping&quot;</span>: <span class="string">&quot;pong&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="2-command-简单命令模块">.2 command 简单命令模块</h2><p>📓<a href="https://docs.ansible.com/ansible/latest/collections/ansible/builtin/command_module.html#ansible-collections-ansible-builtin-command-module">https://docs.ansible.com/ansible/latest/collections/ansible/builtin/command_module.html#ansible-collections-ansible-builtin-command-module</a></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ansible 主机组 -m <span class="built_in">command</span> -a <span class="string">&quot;需要批量执行的命令&quot;</span></span><br></pre></td></tr></table></figure><p>该模块作用，在远程节点上执行一个命令</p><ul><li>command模块是ansible默认的模块，也就是默认就指定了 -m command</li><li>只支持简单命令命令执行，比如你想远程看下服务器的资源信息，普通的linux命令command模块是ansible命令基本模块</li><li>使用command模块执行远程命令，命令不得用变量（$HOME）</li><li>不得出现特殊符号<code>&lt;  &gt;  |  ;  &amp;</code>,否则无法识别。也就是无法使用复杂的linux命令。</li></ul><h3 id="远程查看主机名">远程查看主机名</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">两个方法</span><br><span class="line"> </span><br><span class="line">[root@master-61 ~]<span class="comment">#ansible web -m command -a &quot;hostname&quot;</span></span><br><span class="line">172.16.1.7 | CHANGED | rc=0 &gt;&gt;</span><br><span class="line">web-7</span><br><span class="line">172.16.1.9 | CHANGED | rc=0 &gt;&gt;</span><br><span class="line">web-9</span><br><span class="line">172.16.1.8 | CHANGED | rc=0 &gt;&gt;</span><br><span class="line">web-8</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">简写，<span class="built_in">command</span>是ansible的基础模块，默认就是 -m <span class="built_in">command</span></span><br><span class="line">[root@master-61 ~]<span class="comment">#ansible web -a &quot;hostname&quot;</span></span><br><span class="line">172.16.1.9 | CHANGED | rc=0 &gt;&gt;</span><br><span class="line">web-9</span><br><span class="line">172.16.1.8 | CHANGED | rc=0 &gt;&gt;</span><br><span class="line">web-8</span><br><span class="line">172.16.1.7 | CHANGED | rc=0 &gt;&gt;</span><br><span class="line">web-7</span><br></pre></td></tr></table></figure><h3 id="远程查看主机内存">远程查看主机内存</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">[root@master-61 ~]<span class="comment">#ansible web -a &quot;free -m&quot;</span></span><br><span class="line">172.16.1.8 | CHANGED | rc=0 &gt;&gt;</span><br><span class="line">              total        used        free      shared  buff/cache   available</span><br><span class="line">Mem:           1821         100        1579           9         141        1561</span><br><span class="line">Swap:             0           0           0</span><br><span class="line">172.16.1.9 | CHANGED | rc=0 &gt;&gt;</span><br><span class="line">              total        used        free      shared  buff/cache   available</span><br><span class="line">Mem:           1821         100        1579           9         141        1560</span><br><span class="line">Swap:             0           0           0</span><br><span class="line">172.16.1.7 | CHANGED | rc=0 &gt;&gt;</span><br><span class="line">              total        used        free      shared  buff/cache   available</span><br><span class="line">Mem:           1821          98        1581           9         141        1562</span><br><span class="line">Swap:             0           0           0</span><br></pre></td></tr></table></figure><h3 id="远程创建文件，查看文件">远程创建文件，查看文件</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">[root@master-61 ~]<span class="comment">#ansible web -m command -a &quot;touch /opt/666.log&quot;</span></span><br><span class="line">[WARNING]: Consider using the file module with state=<span class="built_in">touch</span> rather than running</span><br><span class="line"><span class="string">&#x27;touch&#x27;</span>.  If you need to use <span class="built_in">command</span> because file is insufficient you can add <span class="string">&#x27;warn:</span></span><br><span class="line"><span class="string">false&#x27;</span> to this <span class="built_in">command</span> task or <span class="built_in">set</span> <span class="string">&#x27;command_warnings=False&#x27;</span> <span class="keyword">in</span> ansible.cfg to get rid</span><br><span class="line">of this message.</span><br><span class="line">172.16.1.7 | CHANGED | rc=0 &gt;&gt;</span><br><span class="line"> </span><br><span class="line">172.16.1.8 | CHANGED | rc=0 &gt;&gt;</span><br><span class="line"> </span><br><span class="line">172.16.1.9 | CHANGED | rc=0 &gt;&gt;</span><br><span class="line"> </span><br><span class="line">里面没有东西，</span><br><span class="line">[root@master-61 ~]<span class="comment">#ansible web -m command -a &quot;cat /opt/666.log&quot;</span></span><br><span class="line">172.16.1.8 | CHANGED | rc=0 &gt;&gt;</span><br><span class="line"> </span><br><span class="line">172.16.1.7 | CHANGED | rc=0 &gt;&gt;</span><br><span class="line"> </span><br><span class="line">172.16.1.9 | CHANGED | rc=0 &gt;&gt;</span><br></pre></td></tr></table></figure><h3 id="远程获取机器负载">远程获取机器负载</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[root@master-61 ~]<span class="comment">#ansible web -a &quot;uptime&quot;</span></span><br><span class="line">172.16.1.8 | CHANGED | rc=0 &gt;&gt;</span><br><span class="line"> 20:09:39 up  3:27,  2 <span class="built_in">users</span>,  load average: 0.00, 0.02, 0.05</span><br><span class="line">172.16.1.7 | CHANGED | rc=0 &gt;&gt;</span><br><span class="line"> 20:09:39 up  3:27,  2 <span class="built_in">users</span>,  load average: 0.00, 0.01, 0.05</span><br><span class="line">172.16.1.9 | CHANGED | rc=0 &gt;&gt;</span><br><span class="line"> 20:09:39 up  3:27,  2 <span class="built_in">users</span>,  load average: 0.01, 0.03, 0.05</span><br></pre></td></tr></table></figure><h3 id="关闭告警信息">关闭告警信息</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@master-61 ~]<span class="comment">#ansible web -m command -a &quot;touch /opt/666.log  warn=false &quot;</span></span><br><span class="line">172.16.1.8 | CHANGED | rc=0 &gt;&gt;</span><br><span class="line"> </span><br><span class="line">172.16.1.9 | CHANGED | rc=0 &gt;&gt;</span><br><span class="line"> </span><br><span class="line">172.16.1.7 | CHANGED | rc=0 &gt;&gt;</span><br></pre></td></tr></table></figure><h3 id="在所有机器上，创建wenjie01用户">在所有机器上，创建wenjie01用户</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@master-61 ~]<span class="comment">#ansible web -m command -a &quot;useradd wenjie01&quot;</span></span><br><span class="line">172.16.1.9 | CHANGED | rc=0 &gt;&gt;</span><br><span class="line"> </span><br><span class="line">172.16.1.7 | CHANGED | rc=0 &gt;&gt;</span><br><span class="line"> </span><br><span class="line">172.16.1.8 | CHANGED | rc=0 &gt;&gt;</span><br></pre></td></tr></table></figure><h3 id="使用command提供的专有命令">使用command提供的专有命令</h3><p>这些命令用于编写ansible-playbook，完成服务器部署的各种复杂条件限定</p><table><thead><tr><th>选项参数</th><th>选项说明</th></tr></thead><tbody><tr><td>chdir</td><td>在执行命令执行，通过cd命令进入指定目录</td></tr><tr><td>creates</td><td>定义一个文件是否存在，若不存在，则运行相应命令；存在则跳过</td></tr><tr><td>free_form（必须）</td><td>参数信息中可以输入任何系统命令，实现远程管理</td></tr><tr><td>removes</td><td>定义一个文件是否存在，如果存在，则运行相应命令；如果不存在则跳过</td></tr></tbody></table><h2 id="3-shell模块（万能模块）">.3 shell模块（万能模块）</h2><h1 id="5）playbook-剧本模式">5）playbook 剧本模式</h1><p>Ansible的playbook模式就是针对特定的具体较大的任务，事先写好执行剧本，然后在其他机器上批量执行相同的任务，属于定制化的批量执行任务，例如</p><ul><li>一键安装Rsync</li><li>一键搭建LNMP集群等</li></ul>]]></content>
    
    
    <summary type="html">Ansible 是一种自动化工具，用于配置和管理计算机系统。它使用 YAML 语言来描述配置任务，并通过 SSH 或 WinRM 协议执行这些任务。Ansible 是一种轻量级工具，易于学习和使用，并且不需要在被管理的计算机上安装客户端。它可以用于自动化各种任务，例如软件安装、系统配置和应用程序部署。</summary>
    
    
    
    <category term="Program" scheme="https://blog.halfsummer.xyz/categories/Program/"/>
    
    <category term="Operations" scheme="https://blog.halfsummer.xyz/categories/Program/Operations/"/>
    
    
  </entry>
  
  <entry>
    <title>bitwarden</title>
    <link href="https://blog.halfsummer.xyz/posts/cd0249f6.html"/>
    <id>https://blog.halfsummer.xyz/posts/cd0249f6.html</id>
    <published>2023-02-24T00:09:54.000Z</published>
    <updated>2023-03-11T12:51:07.430Z</updated>
    
    <content type="html"><![CDATA[<meta name="referrer" content="no-referrer" />]]></content>
    
    
      
      
    <summary type="html">&lt;meta name=&quot;referrer&quot; content=&quot;no-referrer&quot; /&gt;
</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>Docker Compose 部署 Zabbix6.0 Server</title>
    <link href="https://blog.halfsummer.xyz/posts/9d568281.html"/>
    <id>https://blog.halfsummer.xyz/posts/9d568281.html</id>
    <published>2023-02-23T19:43:37.000Z</published>
    <updated>2023-03-11T12:51:07.430Z</updated>
    
    <content type="html"><![CDATA[<meta name="referrer" content="no-referrer" /><h1 id="更新日志">更新日志</h1><p>v1.0 Docker-compose 部署 Zabbix6.0 Server（20230223）</p><h1 id="1）部署">1）部署</h1><p>📌 <strong>创建容器映射文件夹</strong>：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> -p /data/zabbix/zabbix-server</span><br><span class="line"><span class="comment"># mkdir -p /data/zabbix/mysql/data # 别创建否则启动不了</span></span><br><span class="line"><span class="built_in">mkdir</span> -p /data/zabbix/mysql/conf</span><br><span class="line"><span class="built_in">mkdir</span> -p /data/zabbix/mysql/logs</span><br><span class="line"><span class="built_in">mkdir</span> -p /data/zabbix/font</span><br><span class="line"><span class="built_in">mkdir</span> -p /data/zabbix/snmptraps</span><br><span class="line"><span class="built_in">mkdir</span> -p /data/zabbix/mibs</span><br><span class="line"><span class="built_in">mkdir</span> -p /data/zabbix/alertscripts</span><br><span class="line"><span class="built_in">mkdir</span> -p /data/zabbix/externalscripts</span><br></pre></td></tr></table></figure><blockquote><p>⚠️ 创建数据库出现错误！</p><blockquote><p>[ERROR] [MY-010457] [Server] --initialize specified but the data directory has files in it. Aborting.<br>[ERROR] [MY-013236] [Server] The designated data directory /var/lib/mysql/ is unusable. You can remove all files<br>docker start</p></blockquote><p>解决方法：</p><blockquote><p>删除掉<code>/data/zabbix/mysql/data</code>，不要去创建这个目录，在启动堆栈时会自行创建。</p></blockquote></blockquote><p>📌 <strong>解决zabbix web的官方字体中文乱码</strong>：</p><p>Win字体在 <code>C:\Windows\Fonts\simfang.ttf</code> 提取。</p><p>将字体文件放入<code>/data/zabbix/mysql/logs</code></p><p>📌<strong>拉取镜像</strong>：</p><p>可以不拉，执行compose命令时如果没有也会拉取。</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">docker pull mysql:8.0</span><br><span class="line">docker pull zabbix/zabbix-java-gateway:6.0-centos-latest</span><br><span class="line">docker pull zabbix/zabbix-snmptraps:6.0-centos-latest</span><br><span class="line">docker pull zabbix/zabbix-server-mysql:6.0-centos-latest</span><br><span class="line">docker pull zabbix/zabbix-web-nginx-mysql:6.0-centos-latest</span><br></pre></td></tr></table></figure><p>检查一下：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker images</span><br></pre></td></tr></table></figure><p>📌 <strong>编辑zabbix6.0-server.yml文件部署容器堆栈</strong></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /data/zabbix</span><br><span class="line">vim ./zabbix6.0-server.yml</span><br></pre></td></tr></table></figure><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br></pre></td><td class="code"><pre><span class="line">version: <span class="string">&#x27;3&#x27;</span></span><br><span class="line">services:</span><br><span class="line">  mysql:</span><br><span class="line">    image: mysql:8.0</span><br><span class="line">    container_name: mysql</span><br><span class="line">    volumes:</span><br><span class="line">      - ./mysql/data:/var/lib/mysql</span><br><span class="line">      - ./mysql/conf:/etc/mysql/conf.d</span><br><span class="line">      - ./mysql/logs:/var/log/mysql</span><br><span class="line">      - /etc/localtime:/etc/localtime</span><br><span class="line">    restart: always</span><br><span class="line">    privileged: <span class="literal">true</span></span><br><span class="line">    environment:</span><br><span class="line">      - MYSQL_ROOT_PASSWORD=myrootpass</span><br><span class="line">      - MYSQL_DATABASE=zabbix</span><br><span class="line">      - MYSQL_USER=zabbix</span><br><span class="line">      - MYSQL_PASSWORD=mypass</span><br><span class="line">      - TZ=Asia/Shanghai</span><br><span class="line">      - LANG=en_US.UTF-8</span><br><span class="line">    expose:</span><br><span class="line">      - <span class="string">&quot;3306&quot;</span></span><br><span class="line">    networks:</span><br><span class="line">      zabbix-net:</span><br><span class="line">    <span class="built_in">command</span>:</span><br><span class="line">      --character-set-server=utf8mb4</span><br><span class="line">      --collation_server=utf8mb4_bin</span><br><span class="line">      --default-authentication-plugin=mysql_native_password</span><br><span class="line">      </span><br><span class="line">  zabbix-gateway:</span><br><span class="line">    image: zabbix/zabbix-java-gateway:6.0-centos-latest</span><br><span class="line">    container_name: zabbix-gateway</span><br><span class="line">    volumes:</span><br><span class="line">      - /etc/localtime:/etc/localtime</span><br><span class="line">    restart: always</span><br><span class="line">    privileged: <span class="literal">true</span></span><br><span class="line">    ports:</span><br><span class="line">      - <span class="string">&quot;10052:10052&quot;</span></span><br><span class="line">    networks:</span><br><span class="line">      zabbix-net:</span><br><span class="line">  zabbix-snmptraps:</span><br><span class="line">    image: zabbix/zabbix-snmptraps:6.0-centos-latest</span><br><span class="line">    container_name: zabbix-snmptraps</span><br><span class="line">    volumes:</span><br><span class="line">      - /etc/localtime:/etc/localtime</span><br><span class="line">      - ./snmptraps:/var/lib/zabbix/snmptraps</span><br><span class="line">      - ./mibs:/var/lib/zabbix/mibs</span><br><span class="line">    restart: always</span><br><span class="line">    privileged: <span class="literal">true</span></span><br><span class="line">    ports:</span><br><span class="line">      - <span class="string">&quot;1162:1162/udp&quot;</span></span><br><span class="line">    networks:</span><br><span class="line">      zabbix-net:</span><br><span class="line">      </span><br><span class="line">  zabbix-server:</span><br><span class="line">    image: zabbix/zabbix-server-mysql:6.0-centos-latest</span><br><span class="line">    container_name: zabbix-server</span><br><span class="line">    volumes:</span><br><span class="line">      - /etc/localtime:/etc/localtime</span><br><span class="line">      - ./snmptraps:/var/lib/zabbix/snmptraps</span><br><span class="line">      - ./mibs:/var/lib/zabbix/mibs</span><br><span class="line">      - ./alertscripts:/usr/lib/zabbix/alertscripts</span><br><span class="line">      - ./externalscripts:/usr/lib/zabbix/externalscripts</span><br><span class="line">    restart: always</span><br><span class="line">    privileged: <span class="literal">true</span></span><br><span class="line">    environment:</span><br><span class="line">      - ZBX_LISTENPORT=10051</span><br><span class="line">      - DB_SERVER_HOST=mysql</span><br><span class="line">      - DB_SERVER_PORT=3306</span><br><span class="line">      - MYSQL_DATABASE=zabbix</span><br><span class="line">      - MYSQL_USER=zabbix</span><br><span class="line">      - MYSQL_PASSWORD=mypass</span><br><span class="line">      - MYSQL_ROOT_PASSWORD=myrootpass</span><br><span class="line">      - ZBX_CACHESIZE=1G</span><br><span class="line">      - ZBX_HISTORYCACHESIZE=512M</span><br><span class="line">      - ZBX_HISTORYINDEXCACHESIZE=16M</span><br><span class="line">      - ZBX_TRENDCACHESIZE=256M</span><br><span class="line">      - ZBX_VALUECACHESIZE=256M</span><br><span class="line">      - ZBX_STARTPINGERS=64</span><br><span class="line">      - ZBX_IPMIPOLLERS=1</span><br><span class="line">      - ZBX_ENABLE_SNMP_TRAPS=<span class="literal">true</span></span><br><span class="line">      - ZBX_STARTTRAPPERS=1</span><br><span class="line">      - ZBX_JAVAGATEWAY_ENABLE=<span class="literal">true</span></span><br><span class="line">      - ZBX_JAVAGATEWAY=zabbix-gateway</span><br><span class="line">      - ZBX_STARTJAVAPOLLERS=1</span><br><span class="line">    ports:</span><br><span class="line">      - <span class="string">&quot;10051:10051&quot;</span></span><br><span class="line">    networks:</span><br><span class="line">      zabbix-net:</span><br><span class="line">    links:</span><br><span class="line">      - mysql</span><br><span class="line">      - zabbix-gateway</span><br><span class="line">      </span><br><span class="line">  zabbix-web:</span><br><span class="line">    image: zabbix/zabbix-web-nginx-mysql:6.0-centos-latest</span><br><span class="line">    container_name: zabbix-web</span><br><span class="line">    volumes:</span><br><span class="line">      - ./font/simfang.ttf:/usr/share/zabbix/assets/fonts/DejaVuSans.ttf</span><br><span class="line">      - /etc/localtime:/etc/localtime</span><br><span class="line">    restart: always</span><br><span class="line">    privileged: <span class="literal">true</span></span><br><span class="line">    environment:</span><br><span class="line">      - ZBX_SERVER_NAME=Zabbix 6.0</span><br><span class="line">      - ZBX_SERVER_HOST=zabbix-server</span><br><span class="line">      - ZBX_SERVER_PORT=10051</span><br><span class="line">      - DB_SERVER_HOST=mysql</span><br><span class="line">      - DB_SERVER_PORT=3306</span><br><span class="line">      - MYSQL_DATABASE=zabbix</span><br><span class="line">      - MYSQL_USER=zabbix</span><br><span class="line">      - MYSQL_PASSWORD=mypass</span><br><span class="line">      - MYSQL_ROOT_PASSWORD=myrootpass</span><br><span class="line">      - PHP_TZ=Asia/Shanghai</span><br><span class="line">    ports:</span><br><span class="line">      - <span class="string">&quot;80:8080&quot;</span></span><br><span class="line">    networks:</span><br><span class="line">      zabbix-net:</span><br><span class="line">    links:</span><br><span class="line">      - mysql</span><br><span class="line">      - zabbix-server</span><br><span class="line">      </span><br><span class="line">networks:</span><br><span class="line">  zabbix-net:</span><br><span class="line">    driver: bridge</span><br><span class="line">    ipam:</span><br><span class="line">      config:</span><br><span class="line">        - subnet: 10.10.10.0/24</span><br><span class="line">          gateway: 10.10.10.1</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>📌 <strong>启动Zabbix Server容器堆栈</strong></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker-compose -f zabbix6.0-server.yml up -d</span><br></pre></td></tr></table></figure><hr><h1 id="2）访问页面成功">2）访问页面成功</h1><p><img src="https://gitee.com/aceniu/images/raw/master/article_images/typora_images/image-20230223233517011.png" alt="image-20230223233517011"></p><h1 id="3）如何让“本”宿主机的agent连上docker内的zabbix-server？">3）如何让“本”宿主机的agent连上docker内的zabbix server？</h1><p>1️⃣修改agent的配置文件：（我这里用的是zabbix-agent2）</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># xxx.xxx.xxx 处填入你的宿主机ip</span></span><br><span class="line">sed -i <span class="string">&#x27;s#Server=127.0.0.1#Server=xxx.xxx.xxx#g&#x27;</span> /etc/zabbix/zabbix_agent2.conf</span><br><span class="line"></span><br><span class="line">systemctl restart zabbix-agent2</span><br></pre></td></tr></table></figure><p>2️⃣修改web端中</p><p>监测-&gt;主机-&gt;选择主机-&gt;配置</p><p><img src="https://gitee.com/aceniu/images/raw/master/article_images/typora_images/image-20230224233232822.png" alt="image-20230224233232822"></p><p><img src="https://gitee.com/aceniu/images/raw/master/article_images/typora_images/image-20230224233451067.png" alt="image-20230224233451067"></p><p>启动有时候比较慢稍微等待个30s，然后图标就变绿了~</p>]]></content>
    
    
      
      
    <summary type="html">&lt;meta name=&quot;referrer&quot; content=&quot;no-referrer&quot; /&gt;
&lt;h1 id=&quot;更新日志&quot;&gt;更新日志&lt;/h1&gt;
&lt;p&gt;v1.0 Docker-compose 部署 Zabbix6.0 Server（20230223）&lt;/p&gt;
&lt;h1 id=&quot;1）部署</summary>
      
    
    
    
    <category term="Program" scheme="https://blog.halfsummer.xyz/categories/Program/"/>
    
    <category term="Operations" scheme="https://blog.halfsummer.xyz/categories/Program/Operations/"/>
    
    
    <category term="Zabbix" scheme="https://blog.halfsummer.xyz/tags/Zabbix/"/>
    
  </entry>
  
  <entry>
    <title>Docker 部署兰空图床 Lsky Pro + Picgo</title>
    <link href="https://blog.halfsummer.xyz/posts/bacf3f29.html"/>
    <id>https://blog.halfsummer.xyz/posts/bacf3f29.html</id>
    <published>2023-02-23T11:22:23.000Z</published>
    <updated>2023-03-11T12:51:07.430Z</updated>
    
    <content type="html"><![CDATA[<meta name="referrer" content="no-referrer" /><p><img src="https://gitee.com/aceniu/images/raw/master/article_images/typora_images/Snipaste_2023-02-23_13-49-43.png" alt="Snipaste_2023-02-23_13-49-43"></p><blockquote><p><strong>Nginx 是一个高性能的HTTP和反向代理web服务器，同时也提供了IMAP/POP3/SMTP服务。</strong></p><p><strong><a href="http://Acme.sh">Acme.sh</a> 是一个自动申请证书工具。</strong></p><p><strong>Lsky Pro 兰空图床可以帮您保管大量无处安放的图片，数据可以自由选择储存驱动，支持主流第三方储存。作为一个助手，它不仅可以将您把图片以指定规则存放在指定位置，还有更多强大的功能来帮助您处理这些图片。</strong></p><p><strong>Mariadb是一个关系型数据库管理系统。</strong></p><p><strong>Picgo 一个用于快速上传图片并获取图片 URL 链接的工具</strong></p></blockquote><h1 id="更新日志：">更新日志：</h1><p><strong>v1.0 Docker 安装兰空图床（20230223）</strong></p><p><strong>v1.1 拉取新的lsky镜像 修改nginx的配置文件 增加获取tokens的方法（20230302）</strong></p><h1 id="1）安装-Docker">1）安装 Docker</h1><h2 id="1-环境设置">1. 环境设置</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">wget -O /etc/yum.repos.d/Centos-base.repo http://mirrors.aliyun.com/repo/Centos-7.repo</span><br><span class="line">wget -O /etc/yum.repos.d/epel.repo http://mirrors.aliyun.com/repo/epel-7.repo</span><br><span class="line">yum clean all</span><br><span class="line">yum makecache</span><br></pre></td></tr></table></figure><h2 id="2-开启-Linux-内核的流量转发">2. 开启 Linux 内核的流量转发</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span> &lt;&lt;<span class="string">EOF &gt; /etc/sysctl.d/docker.conf</span></span><br><span class="line"><span class="string">net.bridge.bridge-nf-call-ip6tables = 1</span></span><br><span class="line"><span class="string">net.bridge.bridge-nf-call-iptables = 1</span></span><br><span class="line"><span class="string">net.ipv4.conf.default.rp_filter = 0</span></span><br><span class="line"><span class="string">net.ipv4.conf.all.rp_filter = 0</span></span><br><span class="line"><span class="string">net.ipv4.ip_forward=1</span></span><br><span class="line"><span class="string">EOF</span></span><br></pre></td></tr></table></figure><h2 id="3-重新加载修改内核参数的配置文件">3. 重新加载修改内核参数的配置文件</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 向内核中加载模块</span></span><br><span class="line">modprobe br_netfilter</span><br><span class="line"><span class="comment"># 重新加载配置文件</span></span><br><span class="line">sysctl -p /etc/sysctl.d/docker.conf</span><br></pre></td></tr></table></figure><h2 id="4-yum安装-Docker">4. yum安装 Docker</h2><p>首先需要将虚拟机联网，安装yum工具、存储驱动、逻辑卷管理：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install -y yum-utils device-mapper-persistent-data lvm2 --skip-broken</span><br></pre></td></tr></table></figure><p>更新本地镜像源：(<code>yum-config-manager</code> 命令的本质是对 <code>/etc/yum.repos.d/</code>(库数据的储存位置)文件夹下文件的增删查改。)</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">yum-config-manager --add-repo https://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo</span><br><span class="line">sed -i <span class="string">&#x27;s/download.docker.com/mirrors.aliyun.com\/docker-ce/g&#x27;</span> /etc/yum.repos.d/docker-ce.repo</span><br><span class="line">yum makecache fast</span><br></pre></td></tr></table></figure><p>安装docker-ce：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum -y install docker-ce</span><br></pre></td></tr></table></figure><h2 id="5-配置镜像加速器">5. 配置镜像加速器</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> -p /etc/docker</span><br><span class="line"><span class="built_in">touch</span> /etc/docker/daemon.conf</span><br><span class="line">vim /etc/docker/daemon.conf</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">　　<span class="string">&quot;registry-mirrors&quot;</span>:[</span><br><span class="line">　　　　<span class="string">&quot;https://8xpk5wnt.mirror.aliyun.com&quot;</span></span><br><span class="line">　　]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="6-启动-Docker">6. 启动 Docker</h2><p><strong>关闭防火墙</strong>：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 关闭</span></span><br><span class="line">systemctl stop firewalld</span><br><span class="line"><span class="comment"># 禁止开机启动防火墙</span></span><br><span class="line">systemctl <span class="built_in">disable</span> firewalld</span><br></pre></td></tr></table></figure><p><strong>启动 docker</strong>：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 添加开机启动</span></span><br><span class="line">systemctl <span class="built_in">enable</span> docker</span><br><span class="line"><span class="comment"># 启动服务</span></span><br><span class="line">systemctl start docker</span><br></pre></td></tr></table></figure><hr><h1 id="2）安装docker-compose">2）安装docker-compose</h1><p>切记docker-compose不要使用yum安装，版本太旧。</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">sudo curl -L <span class="string">&quot;https://github.com/docker/compose/releases/download/v2.16.0/docker-compose-<span class="subst">$(uname -s)</span>-<span class="subst">$(uname -m)</span>&quot;</span> -o /usr/local/bin/docker-compose</span><br><span class="line"><span class="comment">#或</span></span><br><span class="line"><span class="comment">#curl -L https://get.daocloud.io/docker/compose/releases/download/v2.16.0/docker-compose-`uname -s`-`uname -m` &gt; /usr/local/bin/docker-compose</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">chmod</span> +x /usr/local/bin/docker-compose</span><br><span class="line"></span><br><span class="line"><span class="comment"># 不用 </span></span><br><span class="line"><span class="comment"># ln -s /usr/local/bin/docker-compose /usr/bin/docker-compose</span></span><br></pre></td></tr></table></figure><hr><h1 id="3）Nginx-配置">3）Nginx 配置</h1><p><strong>创建容器卷映射文件夹</strong>：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> -p /data/nginx/conf</span><br><span class="line"><span class="built_in">mkdir</span> /data/nginx/html</span><br><span class="line"><span class="built_in">mkdir</span> /data/nginx/logs</span><br></pre></td></tr></table></figure><p>启动下 Nginx 容器：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run --<span class="built_in">rm</span> --name temp-nginx -d nginx</span><br></pre></td></tr></table></figure><p><strong>复制容器内的内容</strong>：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">docker <span class="built_in">cp</span> temp-nginx:/etc/nginx/nginx.conf /data/nginx/conf/nginx.conf</span><br><span class="line">docker <span class="built_in">cp</span> temp-nginx:/etc/nginx/conf.d /data/nginx/conf/conf.d</span><br><span class="line">docker <span class="built_in">cp</span> temp-nginx:/usr/share/nginx/html /data/nginx</span><br><span class="line"><span class="built_in">chmod</span> 777 /data/nginx/conf/nginx.conf</span><br></pre></td></tr></table></figure><p><strong>关闭容器</strong>：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker stop temp-nginx</span><br></pre></td></tr></table></figure><p><strong>新建配置文件</strong>：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vi /data/nginx/conf/conf.d/lsky-pro.conf</span><br></pre></td></tr></table></figure><p><strong>黏贴以下配置</strong>：</p><p>使用的自己的ssl证书</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">    listen  80;</span><br><span class="line">    server_namexxx.xxxx.xxx;<span class="comment"># 图床的访问地址（填自己的） </span></span><br><span class="line">    rewrite ^(.*) https://$host<span class="variable">$1</span> permanent;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">server &#123;</span><br><span class="line">    listen 443 ssl;</span><br><span class="line">    server_namexxx.xxxx.xxx;<span class="comment"># 图床的访问地址（填自己的） </span></span><br><span class="line">    ssl_certificate     /cert/fullchain.cer;<span class="comment"># ssl证书（填自己的） </span></span><br><span class="line">    ssl_certificate_key /cert/*.xxx.xxx.key;<span class="comment"># key（填自己的） </span></span><br><span class="line">    ssl_session_cache shared:SSL:1m;</span><br><span class="line">    ssl_session_timeout 30m;</span><br><span class="line">    ssl_protocols TLSv1 TLSv1.1 TLSv1.2;</span><br><span class="line">    ssl_ciphers HIGH:!aNULL:!MD5:!EXPORT56:!EXP;</span><br><span class="line">    ssl_prefer_server_ciphers on;</span><br><span class="line">    proxy_connect_timeout 500;</span><br><span class="line">    proxy_send_timeout 500;</span><br><span class="line">    proxy_read_timeout 500;</span><br><span class="line">    client_max_body_size 10m;<span class="comment"># 上传的图片的最大大小</span></span><br><span class="line"></span><br><span class="line">    location / &#123;</span><br><span class="line">        proxy_pass http://172.28.0.3;<span class="comment"># docker中lsky app的ip</span></span><br><span class="line">        proxy_set_header Host <span class="variable">$host</span>:443;</span><br><span class="line">        proxy_set_header X-Real-IP <span class="variable">$remote_addr</span>;</span><br><span class="line">        proxy_set_header X-Forwarded-For <span class="variable">$proxy_add_x_forwarded_for</span>;</span><br><span class="line">        proxy_set_header X-Forwarded-Proto <span class="variable">$scheme</span>;</span><br><span class="line">        proxy_set_header REMOTE-HOST <span class="variable">$remote_addr</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>按</strong><kbd>i</kbd>，<kbd>Shift</kbd> + <kbd>Ctrl</kbd> + <kbd>v</kbd> 黏贴；</p><p><strong>按</strong><kbd>Esc</kbd><strong>输入</strong><code>:wq</code>。<strong>保存后退出</strong>。</p><h1 id="4）安装兰空图床">4）安装兰空图床</h1><p><strong>创建lsky-pro的根目录</strong>：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> /data/lsky-pro</span><br><span class="line"><span class="built_in">cd</span> /mydata/lsky-pro</span><br></pre></td></tr></table></figure><p><strong>写入docker-compose.yml配置</strong>：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim docker-compose.yml</span><br></pre></td></tr></table></figure><p><strong>黏贴下面的配置</strong>：</p><p>⚠️ <strong>坑点</strong>：</p><p>1️⃣<span style="color:red;">大部分新手阵亡于此。因为yaml文件对格式缩进要求很严格，请自行使用格式化工具或者手动调整缩进。</span></p><p>2️⃣这里强行指定网络，不然如果重启容器内经常会混乱。<strong><span style="background:cyan; ">我自己也在这里卡了好久</span></strong>。</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line">version: <span class="string">&quot;3.9&quot;</span></span><br><span class="line">services:</span><br><span class="line">    nginx:<span class="comment"># Nginx 反向代理</span></span><br><span class="line">        image: nginx:latest</span><br><span class="line">        container_name: nginx</span><br><span class="line">        depends_on:</span><br><span class="line">            - acme.sh</span><br><span class="line">        volumes:</span><br><span class="line">            - /data/nginx/conf/nginx.conf:/etc/nginx/nginx.conf</span><br><span class="line">            - /data/nginx/conf/conf.d:/etc/nginx/conf.d</span><br><span class="line">            - /data/nginx/html:/usr/share/nginx/html</span><br><span class="line">            - /data/nginx/logs:/var/log/nginx</span><br><span class="line">            - /data/acme/*.xxxx.xxx_ecc:/cert  <span class="comment"># 证书文件夹 lsky 申请证书 （填自己的）   </span></span><br><span class="line">        ports:<span class="comment"># 对外开放 80 (http) 和 443 (https) 端口</span></span><br><span class="line">            - 80:80</span><br><span class="line">            - 443:443</span><br><span class="line">        restart: always</span><br><span class="line">        networks:</span><br><span class="line">            mynetwork:</span><br><span class="line">                ipv4_address: 172.28.0.2</span><br><span class="line">  </span><br><span class="line">    acme.sh:<span class="comment"># ssl证书生成</span></span><br><span class="line">        image: neilpang/acme.sh</span><br><span class="line">        container_name: acme.sh</span><br><span class="line">        restart: always</span><br><span class="line">        environment:</span><br><span class="line">            - CF_Token=xxxxxxxxxxxxx<span class="comment">#我这里是 CloudFlare</span></span><br><span class="line">            - CF_Account_ID=xxxxxxxxxxxxx<span class="comment">#我这里是 CloudFlare</span></span><br><span class="line">        <span class="built_in">command</span>: daemon</span><br><span class="line">        volumes:</span><br><span class="line">            - /data/acme:/acme.sh</span><br><span class="line">        networks:</span><br><span class="line">            mynetwork:</span><br><span class="line">                ipv4_address: 172.28.0.3</span><br><span class="line"></span><br><span class="line">    lsky:</span><br><span class="line">        image: halcyonazure/lsky-pro-docker:latest</span><br><span class="line">        container_name: lsky</span><br><span class="line">        restart: always</span><br><span class="line">        ports:</span><br><span class="line">            - 8080:80     <span class="comment"># 如果使用nginx无需放开防火墙8080</span></span><br><span class="line">        volumes:</span><br><span class="line">            - /data/web:/var/www/html</span><br><span class="line">        networks:</span><br><span class="line">            mynetwork:</span><br><span class="line">                ipv4_address: 172.28.0.4</span><br><span class="line"></span><br><span class="line">    mariadb:</span><br><span class="line">        image: mariadb</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 其中包含了WordPress的核心数据信息</span></span><br><span class="line">        container_name: mariadb</span><br><span class="line">        volumes:</span><br><span class="line">           - /data/mariadb_data:/var/lib/mysql<span class="comment"># 映射mariadb容器内存放数据库数据的文件夹</span></span><br><span class="line">        restart: always</span><br><span class="line">        environment:<span class="comment"># 下面的环境变量会在数据库数据文件夹已存在时失效</span></span><br><span class="line">            MYSQL_ROOT_PASSWORD: password<span class="comment"># root用户的初始密码</span></span><br><span class="line">            MYSQL_DATABASE: lsky<span class="comment"># 使用的数据库</span></span><br><span class="line">            MYSQL_USER: lsky<span class="comment"># 使用的用户</span></span><br><span class="line">            MYSQL_PASSWORD: lsky<span class="comment"># 使用的用户的密码</span></span><br><span class="line">        networks:</span><br><span class="line">            mynetwork:</span><br><span class="line">                ipv4_address: 172.28.0.5</span><br><span class="line"></span><br><span class="line">networks:</span><br><span class="line">    mynetwork:</span><br><span class="line">        driver: bridge</span><br><span class="line">        ipam:</span><br><span class="line">            driver: default</span><br><span class="line">            config:</span><br><span class="line">                - subnet: 172.28.0.0/16</span><br><span class="line">                  gateway: 172.28.0.1</span><br></pre></td></tr></table></figure><p><strong>按</strong><kbd>i</kbd>，<kbd>Shift</kbd> + <kbd>Ctrl</kbd> + <kbd>v</kbd> 黏贴；</p><p><strong>按</strong><kbd>Esc</kbd><strong>输入</strong><code>:wq</code>。<strong>保存后退出</strong>。</p><p><strong>启动容器</strong>：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker-compose up -d</span><br></pre></td></tr></table></figure><p><strong>检查容器</strong>：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker ps</span><br></pre></td></tr></table></figure><hr><h1 id="5）申请证书">5）申请证书</h1><p><strong>为 Lsky Pro 及 phpmyadmin 申请证书</strong>：</p><p><a href="https://blog.cloudwai.com/archives/1171/">证书申请参考</a> 。域名可以使用<code>*.baidu.com</code>这种格式申请泛域名，也可申请泛域名。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker exec -it acme.sh acme.sh --issue --server letsencrypt --dns dns_cf -d xxx.xxx.xxx --nginx</span><br></pre></td></tr></table></figure><p><strong>申请成功后重启 docker-compose</strong>：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker-compose restart</span><br></pre></td></tr></table></figure><p><strong>查看证书续签时间间隔</strong>:</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker <span class="built_in">exec</span> -it acme.sh crontab -l</span><br></pre></td></tr></table></figure><p><strong>开启 <a href="http://acme.sh">acme.sh</a> 自动更新</strong>：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker <span class="built_in">exec</span> -it acme.sh acme.sh --upgrade --auto-upgrade</span><br></pre></td></tr></table></figure><p><strong>由于证书更新后需要重启nginx重启才能识别，所以添加一条定时重启 nginx 容器 的命令</strong>:</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">crontab -e</span><br></pre></td></tr></table></figure><p><strong>添加为 每天 0点30分 重启nginx</strong>:</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">30 0 * * * docker restart nginx</span><br></pre></td></tr></table></figure><p>如在云服务器中配置则直接解析域名到IP地址即可访问</p><p>如在本地自建DNS服务器则解析IP地址到本地DNS服务器即可访问</p><p>如在本机或局域网测试环境直接修改电脑 hosts 文件 解析IP即可访问</p><hr><h1 id="6）Lsky-Pro-网页配置">6）Lsky Pro 网页配置</h1><p>进入 Lsky Pro，地址栏敲入<a href="localhost">localhost</a></p><p><img src="https://gitee.com/aceniu/images/raw/master/article_images/typora_images/image-20230223134357186.png" alt="image-20230223134357186"></p><p>配置数据库</p><p><img src="https://gitee.com/aceniu/images/raw/master/article_images/typora_images/image-20230223132938740.png" alt="image-20230223132938740"></p><p>设置管理员账号，下一步</p><p><img src="https://gitee.com/aceniu/images/raw/master/article_images/typora_images/image-20230223134443852.png" alt="image-20230223134443852"></p><hr><h1 id="7）获取tokens">7）获取tokens</h1><p>这里需要使用postman，然后按下图操作即可</p><p><img src="https://images.halfsummer.xyz/i/pictures/niubb/2023/20230302-64004f617ceab.png" alt="Snipaste_2023-03-02_14-38-00"></p><p><img src="https://images.halfsummer.xyz/i/pictures/niubb/2023/20230302-64004f83be2dd.png" alt="image-20230302142413980"></p><p><img src="https://images.halfsummer.xyz/i/pictures/niubb/2023/20230302-64004f8f791dd.png" alt="Snipaste_2023-03-02_14-34-28"></p><h1 id="8）Picgo">8）Picgo</h1><p>下载 Picgo 客户端</p><p>进入 <a href="https://aoliyougei.com/?golink=aHR0cHM6Ly9naXRodWIuY29tL01vbHVuZXJmaW5uL1BpY0dv">GitHub</a> 中 点击 Releases</p><p><img src="https://gitee.com/aceniu/images/raw/master/article_images/typora_images/image-20230223135552637.png" alt="image-20230223135552637"></p><p>下载对应版本</p><p><img src="https://gitee.com/aceniu/images/raw/master/article_images/typora_images/image-20230223135700744.png" alt="image-20230223135700744"></p><p>打开 PicGo 客户端 &gt;插件设置&gt;搜索&gt;lsky&gt;安装</p><p><img src="https://images.halfsummer.xyz/i/pictures/niubb/2023/20230302-64004e5012f5a.png" alt="Snipaste_2023-03-02_15-16-16"></p><p>提示缺少 node.js 点击 yes 转跳至官网下载，Node.js 安装完成后再次安装插件（略）</p><p>PicGo &gt;插件设置&gt;配置 uploader – lankong &gt;设置相关选项</p><p><img src="https://images.halfsummer.xyz/i/pictures/niubb/2023/20230302-64004e6b94e0c.png" alt="Snipaste_2023-03-02_15-18-15"></p><h1 id="9）迁移">9）迁移</h1><p>打包了整个public和数据库，到新机器完成配置后先默认走一遍流程看能初始化网页不，然后覆盖。</p><ul><li>打包public的映射web</li><li>打包整个mariadb的映射-直接tar全量备份了没啥东西</li></ul>]]></content>
    
    
    <summary type="html">LskyPro 兰空图床，托管图片的图床程序（上传图片，提供URL)</summary>
    
    
    
    <category term="Tool" scheme="https://blog.halfsummer.xyz/categories/Tool/"/>
    
    
    <category term="兰空" scheme="https://blog.halfsummer.xyz/tags/%E5%85%B0%E7%A9%BA/"/>
    
    <category term="图床" scheme="https://blog.halfsummer.xyz/tags/%E5%9B%BE%E5%BA%8A/"/>
    
  </entry>
  
  <entry>
    <title>Hexo 中使用 emoji 表情</title>
    <link href="https://blog.halfsummer.xyz/posts/9fc1e5d1.html"/>
    <id>https://blog.halfsummer.xyz/posts/9fc1e5d1.html</id>
    <published>2023-02-15T00:05:54.000Z</published>
    <updated>2023-03-11T12:51:07.430Z</updated>
    
    <content type="html"><![CDATA[<meta name="referrer" content="no-referrer" /><h1 id="1）安装">1）安装</h1><details class="folding-tag" blue open><summary> 安装 </summary>              <div class='content'>              <p>卸载 <code>hexo-renderer-marked</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm un hexo-renderer-marked --save</span><br></pre></td></tr></table></figure><p>安装 <code>hexo-renderer-markdown-it</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i hexo-renderer-markdown-it --save</span><br></pre></td></tr></table></figure>              </div>            </details><hr><h1 id="2）配置">2）配置</h1><details class="folding-tag" blue open><summary> 配置 </summary>              <div class='content'>              <p>完成插件安装后还需要修改 Hexo 站点配置文件 <code>_config.yml</code></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># markdown 渲染引擎配置</span></span><br><span class="line"><span class="comment"># 默认是hexo-renderer-marked</span></span><br><span class="line"><span class="comment"># 当前为hexo-renderer-markdown-it</span></span><br><span class="line">markdown:</span><br><span class="line">  preset: <span class="string">&quot;default&quot;</span></span><br><span class="line">  render:</span><br><span class="line">    html: <span class="literal">true</span></span><br><span class="line">    xhtmlOut: <span class="literal">false</span></span><br><span class="line">    <span class="comment"># langPrefix: &quot;language-&quot;</span></span><br><span class="line">    breaks: <span class="literal">true</span></span><br><span class="line">    linkify: <span class="literal">true</span></span><br><span class="line">    typographer: <span class="literal">true</span></span><br><span class="line">    quotes: <span class="string">&quot;“”‘’&quot;</span></span><br><span class="line">  <span class="comment"># enable_rules:</span></span><br><span class="line">  <span class="comment"># disable_rules:</span></span><br><span class="line">  plugins:</span><br><span class="line">    - markdown-it-abbr</span><br><span class="line">    - markdown-it-cjk-breaks</span><br><span class="line">    - markdown-it-deflist</span><br><span class="line">    - markdown-it-emoji</span><br><span class="line">    - markdown-it-footnote</span><br><span class="line">    <span class="comment"># - markdown-it-ins</span></span><br><span class="line">    <span class="comment"># - markdown-it-mark</span></span><br><span class="line">    <span class="comment"># - markdown-it-sub</span></span><br><span class="line">    <span class="comment"># - markdown-it-sup</span></span><br><span class="line">    <span class="comment"># - markdown-it-checkbox</span></span><br><span class="line">    <span class="comment"># - markdown-it-imsize</span></span><br><span class="line">    <span class="comment"># - markdown-it-expandable</span></span><br><span class="line">    <span class="comment"># - name: markdown-it-container</span></span><br><span class="line">    <span class="comment">#   options: success</span></span><br><span class="line">    <span class="comment"># - name: markdown-it-container</span></span><br><span class="line">    <span class="comment">#   options: tips</span></span><br><span class="line">    <span class="comment"># - name: markdown-it-container</span></span><br><span class="line">    <span class="comment">#   options: warning</span></span><br><span class="line">    <span class="comment"># - name: markdown-it-container</span></span><br><span class="line">    <span class="comment">#   options: danger</span></span><br><span class="line">  anchors:</span><br><span class="line">    level: 1</span><br><span class="line">    collisionSuffix: <span class="string">&quot;v&quot;</span></span><br><span class="line">    permalink: <span class="literal">false</span></span><br><span class="line">    permalinkClass: <span class="string">&quot;header-anchor&quot;</span></span><br><span class="line">    <span class="comment"># permalinkSide: &quot;left&quot;</span></span><br><span class="line">    permalinkSymbol: <span class="string">&quot;¶&quot;</span></span><br><span class="line">    <span class="comment"># case: 0</span></span><br><span class="line">    <span class="comment"># separator: &quot;-&quot;</span></span><br></pre></td></tr></table></figure>              </div>            </details><hr><h1 id="3）使用方法">3）使用方法</h1><details class="folding-tag" blue><summary> 使用方法 </summary>              <div class='content'>              <p>输入对应的emoji编码就行了例如：输入笑脸对应的 emoji 编码 😄 就可以得到 😄</p>              </div>            </details><hr><h1 id="4）emoji表情编码合集">4）emoji表情编码合集</h1><details class="folding-tag" blue><summary> emoji表情编码合集 </summary>              <div class='content'>              <p>People</p><table>  <thead>    <tr>      <th align="left">😐<code>:neutral_face:</code></th>      <th align="left">😄<code>:smile:</code></th>      <th align="left">😆<code>:laughing:</code></th>    </tr>  </thead>  <tbody>    <tr>      <td align="left">😊<code>:blush:</code></td>      <td align="left">😃<code>:smiley:</code></td>      <td align="left">☺️<code>:relaxed:</code></td>    </tr>    <tr>      <td align="left">😏<code>:smirk:</code></td>      <td align="left">😍<code>:heart_eyes:</code></td>      <td align="left">😘<code>:kissing_heart:</code></td>    </tr>    <tr>      <td align="left">😚<code>:kissing_closed_eyes:</code></td>      <td align="left">😳<code>:flushed:</code></td>      <td align="left">😌<code>:relieved:</code></td>    </tr>    <tr>      <td align="left">😆<code>:satisfied:</code></td>      <td align="left">😁<code>:grin:</code></td>      <td align="left">😉<code>:wink:</code></td>    </tr>    <tr>      <td align="left">😜<code>:stuck_out_tongue_winking_eye:</code></td>      <td align="left">😝<code>:stuck_out_tongue_closed_eyes:</code></td>      <td align="left">😀<code>:grinning:</code></td>    </tr>    <tr>      <td align="left">😗<code>:kissing:</code></td>      <td align="left">😙<code>:kissing_smiling_eyes:</code></td>      <td align="left">😛<code>:stuck_out_tongue:</code></td>    </tr>    <tr>      <td align="left">😴<code>:sleeping:</code></td>      <td align="left">😟<code>:worried:</code></td>      <td align="left">😦<code>:frowning:</code></td>    </tr>    <tr>      <td align="left">😧<code>:anguished:</code></td>      <td align="left">😮<code>:open_mouth:</code></td>      <td align="left">😬<code>:grimacing:</code></td>    </tr>    <tr>      <td align="left">😕<code>:confused:</code></td>      <td align="left">😯<code>:hushed:</code></td>      <td align="left">😑<code>:expressionless:</code></td>    </tr>    <tr>      <td align="left">😒<code>:unamused:</code></td>      <td align="left">😅<code>:sweat_smile:</code></td>      <td align="left">😓<code>:sweat:</code></td>    </tr>    <tr>      <td align="left">😥<code>:disappointed_relieved:</code></td>      <td align="left">😩<code>:weary:</code></td>      <td align="left">😔<code>:pensive:</code></td>    </tr>    <tr>      <td align="left">😞<code>:disappointed:</code></td>      <td align="left">😖<code>:confounded:</code></td>      <td align="left">😨<code>:fearful:</code></td>    </tr>    <tr>      <td align="left">😰<code>:cold_sweat:</code></td>      <td align="left">😣<code>:persevere:</code></td>      <td align="left">😢<code>:cry:</code></td>    </tr>    <tr>      <td align="left">😭<code>:sob:</code></td>      <td align="left">😂<code>:joy:</code></td>      <td align="left">😲<code>:astonished:</code></td>    </tr>    <tr>      <td align="left">😱<code>:scream:</code></td>      <td align="left">💭<code>:thought_balloon:</code></td>      <td align="left">😫<code>:tired_face:</code></td>    </tr>    <tr>      <td align="left">😠<code>:angry:</code></td>      <td align="left">😡<code>:rage:</code></td>      <td align="left">😤<code>:triumph:</code></td>    </tr>    <tr>      <td align="left">😪<code>:sleepy:</code></td>      <td align="left">😋<code>:yum:</code></td>      <td align="left">😷<code>:mask:</code></td>    </tr>    <tr>      <td align="left">😎<code>:sunglasses:</code></td>      <td align="left">😵<code>:dizzy_face:</code></td>      <td align="left">👿<code>:imp:</code></td>    </tr>    <tr>      <td align="left">😈<code>:smiling_imp:</code></td>      <td align="left">💬<code>:speech_balloon:</code></td>      <td align="left">😶<code>:no_mouth:</code></td>    </tr>    <tr>      <td align="left">😇<code>:innocent:</code></td>      <td align="left">👽<code>:alien:</code></td>      <td align="left">💛<code>:yellow_heart:</code></td>    </tr>    <tr>      <td align="left">💙<code>:blue_heart:</code></td>      <td align="left">💜<code>:purple_heart:</code></td>      <td align="left">❤️<code>:heart:</code></td>    </tr>    <tr>      <td align="left">💚<code>:green_heart:</code></td>      <td align="left">💔<code>:broken_heart:</code></td>      <td align="left">💓<code>:heartbeat:</code></td>    </tr>    <tr>      <td align="left">💗<code>:heartpulse:</code></td>      <td align="left">💕<code>:two_hearts:</code></td>      <td align="left">💞<code>:revolving_hearts:</code></td>    </tr>    <tr>      <td align="left">💘<code>:cupid:</code></td>      <td align="left">💖<code>:sparkling_heart:</code></td>      <td align="left">✨<code>:sparkles:</code></td>    </tr>    <tr>      <td align="left">⭐️<code>:star:</code></td>      <td align="left">🌟<code>:star2:</code></td>      <td align="left">💫<code>:dizzy:</code></td>    </tr>    <tr>      <td align="left">💥<code>:boom:</code></td>      <td align="left">💥<code>:collision:</code></td>      <td align="left">💢<code>:anger:</code></td>    </tr>    <tr>      <td align="left">❗️<code>:exclamation:</code></td>      <td align="left">❓<code>:question:</code></td>      <td align="left">❕<code>:grey_exclamation:</code></td>    </tr>    <tr>      <td align="left">❔<code>:grey_question:</code></td>      <td align="left">💤<code>:zzz:</code></td>      <td align="left">💨<code>:dash:</code></td>    </tr>    <tr>      <td align="left">💦<code>:sweat_drops:</code></td>      <td align="left">🎶<code>:notes:</code></td>      <td align="left">🎵<code>:musical_note:</code></td>    </tr>    <tr>      <td align="left">🔥<code>:fire:</code></td>      <td align="left">💩<code>:hankey:</code></td>      <td align="left">💩<code>:poop:</code></td>    </tr>    <tr>      <td align="left">💩<code>:shit:</code></td>      <td align="left">👍<code>:+1:</code></td>      <td align="left">👍<code>:thumbsup:</code></td>    </tr>    <tr>      <td align="left">👎<code>:-1:</code></td>      <td align="left">👎<code>:thumbsdown:</code></td>      <td align="left">👌<code>:ok_hand:</code></td>    </tr>    <tr>      <td align="left">👊<code>:punch:</code></td>      <td align="left">👊<code>:facepunch:</code></td>      <td align="left">✊<code>:fist:</code></td>    </tr>    <tr>      <td align="left">✌️<code>:v:</code></td>      <td align="left">👋<code>:wave:</code></td>      <td align="left">✋<code>:hand:</code></td>    </tr>    <tr>      <td align="left">✋<code>:raised_hand:</code></td>      <td align="left">👐<code>:open_hands:</code></td>      <td align="left">☝️<code>:point_up:</code></td>    </tr>    <tr>      <td align="left">👇<code>:point_down:</code></td>      <td align="left">👈<code>:point_left:</code></td>      <td align="left">👉<code>:point_right:</code></td>    </tr>    <tr>      <td align="left">🙌<code>:raised_hands:</code></td>      <td align="left">🙏<code>:pray:</code></td>      <td align="left">👆<code>:point_up_2:</code></td>    </tr>    <tr>      <td align="left">👏<code>:clap:</code></td>      <td align="left">💪<code>:muscle:</code></td>      <td align="left">🤘<code>:metal:</code></td>    </tr>    <tr>      <td align="left">🖕<code>:fu:</code></td>      <td align="left">🚶<code>:walking:</code></td>      <td align="left">🏃<code>:runner:</code></td>    </tr>    <tr>      <td align="left">🏃<code>:running:</code></td>      <td align="left">👫<code>:couple:</code></td>      <td align="left">👪<code>:family:</code></td>    </tr>    <tr>      <td align="left">👬<code>:two_men_holding_hands:</code></td>      <td align="left">👭<code>:two_women_holding_hands:</code></td>      <td align="left">💃<code>:dancer:</code></td>    </tr>    <tr>      <td align="left">👯<code>:dancers:</code></td>      <td align="left">🙆<code>:ok_woman:</code></td>      <td align="left">🙅<code>:no_good:</code></td>    </tr>    <tr>      <td align="left">💁<code>:information_desk_person:</code></td>      <td align="left">🙋<code>:raising_hand:</code></td>      <td align="left">👰<code>:bride_with_veil:</code></td>    </tr>    <tr>      <td align="left">🙎<code>:person_with_pouting_face:</code></td>      <td align="left">🙍<code>:person_frowning:</code></td>      <td align="left">🙇<code>:bow:</code></td>    </tr>    <tr>      <td align="left">💏<code>:couplekiss:</code></td>      <td align="left">💑<code>:couple_with_heart:</code></td>      <td align="left">💆<code>:massage:</code></td>    </tr>    <tr>      <td align="left">💇<code>:haircut:</code></td>      <td align="left">💅<code>:nail_care:</code></td>      <td align="left">👦<code>:boy:</code></td>    </tr>    <tr>      <td align="left">👧<code>:girl:</code></td>      <td align="left">👩<code>:woman:</code></td>      <td align="left">👨<code>:man:</code></td>    </tr>    <tr>      <td align="left">👶<code>:baby:</code></td>      <td align="left">👵<code>:older_woman:</code></td>      <td align="left">👴<code>:older_man:</code></td>    </tr>    <tr>      <td align="left">👱<code>:person_with_blond_hair:</code></td>      <td align="left">👲<code>:man_with_gua_pi_mao:</code></td>      <td align="left">👳<code>:man_with_turban:</code></td>    </tr>    <tr>      <td align="left">👷<code>:construction_worker:</code></td>      <td align="left">👮<code>:cop:</code></td>      <td align="left">👼<code>:angel:</code></td>    </tr>    <tr>      <td align="left">👸<code>:princess:</code></td>      <td align="left">😺<code>:smiley_cat:</code></td>      <td align="left">😸<code>:smile_cat:</code></td>    </tr>    <tr>      <td align="left">😻<code>:heart_eyes_cat:</code></td>      <td align="left">😽<code>:kissing_cat:</code></td>      <td align="left">😼<code>:smirk_cat:</code></td>    </tr>    <tr>      <td align="left">🙀<code>:scream_cat:</code></td>      <td align="left">😿<code>:crying_cat_face:</code></td>      <td align="left">😹<code>:joy_cat:</code></td>    </tr>    <tr>      <td align="left">😾<code>:pouting_cat:</code></td>      <td align="left">👹<code>:japanese_ogre:</code></td>      <td align="left">👺<code>:japanese_goblin:</code></td>    </tr>    <tr>      <td align="left">🙈<code>:see_no_evil:</code></td>      <td align="left">🙉<code>:hear_no_evil:</code></td>      <td align="left">🙊<code>:speak_no_evil:</code></td>    </tr>    <tr>      <td align="left">💂<code>:guardsman:</code></td>      <td align="left">💀<code>:skull:</code></td>      <td align="left">🐾<code>:feet:</code></td>    </tr>    <tr>      <td align="left">👄<code>:lips:</code></td>      <td align="left">💋<code>:kiss:</code></td>      <td align="left">💧<code>:droplet:</code></td>    </tr>    <tr>      <td align="left">👂<code>:ear:</code></td>      <td align="left">👀<code>:eyes:</code></td>      <td align="left">👃<code>:nose:</code></td>    </tr>    <tr>      <td align="left">👅<code>:tongue:</code></td>      <td align="left">💌<code>:love_letter:</code></td>      <td align="left">👤<code>:bust_in_silhouette:</code></td>    </tr>    <tr>      <td align="left">👥<code>:busts_in_silhouette:</code></td>      <td align="left"></td>      <td align="left"></td>    </tr>  </tbody></table><p>Nature</p><table>  <thead>    <tr>      <th align="left">☀️<code>:sunny:</code></th>      <th align="left">☔️<code>:umbrella:</code></th>      <th align="left">☁️<code>:cloud:</code></th>    </tr>  </thead>  <tbody>    <tr>      <td align="left">❄️<code>:snowflake:</code></td>      <td align="left">⛄️<code>:snowman:</code></td>      <td align="left">⚡️<code>:zap:</code></td>    </tr>    <tr>      <td align="left">🌀<code>:cyclone:</code></td>      <td align="left">🌁<code>:foggy:</code></td>      <td align="left">🌊<code>:ocean:</code></td>    </tr>    <tr>      <td align="left">🐱<code>:cat:</code></td>      <td align="left">🐶<code>:dog:</code></td>      <td align="left">🐭<code>:mouse:</code></td>    </tr>    <tr>      <td align="left">🐹<code>:hamster:</code></td>      <td align="left">🐰<code>:rabbit:</code></td>      <td align="left">🐺<code>:wolf:</code></td>    </tr>    <tr>      <td align="left">🐸<code>:frog:</code></td>      <td align="left">🐯<code>:tiger:</code></td>      <td align="left">🐨<code>:koala:</code></td>    </tr>    <tr>      <td align="left">🐻<code>:bear:</code></td>      <td align="left">🐷<code>:pig:</code></td>      <td align="left">🐽<code>:pig_nose:</code></td>    </tr>    <tr>      <td align="left">🐮<code>:cow:</code></td>      <td align="left">🐗<code>:boar:</code></td>      <td align="left">🐵<code>:monkey_face:</code></td>    </tr>    <tr>      <td align="left">🐒<code>:monkey:</code></td>      <td align="left">🐴<code>:horse:</code></td>      <td align="left">🐎<code>:racehorse:</code></td>    </tr>    <tr>      <td align="left">🐫<code>:camel:</code></td>      <td align="left">🐑<code>:sheep:</code></td>      <td align="left">🐘<code>:elephant:</code></td>    </tr>    <tr>      <td align="left">🐼<code>:panda_face:</code></td>      <td align="left">🐍<code>:snake:</code></td>      <td align="left">🐦<code>:bird:</code></td>    </tr>    <tr>      <td align="left">🐤<code>:baby_chick:</code></td>      <td align="left">🐥<code>:hatched_chick:</code></td>      <td align="left">🐣<code>:hatching_chick:</code></td>    </tr>    <tr>      <td align="left">🐔<code>:chicken:</code></td>      <td align="left">🐧<code>:penguin:</code></td>      <td align="left">🐢<code>:turtle:</code></td>    </tr>    <tr>      <td align="left">🐛<code>:bug:</code></td>      <td align="left">🐝<code>:honeybee:</code></td>      <td align="left">🐜<code>:ant:</code></td>    </tr>    <tr>      <td align="left">🐞<code>:beetle:</code></td>      <td align="left">🐌<code>:snail:</code></td>      <td align="left">🐙<code>:octopus:</code></td>    </tr>    <tr>      <td align="left">🐠<code>:tropical_fish:</code></td>      <td align="left">🐟<code>:fish:</code></td>      <td align="left">🐳<code>:whale:</code></td>    </tr>    <tr>      <td align="left">🐋<code>:whale2:</code></td>      <td align="left">🐬<code>:dolphin:</code></td>      <td align="left">🐄<code>:cow2:</code></td>    </tr>    <tr>      <td align="left">🐏<code>:ram:</code></td>      <td align="left">🐀<code>:rat:</code></td>      <td align="left">🐃<code>:water_buffalo:</code></td>    </tr>    <tr>      <td align="left">🐅<code>:tiger2:</code></td>      <td align="left">🐇<code>:rabbit2:</code></td>      <td align="left">🐉<code>:dragon:</code></td>    </tr>    <tr>      <td align="left">🐐<code>:goat:</code></td>      <td align="left">🐓<code>:rooster:</code></td>      <td align="left">🐕<code>:dog2:</code></td>    </tr>    <tr>      <td align="left">🐖<code>:pig2:</code></td>      <td align="left">🐁<code>:mouse2:</code></td>      <td align="left">🐂<code>:ox:</code></td>    </tr>    <tr>      <td align="left">🐲<code>:dragon_face:</code></td>      <td align="left">🐡<code>:blowfish:</code></td>      <td align="left">🐊<code>:crocodile:</code></td>    </tr>    <tr>      <td align="left">🐪<code>:dromedary_camel:</code></td>      <td align="left">🐆<code>:leopard:</code></td>      <td align="left">🐈<code>:cat2:</code></td>    </tr>    <tr>      <td align="left">🐩<code>:poodle:</code></td>      <td align="left">🐾<code>:paw_prints:</code></td>      <td align="left">💐<code>:bouquet:</code></td>    </tr>    <tr>      <td align="left">🌸<code>:cherry_blossom:</code></td>      <td align="left">🌷<code>:tulip:</code></td>      <td align="left">🍀<code>:four_leaf_clover:</code></td>    </tr>    <tr>      <td align="left">🌹<code>:rose:</code></td>      <td align="left">🌻<code>:sunflower:</code></td>      <td align="left">🌺<code>:hibiscus:</code></td>    </tr>    <tr>      <td align="left">🍁<code>:maple_leaf:</code></td>      <td align="left">🍃<code>:leaves:</code></td>      <td align="left">🍂<code>:fallen_leaf:</code></td>    </tr>    <tr>      <td align="left">🌿<code>:herb:</code></td>      <td align="left">🍄<code>:mushroom:</code></td>      <td align="left">🌵<code>:cactus:</code></td>    </tr>    <tr>      <td align="left">🌴<code>:palm_tree:</code></td>      <td align="left">🌲<code>:evergreen_tree:</code></td>      <td align="left">🌳<code>:deciduous_tree:</code></td>    </tr>    <tr>      <td align="left">🌰<code>:chestnut:</code></td>      <td align="left">🌱<code>:seedling:</code></td>      <td align="left">🌼<code>:blossom:</code></td>    </tr>    <tr>      <td align="left">🌾<code>:ear_of_rice:</code></td>      <td align="left">🐚<code>:shell:</code></td>      <td align="left">🌐<code>:globe_with_meridians:</code></td>    </tr>    <tr>      <td align="left">🌞<code>:sun_with_face:</code></td>      <td align="left">🌝<code>:full_moon_with_face:</code></td>      <td align="left">🌚<code>:new_moon_with_face:</code></td>    </tr>    <tr>      <td align="left">🌑<code>:new_moon:</code></td>      <td align="left">🌒<code>:waxing_crescent_moon:</code></td>      <td align="left">🌓<code>:first_quarter_moon:</code></td>    </tr>    <tr>      <td align="left">🌔<code>:waxing_gibbous_moon:</code></td>      <td align="left">🌕<code>:full_moon:</code></td>      <td align="left">🌖<code>:waning_gibbous_moon:</code></td>    </tr>    <tr>      <td align="left">🌗<code>:last_quarter_moon:</code></td>      <td align="left">🌘<code>:waning_crescent_moon:</code></td>      <td align="left">🌜<code>:last_quarter_moon_with_face:</code></td>    </tr>    <tr>      <td align="left">🌛<code>:first_quarter_moon_with_face:</code></td>      <td align="left">🌔<code>:moon:</code></td>      <td align="left">🌍<code>:earth_africa:</code></td>    </tr>    <tr>      <td align="left">🌎<code>:earth_americas:</code></td>      <td align="left">🌏<code>:earth_asia:</code></td>      <td align="left">🌋<code>:volcano:</code></td>    </tr>    <tr>      <td align="left">🌌<code>:milky_way:</code></td>      <td align="left">⛅️<code>:partly_sunny:</code></td>      <td align="left"></td>    </tr>  </tbody></table><p>Objects</p><table>  <thead>    <tr>      <th align="left">🎍<code>:bamboo:</code></th>      <th align="left">💝<code>:gift_heart:</code></th>      <th align="left">🎎<code>:dolls:</code></th>    </tr>  </thead>  <tbody>    <tr>      <td align="left">🎒<code>:school_satchel:</code></td>      <td align="left">🎓<code>:mortar_board:</code></td>      <td align="left">🎏<code>:flags:</code></td>    </tr>    <tr>      <td align="left">🎆<code>:fireworks:</code></td>      <td align="left">🎇<code>:sparkler:</code></td>      <td align="left">🎐<code>:wind_chime:</code></td>    </tr>    <tr>      <td align="left">🎑<code>:rice_scene:</code></td>      <td align="left">🎃<code>:jack_o_lantern:</code></td>      <td align="left">👻<code>:ghost:</code></td>    </tr>    <tr>      <td align="left">🎅<code>:santa:</code></td>      <td align="left">🎄<code>:christmas_tree:</code></td>      <td align="left">🎁<code>:gift:</code></td>    </tr>    <tr>      <td align="left">🔔<code>:bell:</code></td>      <td align="left">🔕<code>:no_bell:</code></td>      <td align="left">🎋<code>:tanabata_tree:</code></td>    </tr>    <tr>      <td align="left">🎉<code>:tada:</code></td>      <td align="left">🎊<code>:confetti_ball:</code></td>      <td align="left">🎈<code>:balloon:</code></td>    </tr>    <tr>      <td align="left">🔮<code>:crystal_ball:</code></td>      <td align="left">💿<code>:cd:</code></td>      <td align="left">📀<code>:dvd:</code></td>    </tr>    <tr>      <td align="left">💾<code>:floppy_disk:</code></td>      <td align="left">📷<code>:camera:</code></td>      <td align="left">📹<code>:video_camera:</code></td>    </tr>    <tr>      <td align="left">🎥<code>:movie_camera:</code></td>      <td align="left">💻<code>:computer:</code></td>      <td align="left">📺<code>:tv:</code></td>    </tr>    <tr>      <td align="left">📱<code>:iphone:</code></td>      <td align="left">☎️<code>:phone:</code></td>      <td align="left">☎️<code>:telephone:</code></td>    </tr>    <tr>      <td align="left">📞<code>:telephone_receiver:</code></td>      <td align="left">📟<code>:pager:</code></td>      <td align="left">📠<code>:fax:</code></td>    </tr>    <tr>      <td align="left">💽<code>:minidisc:</code></td>      <td align="left">📼<code>:vhs:</code></td>      <td align="left">🔉<code>:sound:</code></td>    </tr>    <tr>      <td align="left">🔈<code>:speaker:</code></td>      <td align="left">🔇<code>:mute:</code></td>      <td align="left">📢<code>:loudspeaker:</code></td>    </tr>    <tr>      <td align="left">📣<code>:mega:</code></td>      <td align="left">⌛️<code>:hourglass:</code></td>      <td align="left">⏳<code>:hourglass_flowing_sand:</code></td>    </tr>    <tr>      <td align="left">⏰<code>:alarm_clock:</code></td>      <td align="left">⌚️<code>:watch:</code></td>      <td align="left">📻<code>:radio:</code></td>    </tr>    <tr>      <td align="left">📡<code>:satellite:</code></td>      <td align="left">➿<code>:loop:</code></td>      <td align="left">🔍<code>:mag:</code></td>    </tr>    <tr>      <td align="left">🔎<code>:mag_right:</code></td>      <td align="left">🔓<code>:unlock:</code></td>      <td align="left">🔒<code>:lock:</code></td>    </tr>    <tr>      <td align="left">🔏<code>:lock_with_ink_pen:</code></td>      <td align="left">🔐<code>:closed_lock_with_key:</code></td>      <td align="left">🔑<code>:key:</code></td>    </tr>    <tr>      <td align="left">💡<code>:bulb:</code></td>      <td align="left">🔦<code>:flashlight:</code></td>      <td align="left">🔆<code>:high_brightness:</code></td>    </tr>    <tr>      <td align="left">🔅<code>:low_brightness:</code></td>      <td align="left">🔌<code>:electric_plug:</code></td>      <td align="left">🔋<code>:battery:</code></td>    </tr>    <tr>      <td align="left">📲<code>:calling:</code></td>      <td align="left">✉️<code>:email:</code></td>      <td align="left">📫<code>:mailbox:</code></td>    </tr>    <tr>      <td align="left">📮<code>:postbox:</code></td>      <td align="left">🛀<code>:bath:</code></td>      <td align="left">🛁<code>:bathtub:</code></td>    </tr>    <tr>      <td align="left">🚿<code>:shower:</code></td>      <td align="left">🚽<code>:toilet:</code></td>      <td align="left">🔧<code>:wrench:</code></td>    </tr>    <tr>      <td align="left">🔩<code>:nut_and_bolt:</code></td>      <td align="left">🔨<code>:hammer:</code></td>      <td align="left">💺<code>:seat:</code></td>    </tr>    <tr>      <td align="left">💰<code>:moneybag:</code></td>      <td align="left">💴<code>:yen:</code></td>      <td align="left">💵<code>:dollar:</code></td>    </tr>    <tr>      <td align="left">💷<code>:pound:</code></td>      <td align="left">💶<code>:euro:</code></td>      <td align="left">💳<code>:credit_card:</code></td>    </tr>    <tr>      <td align="left">💸<code>:money_with_wings:</code></td>      <td align="left">📧<code>:e-mail:</code></td>      <td align="left">📥<code>:inbox_tray:</code></td>    </tr>    <tr>      <td align="left">📤<code>:outbox_tray:</code></td>      <td align="left">✉️<code>:envelope:</code></td>      <td align="left">📨<code>:incoming_envelope:</code></td>    </tr>    <tr>      <td align="left">📯<code>:postal_horn:</code></td>      <td align="left">📪<code>:mailbox_closed:</code></td>      <td align="left">📬<code>:mailbox_with_mail:</code></td>    </tr>    <tr>      <td align="left">📭<code>:mailbox_with_no_mail:</code></td>      <td align="left">🚪<code>:door:</code></td>      <td align="left">🚬<code>:smoking:</code></td>    </tr>    <tr>      <td align="left">💣<code>:bomb:</code></td>      <td align="left">🔫<code>:gun:</code></td>      <td align="left">🔪<code>:hocho:</code></td>    </tr>    <tr>      <td align="left">💊<code>:pill:</code></td>      <td align="left">💉<code>:syringe:</code></td>      <td align="left">📄<code>:page_facing_up:</code></td>    </tr>    <tr>      <td align="left">📃<code>:page_with_curl:</code></td>      <td align="left">📑<code>:bookmark_tabs:</code></td>      <td align="left">📊<code>:bar_chart:</code></td>    </tr>    <tr>      <td align="left">📈<code>:chart_with_upwards_trend:</code></td>      <td align="left">📉<code>:chart_with_downwards_trend:</code></td>      <td align="left">📜<code>:scroll:</code></td>    </tr>    <tr>      <td align="left">📋<code>:clipboard:</code></td>      <td align="left">📆<code>:calendar:</code></td>      <td align="left">📅<code>:date:</code></td>    </tr>    <tr>      <td align="left">📇<code>:card_index:</code></td>      <td align="left">📁<code>:file_folder:</code></td>      <td align="left">📂<code>:open_file_folder:</code></td>    </tr>    <tr>      <td align="left">✂️<code>:scissors:</code></td>      <td align="left">📌<code>:pushpin:</code></td>      <td align="left">📎<code>:paperclip:</code></td>    </tr>    <tr>      <td align="left">✒️<code>:black_nib:</code></td>      <td align="left">✏️<code>:pencil2:</code></td>      <td align="left">📏<code>:straight_ruler:</code></td>    </tr>    <tr>      <td align="left">📐<code>:triangular_ruler:</code></td>      <td align="left">📕<code>:closed_book:</code></td>      <td align="left">📗<code>:green_book:</code></td>    </tr>    <tr>      <td align="left">📘<code>:blue_book:</code></td>      <td align="left">📙<code>:orange_book:</code></td>      <td align="left">📓<code>:notebook:</code></td>    </tr>    <tr>      <td align="left">📔<code>:notebook_with_decorative_cover:</code></td>      <td align="left">📒<code>:ledger:</code></td>      <td align="left">📚<code>:books:</code></td>    </tr>    <tr>      <td align="left">🔖<code>:bookmark:</code></td>      <td align="left">📛<code>:name_badge:</code></td>      <td align="left">🔬<code>:microscope:</code></td>    </tr>    <tr>      <td align="left">🔭<code>:telescope:</code></td>      <td align="left">📰<code>:newspaper:</code></td>      <td align="left">🏈<code>:football:</code></td>    </tr>    <tr>      <td align="left">🏀<code>:basketball:</code></td>      <td align="left">⚽️<code>:soccer:</code></td>      <td align="left">⚾️<code>:baseball:</code></td>    </tr>    <tr>      <td align="left">🎾<code>:tennis:</code></td>      <td align="left">🎱<code>:8ball:</code></td>      <td align="left">🏉<code>:rugby_football:</code></td>    </tr>    <tr>      <td align="left">🎳<code>:bowling:</code></td>      <td align="left">⛳️<code>:golf:</code></td>      <td align="left">🚵<code>:mountain_bicyclist:</code></td>    </tr>    <tr>      <td align="left">🚴<code>:bicyclist:</code></td>      <td align="left">🏇<code>:horse_racing:</code></td>      <td align="left">🏂<code>:snowboarder:</code></td>    </tr>    <tr>      <td align="left">🏊<code>:swimmer:</code></td>      <td align="left">🏄<code>:surfer:</code></td>      <td align="left">🎿<code>:ski:</code></td>    </tr>    <tr>      <td align="left">♠️<code>:spades:</code></td>      <td align="left">♥️<code>:hearts:</code></td>      <td align="left">♣️<code>:clubs:</code></td>    </tr>    <tr>      <td align="left">♦️<code>:diamonds:</code></td>      <td align="left">💎<code>:gem:</code></td>      <td align="left">💍<code>:ring:</code></td>    </tr>    <tr>      <td align="left">🏆<code>:trophy:</code></td>      <td align="left">🎼<code>:musical_score:</code></td>      <td align="left">🎹<code>:musical_keyboard:</code></td>    </tr>    <tr>      <td align="left">🎻<code>:violin:</code></td>      <td align="left">👾<code>:space_invader:</code></td>      <td align="left">🎮<code>:video_game:</code></td>    </tr>    <tr>      <td align="left">🃏<code>:black_joker:</code></td>      <td align="left">🎴<code>:flower_playing_cards:</code></td>      <td align="left">🎲<code>:game_die:</code></td>    </tr>    <tr>      <td align="left">🎯<code>:dart:</code></td>      <td align="left">🀄️<code>:mahjong:</code></td>      <td align="left">🎬<code>:clapper:</code></td>    </tr>    <tr>      <td align="left">📝<code>:memo:</code></td>      <td align="left">📝<code>:pencil:</code></td>      <td align="left">📖<code>:book:</code></td>    </tr>    <tr>      <td align="left">🎨<code>:art:</code></td>      <td align="left">🎤<code>:microphone:</code></td>      <td align="left">🎧<code>:headphones:</code></td>    </tr>    <tr>      <td align="left">🎺<code>:trumpet:</code></td>      <td align="left">🎷<code>:saxophone:</code></td>      <td align="left">🎸<code>:guitar:</code></td>    </tr>    <tr>      <td align="left">👞<code>:shoe:</code></td>      <td align="left">👡<code>:sandal:</code></td>      <td align="left">👠<code>:high_heel:</code></td>    </tr>    <tr>      <td align="left">💄<code>:lipstick:</code></td>      <td align="left">👢<code>:boot:</code></td>      <td align="left">👕<code>:shirt:</code></td>    </tr>    <tr>      <td align="left">👕<code>:tshirt:</code></td>      <td align="left">👔<code>:necktie:</code></td>      <td align="left">👚<code>:womans_clothes:</code></td>    </tr>    <tr>      <td align="left">👗<code>:dress:</code></td>      <td align="left">🎽<code>:running_shirt_with_sash:</code></td>      <td align="left">👖<code>:jeans:</code></td>    </tr>    <tr>      <td align="left">👘<code>:kimono:</code></td>      <td align="left">👙<code>:bikini:</code></td>      <td align="left">🎀<code>:ribbon:</code></td>    </tr>    <tr>      <td align="left">🎩<code>:tophat:</code></td>      <td align="left">👑<code>:crown:</code></td>      <td align="left">👒<code>:womans_hat:</code></td>    </tr>    <tr>      <td align="left">👞<code>:mans_shoe:</code></td>      <td align="left">🌂<code>:closed_umbrella:</code></td>      <td align="left">💼<code>:briefcase:</code></td>    </tr>    <tr>      <td align="left">👜<code>:handbag:</code></td>      <td align="left">👝<code>:pouch:</code></td>      <td align="left">👛<code>:purse:</code></td>    </tr>    <tr>      <td align="left">👓<code>:eyeglasses:</code></td>      <td align="left">🎣<code>:fishing_pole_and_fish:</code></td>      <td align="left">☕️<code>:coffee:</code></td>    </tr>    <tr>      <td align="left">🍵<code>:tea:</code></td>      <td align="left">🍶<code>:sake:</code></td>      <td align="left">🍼<code>:baby_bottle:</code></td>    </tr>    <tr>      <td align="left">🍺<code>:beer:</code></td>      <td align="left">🍻<code>:beers:</code></td>      <td align="left">🍸<code>:cocktail:</code></td>    </tr>    <tr>      <td align="left">🍹<code>:tropical_drink:</code></td>      <td align="left">🍷<code>:wine_glass:</code></td>      <td align="left">🍴<code>:fork_and_knife:</code></td>    </tr>    <tr>      <td align="left">🍕<code>:pizza:</code></td>      <td align="left">🍔<code>:hamburger:</code></td>      <td align="left">🍟<code>:fries:</code></td>    </tr>    <tr>      <td align="left">🍗<code>:poultry_leg:</code></td>      <td align="left">🍖<code>:meat_on_bone:</code></td>      <td align="left">🍝<code>:spaghetti:</code></td>    </tr>    <tr>      <td align="left">🍛<code>:curry:</code></td>      <td align="left">🍤<code>:fried_shrimp:</code></td>      <td align="left">🍱<code>:bento:</code></td>    </tr>    <tr>      <td align="left">🍣<code>:sushi:</code></td>      <td align="left">🍥<code>:fish_cake:</code></td>      <td align="left">🍙<code>:rice_ball:</code></td>    </tr>    <tr>      <td align="left">🍘<code>:rice_cracker:</code></td>      <td align="left">🍚<code>:rice:</code></td>      <td align="left">🍜<code>:ramen:</code></td>    </tr>    <tr>      <td align="left">🍲<code>:stew:</code></td>      <td align="left">🍢<code>:oden:</code></td>      <td align="left">🍡<code>:dango:</code></td>    </tr>    <tr>      <td align="left">🥚<code>:egg:</code></td>      <td align="left">🍞<code>:bread:</code></td>      <td align="left">🍩<code>:doughnut:</code></td>    </tr>    <tr>      <td align="left">🍮<code>:custard:</code></td>      <td align="left">🍦<code>:icecream:</code></td>      <td align="left">🍨<code>:ice_cream:</code></td>    </tr>    <tr>      <td align="left">🍧<code>:shaved_ice:</code></td>      <td align="left">🎂<code>:birthday:</code></td>      <td align="left">🍰<code>:cake:</code></td>    </tr>    <tr>      <td align="left">🍪<code>:cookie:</code></td>      <td align="left">🍫<code>:chocolate_bar:</code></td>      <td align="left">🍬<code>:candy:</code></td>    </tr>    <tr>      <td align="left">🍭<code>:lollipop:</code></td>      <td align="left">🍯<code>:honey_pot:</code></td>      <td align="left">🍎<code>:apple:</code></td>    </tr>    <tr>      <td align="left">🍏<code>:green_apple:</code></td>      <td align="left">🍊<code>:tangerine:</code></td>      <td align="left">🍋<code>:lemon:</code></td>    </tr>    <tr>      <td align="left">🍒<code>:cherries:</code></td>      <td align="left">🍇<code>:grapes:</code></td>      <td align="left">🍉<code>:watermelon:</code></td>    </tr>    <tr>      <td align="left">🍓<code>:strawberry:</code></td>      <td align="left">🍑<code>:peach:</code></td>      <td align="left">🍈<code>:melon:</code></td>    </tr>    <tr>      <td align="left">🍌<code>:banana:</code></td>      <td align="left">🍐<code>:pear:</code></td>      <td align="left">🍍<code>:pineapple:</code></td>    </tr>    <tr>      <td align="left">🍠<code>:sweet_potato:</code></td>      <td align="left">🍆<code>:eggplant:</code></td>      <td align="left">🍅<code>:tomato:</code></td>    </tr>    <tr>      <td align="left">🌽<code>:corn:</code></td>      <td align="left"></td>      <td align="left"></td>    </tr>  </tbody></table><p>Places</p><table>  <thead>    <tr>      <th align="left">🏠<code>:house:</code></th>      <th align="left">🏡<code>:house_with_garden:</code></th>      <th align="left">🏫<code>:school:</code></th>    </tr>  </thead>  <tbody>    <tr>      <td align="left">🏢<code>:office:</code></td>      <td align="left">🏣<code>:post_office:</code></td>      <td align="left">🏥<code>:hospital:</code></td>    </tr>    <tr>      <td align="left">🏦<code>:bank:</code></td>      <td align="left">🏪<code>:convenience_store:</code></td>      <td align="left">🏩<code>:love_hotel:</code></td>    </tr>    <tr>      <td align="left">🏨<code>:hotel:</code></td>      <td align="left">💒<code>:wedding:</code></td>      <td align="left">⛪️<code>:church:</code></td>    </tr>    <tr>      <td align="left">🏬<code>:department_store:</code></td>      <td align="left">🏤<code>:european_post_office:</code></td>      <td align="left">🌇<code>:city_sunrise:</code></td>    </tr>    <tr>      <td align="left">🌆<code>:city_sunset:</code></td>      <td align="left">🏯<code>:japanese_castle:</code></td>      <td align="left">🏰<code>:european_castle:</code></td>    </tr>    <tr>      <td align="left">⛺️<code>:tent:</code></td>      <td align="left">🏭<code>:factory:</code></td>      <td align="left">🗼<code>:tokyo_tower:</code></td>    </tr>    <tr>      <td align="left">🗾<code>:japan:</code></td>      <td align="left">🗻<code>:mount_fuji:</code></td>      <td align="left">🌄<code>:sunrise_over_mountains:</code></td>    </tr>    <tr>      <td align="left">🌅<code>:sunrise:</code></td>      <td align="left">🌠<code>:stars:</code></td>      <td align="left">🗽<code>:statue_of_liberty:</code></td>    </tr>    <tr>      <td align="left">🌉<code>:bridge_at_night:</code></td>      <td align="left">🎠<code>:carousel_horse:</code></td>      <td align="left">🌈<code>:rainbow:</code></td>    </tr>    <tr>      <td align="left">🎡<code>:ferris_wheel:</code></td>      <td align="left">⛲️<code>:fountain:</code></td>      <td align="left">🎢<code>:roller_coaster:</code></td>    </tr>    <tr>      <td align="left">🚢<code>:ship:</code></td>      <td align="left">🚤<code>:speedboat:</code></td>      <td align="left">⛵️<code>:boat:</code></td>    </tr>    <tr>      <td align="left">⛵️<code>:sailboat:</code></td>      <td align="left">🚣<code>:rowboat:</code></td>      <td align="left">⚓️<code>:anchor:</code></td>    </tr>    <tr>      <td align="left">🚀<code>:rocket:</code></td>      <td align="left">✈️<code>:airplane:</code></td>      <td align="left">🚁<code>:helicopter:</code></td>    </tr>    <tr>      <td align="left">🚂<code>:steam_locomotive:</code></td>      <td align="left">🚊<code>:tram:</code></td>      <td align="left">🚞<code>:mountain_railway:</code></td>    </tr>    <tr>      <td align="left">🚲<code>:bike:</code></td>      <td align="left">🚡<code>:aerial_tramway:</code></td>      <td align="left">🚟<code>:suspension_railway:</code></td>    </tr>    <tr>      <td align="left">🚠<code>:mountain_cableway:</code></td>      <td align="left">🚜<code>:tractor:</code></td>      <td align="left">🚙<code>:blue_car:</code></td>    </tr>    <tr>      <td align="left">🚘<code>:oncoming_automobile:</code></td>      <td align="left">🚗<code>:car:</code></td>      <td align="left">🚗<code>:red_car:</code></td>    </tr>    <tr>      <td align="left">🚕<code>:taxi:</code></td>      <td align="left">🚖<code>:oncoming_taxi:</code></td>      <td align="left">🚛<code>:articulated_lorry:</code></td>    </tr>    <tr>      <td align="left">🚌<code>:bus:</code></td>      <td align="left">🚍<code>:oncoming_bus:</code></td>      <td align="left">🚨<code>:rotating_light:</code></td>    </tr>    <tr>      <td align="left">🚓<code>:police_car:</code></td>      <td align="left">🚔<code>:oncoming_police_car:</code></td>      <td align="left">🚒<code>:fire_engine:</code></td>    </tr>    <tr>      <td align="left">🚑<code>:ambulance:</code></td>      <td align="left">🚐<code>:minibus:</code></td>      <td align="left">🚚<code>:truck:</code></td>    </tr>    <tr>      <td align="left">🚋<code>:train:</code></td>      <td align="left">🚉<code>:station:</code></td>      <td align="left">🚆<code>:train2:</code></td>    </tr>    <tr>      <td align="left">🚅<code>:bullettrain_front:</code></td>      <td align="left">🚄<code>:bullettrain_side:</code></td>      <td align="left">🚈<code>:light_rail:</code></td>    </tr>    <tr>      <td align="left">🚝<code>:monorail:</code></td>      <td align="left">🚃<code>:railway_car:</code></td>      <td align="left">🚎<code>:trolleybus:</code></td>    </tr>    <tr>      <td align="left">🎫<code>:ticket:</code></td>      <td align="left">⛽️<code>:fuelpump:</code></td>      <td align="left">🚦<code>:vertical_traffic_light:</code></td>    </tr>    <tr>      <td align="left">🚥<code>:traffic_light:</code></td>      <td align="left">⚠️<code>:warning:</code></td>      <td align="left">🚧<code>:construction:</code></td>    </tr>    <tr>      <td align="left">🔰<code>:beginner:</code></td>      <td align="left">🏧<code>:atm:</code></td>      <td align="left">🎰<code>:slot_machine:</code></td>    </tr>    <tr>      <td align="left">🚏<code>:busstop:</code></td>      <td align="left">💈<code>:barber:</code></td>      <td align="left">♨️<code>:hotsprings:</code></td>    </tr>    <tr>      <td align="left">🏁<code>:checkered_flag:</code></td>      <td align="left">🎌<code>:crossed_flags:</code></td>      <td align="left">🏮<code>:izakaya_lantern:</code></td>    </tr>    <tr>      <td align="left">🗿<code>:moyai:</code></td>      <td align="left">🎪<code>:circus_tent:</code></td>      <td align="left">🎭<code>:performing_arts:</code></td>    </tr>    <tr>      <td align="left">📍<code>:round_pushpin:</code></td>      <td align="left">🚩<code>:triangular_flag_on_post:</code></td>      <td align="left"></td>    </tr>  </tbody></table><p>Symbols</p><table>  <thead>    <tr>      <th align="left">1️⃣<code>:one:</code></th>      <th align="left">2️⃣<code>:two:</code></th>      <th align="left">3️⃣<code>:three:</code></th>    </tr>  </thead>  <tbody>    <tr>      <td align="left">4️⃣<code>:four:</code></td>      <td align="left">5️⃣<code>:five:</code></td>      <td align="left">6️⃣<code>:six:</code></td>    </tr>    <tr>      <td align="left">7️⃣<code>:seven:</code></td>      <td align="left">8️⃣<code>:eight:</code></td>      <td align="left">9️⃣<code>:nine:</code></td>    </tr>    <tr>      <td align="left">🔟<code>:keycap_ten:</code></td>      <td align="left">🔢<code>:1234:</code></td>      <td align="left">0️⃣<code>:zero:</code></td>    </tr>    <tr>      <td align="left">#️⃣<code>:hash:</code></td>      <td align="left">🔣<code>:symbols:</code></td>      <td align="left">◀️<code>:arrow_backward:</code></td>    </tr>    <tr>      <td align="left">⬇️<code>:arrow_down:</code></td>      <td align="left">▶️<code>:arrow_forward:</code></td>      <td align="left">⬅️<code>:arrow_left:</code></td>    </tr>    <tr>      <td align="left">🔠<code>:capital_abcd:</code></td>      <td align="left">🔡<code>:abcd:</code></td>      <td align="left">🔤<code>:abc:</code></td>    </tr>    <tr>      <td align="left">↙️<code>:arrow_lower_left:</code></td>      <td align="left">↘️<code>:arrow_lower_right:</code></td>      <td align="left">➡️<code>:arrow_right:</code></td>    </tr>    <tr>      <td align="left">⬆️<code>:arrow_up:</code></td>      <td align="left">↖️<code>:arrow_upper_left:</code></td>      <td align="left">↗️<code>:arrow_upper_right:</code></td>    </tr>    <tr>      <td align="left">⏬<code>:arrow_double_down:</code></td>      <td align="left">⏫<code>:arrow_double_up:</code></td>      <td align="left">🔽<code>:arrow_down_small:</code></td>    </tr>    <tr>      <td align="left">⤵️<code>:arrow_heading_down:</code></td>      <td align="left">⤴️<code>:arrow_heading_up:</code></td>      <td align="left">↩️<code>:leftwards_arrow_with_hook:</code></td>    </tr>    <tr>      <td align="left">↪️<code>:arrow_right_hook:</code></td>      <td align="left">↔️<code>:left_right_arrow:</code></td>      <td align="left">↕️<code>:arrow_up_down:</code></td>    </tr>    <tr>      <td align="left">🔼<code>:arrow_up_small:</code></td>      <td align="left">🔃<code>:arrows_clockwise:</code></td>      <td align="left">🔄<code>:arrows_counterclockwise:</code></td>    </tr>    <tr>      <td align="left">⏪<code>:rewind:</code></td>      <td align="left">⏩<code>:fast_forward:</code></td>      <td align="left">ℹ️<code>:information_source:</code></td>    </tr>    <tr>      <td align="left">🆗<code>:ok:</code></td>      <td align="left">🔀<code>:twisted_rightwards_arrows:</code></td>      <td align="left">🔁<code>:repeat:</code></td>    </tr>    <tr>      <td align="left">🔂<code>:repeat_one:</code></td>      <td align="left">🆕<code>:new:</code></td>      <td align="left">🔝<code>:top:</code></td>    </tr>    <tr>      <td align="left">🆙<code>:up:</code></td>      <td align="left">🆒<code>:cool:</code></td>      <td align="left">🆓<code>:free:</code></td>    </tr>    <tr>      <td align="left">🆖<code>:ng:</code></td>      <td align="left">🎦<code>:cinema:</code></td>      <td align="left">🈁<code>:koko:</code></td>    </tr>    <tr>      <td align="left">📶<code>:signal_strength:</code></td>      <td align="left"></td>      <td align="left"></td>    </tr>    <tr>      <td align="left">🈂️<code>:sa:</code></td>      <td align="left">🚻<code>:restroom:</code></td>      <td align="left">🚹<code>:mens:</code></td>    </tr>    <tr>      <td align="left">🚺<code>:womens:</code></td>      <td align="left">🚼<code>:baby_symbol:</code></td>      <td align="left">🚭<code>:no_smoking:</code></td>    </tr>    <tr>      <td align="left">🅿️<code>:parking:</code></td>      <td align="left">♿️<code>:wheelchair:</code></td>      <td align="left">🚇<code>:metro:</code></td>    </tr>    <tr>      <td align="left">🛄<code>:baggage_claim:</code></td>      <td align="left">🉑<code>:accept:</code></td>      <td align="left">🚾<code>:wc:</code></td>    </tr>    <tr>      <td align="left">🚰<code>:potable_water:</code></td>      <td align="left">🚮<code>:put_litter_in_its_place:</code></td>      <td align="left">㊙️<code>:secret:</code></td>    </tr>    <tr>      <td align="left">㊗️<code>:congratulations:</code></td>      <td align="left">Ⓜ️<code>:m:</code></td>      <td align="left">🛂<code>:passport_control:</code></td>    </tr>    <tr>      <td align="left">🛅<code>:left_luggage:</code></td>      <td align="left">🛃<code>:customs:</code></td>      <td align="left">🉐<code>:ideograph_advantage:</code></td>    </tr>    <tr>      <td align="left">🆑<code>:cl:</code></td>      <td align="left">🆘<code>:sos:</code></td>      <td align="left">🆔<code>:id:</code></td>    </tr>    <tr>      <td align="left">🚫<code>:no_entry_sign:</code></td>      <td align="left">🔞<code>:underage:</code></td>      <td align="left">📵<code>:no_mobile_phones:</code></td>    </tr>    <tr>      <td align="left">🚯<code>:do_not_litter:</code></td>      <td align="left">🚱<code>:non-potable_water:</code></td>      <td align="left">🚳<code>:no_bicycles:</code></td>    </tr>    <tr>      <td align="left">🚷<code>:no_pedestrians:</code></td>      <td align="left">🚸<code>:children_crossing:</code></td>      <td align="left">⛔️<code>:no_entry:</code></td>    </tr>    <tr>      <td align="left">✳️<code>:eight_spoked_asterisk:</code></td>      <td align="left">✴️<code>:eight_pointed_black_star:</code></td>      <td align="left">💟<code>:heart_decoration:</code></td>    </tr>    <tr>      <td align="left">🆚<code>:vs:</code></td>      <td align="left">📳<code>:vibration_mode:</code></td>      <td align="left">📴<code>:mobile_phone_off:</code></td>    </tr>    <tr>      <td align="left">💹<code>:chart:</code></td>      <td align="left">💱<code>:currency_exchange:</code></td>      <td align="left">♈️<code>:aries:</code></td>    </tr>    <tr>      <td align="left">♉️<code>:taurus:</code></td>      <td align="left">♊️<code>:gemini:</code></td>      <td align="left">♋️<code>:cancer:</code></td>    </tr>    <tr>      <td align="left">♌️<code>:leo:</code></td>      <td align="left">♍️<code>:virgo:</code></td>      <td align="left">♎️<code>:libra:</code></td>    </tr>    <tr>      <td align="left">♏️<code>:scorpius:</code></td>      <td align="left">♐️<code>:sagittarius:</code></td>      <td align="left">♑️<code>:capricorn:</code></td>    </tr>    <tr>      <td align="left">♒️<code>:aquarius:</code></td>      <td align="left">♓️<code>:pisces:</code></td>      <td align="left">⛎<code>:ophiuchus:</code></td>    </tr>    <tr>      <td align="left">🔯<code>:six_pointed_star:</code></td>      <td align="left">❎<code>:negative_squared_cross_mark:</code></td>      <td align="left">🅰️<code>:a:</code></td>    </tr>    <tr>      <td align="left">🅱️<code>:b:</code></td>      <td align="left">🆎<code>:ab:</code></td>      <td align="left">🅾️<code>:o2:</code></td>    </tr>    <tr>      <td align="left">💠<code>:diamond_shape_with_a_dot_inside:</code></td>      <td align="left">♻️<code>:recycle:</code></td>      <td align="left">🔚<code>:end:</code></td>    </tr>    <tr>      <td align="left">🔛<code>:on:</code></td>      <td align="left">🔜<code>:soon:</code></td>      <td align="left">🕐<code>:clock1:</code></td>    </tr>    <tr>      <td align="left">🕜<code>:clock130:</code></td>      <td align="left">🕙<code>:clock10:</code></td>      <td align="left">🕥<code>:clock1030:</code></td>    </tr>    <tr>      <td align="left">🕚<code>:clock11:</code></td>      <td align="left">🕦<code>:clock1130:</code></td>      <td align="left">🕛<code>:clock12:</code></td>    </tr>    <tr>      <td align="left">🕧<code>:clock1230:</code></td>      <td align="left">🕑<code>:clock2:</code></td>      <td align="left">🕝<code>:clock230:</code></td>    </tr>    <tr>      <td align="left">🕒<code>:clock3:</code></td>      <td align="left">🕞<code>:clock330:</code></td>      <td align="left">🕓<code>:clock4:</code></td>    </tr>    <tr>      <td align="left">🕟<code>:clock430:</code></td>      <td align="left">🕔<code>:clock5:</code></td>      <td align="left">🕠<code>:clock530:</code></td>    </tr>    <tr>      <td align="left">🕕<code>:clock6:</code></td>      <td align="left">🕡<code>:clock630:</code></td>      <td align="left">🕖<code>:clock7:</code></td>    </tr>    <tr>      <td align="left">🕢<code>:clock730:</code></td>      <td align="left">🕗<code>:clock8:</code></td>      <td align="left">🕣<code>:clock830:</code></td>    </tr>    <tr>      <td align="left">🕘<code>:clock9:</code></td>      <td align="left">🕤<code>:clock930:</code></td>      <td align="left">💲<code>:heavy_dollar_sign:</code></td>    </tr>    <tr>      <td align="left">©️<code>:copyright:</code></td>      <td align="left">®️<code>:registered:</code></td>      <td align="left">™️<code>:tm:</code></td>    </tr>    <tr>      <td align="left">❌<code>:x:</code></td>      <td align="left">❗️<code>:heavy_exclamation_mark:</code></td>      <td align="left">‼️<code>:bangbang:</code></td>    </tr>    <tr>      <td align="left">⁉️<code>:interrobang:</code></td>      <td align="left">⭕️<code>:o:</code></td>      <td align="left">✖️<code>:heavy_multiplication_x:</code></td>    </tr>    <tr>      <td align="left">➕<code>:heavy_plus_sign:</code></td>      <td align="left">➖<code>:heavy_minus_sign:</code></td>      <td align="left">➗<code>:heavy_division_sign:</code></td>    </tr>    <tr>      <td align="left">💮<code>:white_flower:</code></td>      <td align="left">💯<code>:100:</code></td>      <td align="left">✔️<code>:heavy_check_mark:</code></td>    </tr>    <tr>      <td align="left">☑️<code>:ballot_box_with_check:</code></td>      <td align="left">🔘<code>:radio_button:</code></td>      <td align="left">🔗<code>:link:</code></td>    </tr>    <tr>      <td align="left">➰<code>:curly_loop:</code></td>      <td align="left">〰️<code>:wavy_dash:</code></td>      <td align="left">〽️<code>:part_alternation_mark:</code></td>    </tr>    <tr>      <td align="left">🔱<code>:trident:</code></td>      <td align="left">🔻<code>:small_red_triangle_down:</code></td>      <td align="left">🔺<code>:small_red_triangle:</code></td>    </tr>    <tr>      <td align="left">✅<code>:white_check_mark:</code></td>      <td align="left">🔲<code>:black_square_button:</code></td>      <td align="left">🔳<code>:white_square_button:</code></td>    </tr>    <tr>      <td align="left">⚫️<code>:black_circle:</code></td>      <td align="left">⚪️<code>:white_circle:</code></td>      <td align="left">🔴<code>:red_circle:</code></td>    </tr>    <tr>      <td align="left">🔵<code>:large_blue_circle:</code></td>      <td align="left">🔷<code>:large_blue_diamond:</code></td>      <td align="left">🔶<code>:large_orange_diamond:</code></td>    </tr>    <tr>      <td align="left">🔹<code>:small_blue_diamond:</code></td>      <td align="left">🔸<code>:small_orange_diamond:</code></td>      <td align="left"></td>    </tr>  </tbody></table>              </div>            </details>]]></content>
    
    
    <summary type="html">Hexo 默认搭配的 Markdown 渲染器是 hexo-renderer-marked，但其支持的渲染格式有限，不利于自由写作。因此，今天教大家如何更换为功能更加强大，渲染速度更快的 hexo-renderer-markdown-it 渲染器。</summary>
    
    
    
    <category term="Hexo" scheme="https://blog.halfsummer.xyz/categories/Hexo/"/>
    
    
    <category term="emoji" scheme="https://blog.halfsummer.xyz/tags/emoji/"/>
    
  </entry>
  
  <entry>
    <title>WMware 虚拟机安装 Linux</title>
    <link href="https://blog.halfsummer.xyz/posts/1763fb9d.html"/>
    <id>https://blog.halfsummer.xyz/posts/1763fb9d.html</id>
    <published>2023-02-13T17:55:37.000Z</published>
    <updated>2023-03-11T12:51:07.430Z</updated>
    
    <content type="html"><![CDATA[<meta name="referrer" content="no-referrer" /><h1 id="1）下载">1）下载</h1><div class="btns rounded grid5">            <a class="button" href='https://www.centos.org/download/' title='CentOS'><i class='fas fa-download'></i>CentOS</a><a class="button" href='https://ubuntu.com/download/server' title='Ubuntu'><i class='fas fa-download'></i>Ubuntu</a>          </div><hr><h1 id="2）VMware-中安装-Linux">2）VMware 中安装 Linux</h1><details class="folding-tag" cyan><summary> 1）配置 </summary>              <div class='content'>              <div class="tabs" id="vmware-setting"><ul class="nav-tabs"><li class="tab"><button type="button" data-href="#vmware-setting-1">VMware 17</button></li><li class="tab"><button type="button" data-href="#vmware-setting-2">VMware 15.5</button></li><li class="tab"><button type="button" data-href="#vmware-setting-3">VMware 14</button></li></ul><div class="tab-contents"><div class="tab-item-content" id="vmware-setting-1"><ol><li><p>打开“VMware Workstation 17 PRO“软件，选择”创建新的虚拟机“。</p><p><img src="https://gitee.com/aceniu/images/raw/master/article_images/typora_images/image-20230213195818166.png" alt="image-20230213195818166"></p></li><li><p>选择“典型”选项，然后下一步。</p><p><img src="https://gitee.com/aceniu/images/raw/master/article_images/typora_images/image-20230213200017639.png" alt="image-20230213200017639"></p></li><li><p>选择“稍后安装操作系统”，点击下一步。</p><p><img src="https://gitee.com/aceniu/images/raw/master/article_images/typora_images/image-20230213200226774.png" alt="image-20230213200226774"></p></li><li><p>客户机操作选择“Linux”,版本选择“CentOS 7 64位”，点击下一步。</p><p><img src="https://gitee.com/aceniu/images/raw/master/article_images/typora_images/image-20230213200258945.png" alt="image-20230213200258945"></p></li><li><p>输入“虚拟机名称”，选择虚拟机文件保存的位置，点击下一步。</p><p><img src="https://gitee.com/aceniu/images/raw/master/article_images/typora_images/image-20230213200712138.png" alt="image-20230213200712138"></p></li><li><p>最大磁盘默认20G大小即可，然后选择“将虚拟机磁盘存储为单个文件”，下一步。</p><p><img src="https://gitee.com/aceniu/images/raw/master/article_images/typora_images/image-20230213200907483.png" alt="image-20230213200907483"></p></li><li><p>点击”自定义硬件配置“。</p><p><img src="https://gitee.com/aceniu/images/raw/master/article_images/typora_images/image-20230213200940144.png" alt="image-20230213200940144"></p></li><li><p>选中”新 CD/DVD“，选择”使用 ISO 映像文件“，然后设置 CentOS7 的 ISO 映像路径，点击关闭。网络适配器默认 NAT。</p><p><img src="https://gitee.com/aceniu/images/raw/master/article_images/typora_images/image-20230213201247111.png" alt="image-20230213201247111"></p></li><li><p>点击完成，如下。</p><p><img src="https://gitee.com/aceniu/images/raw/master/article_images/typora_images/image-20230213201323470.png" alt="image-20230213201323470"></p></li></ol><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="vmware-setting-2"><ol><li><p>打开“VMware Workstation 15.5 PRO“软件，选择”创建新的虚拟机“。</p><p><img src="https://gitee.com/niiuu/images/raw/master/article_images/typora_images/1745215-20200630140015933-1356816755.png" alt="image"></p></li><li><p>选择“典型”选项，然后下一步。</p><p><img src="https://gitee.com/niiuu/images/raw/master/article_images/typora_images/1745215-20200630140016278-476372467.png" alt="image"></p></li><li><p>选择“稍后安装操作系统”，点击下一步。</p><p><img src="https://gitee.com/niiuu/images/raw/master/article_images/typora_images/1745215-20200630140453132-502089345.png" alt="image"></p></li><li><p>客户机操作选择“Linux”,版本选择“CentOS 7 64位”，点击下一步。</p><p><img src="https://gitee.com/niiuu/images/raw/master/article_images/typora_images/1745215-20200630140016803-1445963239.png" alt="image"></p></li><li><p>输入“虚拟机名称”，选择虚拟机文件保存的位置，点击下一步。</p><p><img src="https://gitee.com/niiuu/images/raw/master/article_images/typora_images/1745215-20200630140017106-928997325.png" alt="image"></p></li><li><p>最大磁盘默认20G大小即可，然后选择“将虚拟机磁盘存储为单个文件”，下一步。</p><p><img src="https://gitee.com/niiuu/images/raw/master/article_images/typora_images/1745215-20200630141232256-59977779.png" alt="image"></p></li><li><p>点击”自定义硬件配置“。</p><p><img src="https://gitee.com/niiuu/images/raw/master/article_images/typora_images/1745215-20200630140017653-1916664250.png" alt="image"></p></li><li><p>选中”新CD/DVD“，选择”使用ISO映像文件“，然后设置CentOS7的ISO映像路径，点击关闭。网络适配器默认NAT。</p><p><img src="https://gitee.com/niiuu/images/raw/master/article_images/typora_images/1745215-20200630141232699-74619395.png" alt="image"></p></li><li><p>点击完成，如下。</p><p><img src="https://gitee.com/niiuu/images/raw/master/article_images/typora_images/1745215-20200630141233074-1238634344.png" alt="image"></p></li></ol><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="vmware-setting-3"><p><strong>暂无</strong></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div>              </div>            </details><details class="folding-tag" cyan><summary> 2）Linux 安装 </summary>              <div class='content'>              <div class="tabs" id="install-os"><ul class="nav-tabs"><li class="tab"><button type="button" data-href="#install-os-1">CentOS</button></li><li class="tab"><button type="button" data-href="#install-os-2">Ubuntu</button></li></ul><div class="tab-contents"><div class="tab-item-content" id="install-os-1"><div class="tabs" id="centos-install"><ul class="nav-tabs"><li class="tab"><button type="button" data-href="#centos-install-1">CentOS 7</button></li><li class="tab"><button type="button" data-href="#centos-install-2">CentOS 6</button></li></ul><div class="tab-contents"><div class="tab-item-content" id="centos-install-1"><ol><li><p>选中刚刚配置的CentOS7，然后点击“开启此虚拟机”。</p><p><img src="https://gitee.com/niiuu/images/raw/master/article_images/typora_images/1745215-20200630152759505-141749521.png" alt="image"></p></li><li><p>虚拟机启动之后会出现如下界面（白色表示选中），默认选中的是Test this media &amp; install CentOS 7。我们将鼠标移入到虚拟机中，并按下键盘中的“↑”键，选择Install CentOS 7，最后按下“Enter 键”。</p><p><img src="https://gitee.com/niiuu/images/raw/master/article_images/typora_images/1745215-20200630174905921-1795699179.png" alt="image"></p><p>注意： 在虚拟机中的操作，鼠标必须要移入到虚拟机中，否则虚拟机感应不到，无法对其进行操作。鼠标移动到虚拟机内部单击或者按下Ctrl + G，鼠标即可移入到虚拟机中。按下Ctrl + Alt，鼠标即可移出虚拟机。</p></li><li><p>按下Enter进行安装。</p><p><img src="https://gitee.com/niiuu/images/raw/master/article_images/typora_images/1745215-20200630161011759-1366753066.png" alt="image"></p></li><li><p>等待系统加载完成。</p><p><img src="https://gitee.com/niiuu/images/raw/master/article_images/typora_images/1745215-20200630174906608-1990481588.png" alt="image"></p></li><li><p>选择使用哪种语言，推荐使用英文。但如果是第一次安装，建议先安装中文版的熟悉一下，之后再选择英文的进行实践，这里就介绍中文的，下滑至底部选择中文。</p><p><img src="https://gitee.com/niiuu/images/raw/master/article_images/typora_images/1745215-20200630161012242-1628807300.png" alt="image"></p></li><li><p>【本地化】只配置日期和时间，键盘和语言支持没有特殊情况默认就好。</p><p><img src="https://gitee.com/niiuu/images/raw/master/article_images/typora_images/1745215-20200630230557848-1683354797.png" alt="image"></p></li><li><p>中国范围内都选择为上海（因为只有上海可选），并选择为24小时制，设置完成后单击完成按钮。</p><p><img src="https://gitee.com/niiuu/images/raw/master/article_images/typora_images/1745215-20200630161013056-530280498.png" alt="image"></p></li><li><p>【软件】中只配置软件选择，安装源系统会自动识别，所以不用管。</p><p><img src="https://gitee.com/niiuu/images/raw/master/article_images/typora_images/1745215-20200630231531469-1653331645.png" alt="image"></p></li><li><p>然后我们选择安装的系统是否含有界面，界面一般对于我们来说用处不大，而且CentOS的界面不好操作，所以这里选择最小安装。</p><p><img src="https://gitee.com/niiuu/images/raw/master/article_images/typora_images/1745215-20200630223316408-794861899.png" alt="image"></p></li><li><p>【系统】中只配置安装位置，指的是系统如何分区，其它的都默认就好。</p><p><img src="https://gitee.com/niiuu/images/raw/master/article_images/typora_images/1745215-20200630231532034-1202194449.png" alt="image"></p></li><li><p>对分区不清楚的就选择自动配置分区，这里演示我要配置分区。</p><p><img src="https://gitee.com/niiuu/images/raw/master/article_images/typora_images/1745215-20200630161014687-1799563201.png" alt="image"></p></li><li><p>手动分区我们要选择标准分区，然后点击下面的“+”添加分区。我们分别创建三个分区：<strong>/boot区、swap交换分区、根分区/</strong></p><p><img src="https://gitee.com/niiuu/images/raw/master/article_images/typora_images/1745215-20200630231532408-1234484840.png" alt="image"></p></li><li><p>添加 /boot分区，用来放启动文件，大小300MB足矣，然后点击“添加挂载点”。</p><p><img src="https://gitee.com/niiuu/images/raw/master/article_images/typora_images/1745215-20200630223316841-1398200240.png" alt="image"></p><p><img src="https://gitee.com/niiuu/images/raw/master/article_images/typora_images/1745215-20200630223317186-1310188677.png" alt="image"></p></li><li><p>添加 swap分区，这个是交换分区，一般情况是物理内存的2倍大小，用于物理内存不足时使用，可能造成系统不稳定，所以看情况，可以设置小一点，甚至设置为0MB，这里我设置为512MB，然后点击”添加挂载点“。</p><p><img src="https://gitee.com/niiuu/images/raw/master/article_images/typora_images/1745215-20200701093454865-211062967.png" alt="image"></p><p><img src="https://gitee.com/niiuu/images/raw/master/article_images/typora_images/1745215-20200630223317888-1108993201.png" alt="image"></p></li><li><p>增加根分区，表示所有空间大小，这里不填写大小，即默认剩余的空间都给根分区，然后点击”添加挂载点“。</p><p><img src="https://gitee.com/niiuu/images/raw/master/article_images/typora_images/1745215-20200701093455353-272328394.png" alt="image"></p><p><img src="https://gitee.com/niiuu/images/raw/master/article_images/typora_images/1745215-20200630223318560-1525794421.png" alt="image"></p></li><li><p>点击”完成“。</p><p><img src="https://gitee.com/niiuu/images/raw/master/article_images/typora_images/1745215-20200630223318908-1084660760.png" alt="image"></p></li><li><p>点击”接受更改“。</p><p><img src="https://gitee.com/niiuu/images/raw/master/article_images/typora_images/1745215-20200630223319242-1124997568.png" alt="image"></p></li><li><p>回到界面，点击“开始安装“。</p><p><img src="https://gitee.com/niiuu/images/raw/master/article_images/typora_images/1745215-20200630232750247-1502840411.png" alt="image"></p></li><li><p>设置管理员ROOT密码，这是最高权限root用户的密码（默认账号为root，密码为现在要设置的）。</p><p><img src="https://gitee.com/niiuu/images/raw/master/article_images/typora_images/1745215-20200701101854681-815218118.png" alt="image"></p><p><img src="https://gitee.com/niiuu/images/raw/master/article_images/typora_images/1745215-20200701094351203-1406912009.png" alt="image"></p><p>在实际中root密码越复杂越好，因为这里只是演示，所以密码就没有那么复杂了。</p><p>提示：这个密码非常重要，请务必牢记！！！</p></li><li><p>创建用户，这里就是普通的用户，权限比较低，这一步我们可以省略。</p><p><img src="https://gitee.com/niiuu/images/raw/master/article_images/typora_images/1745215-20200630232751570-998326083.png" alt="image"></p></li><li><p>用户设置好了之后，等待CentOS安装完成，，然后点击“完成配置”。</p><p><img src="https://gitee.com/niiuu/images/raw/master/article_images/typora_images/1745215-20200630232751891-1194015186.png" alt="image"></p></li><li><p>CentOS的启动之后的界面如下。</p><p><img src="https://gitee.com/niiuu/images/raw/master/article_images/typora_images/1745215-20200701101855216-1487541996.png" alt="image"></p></li></ol><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="centos-install-2"><p><strong>暂无</strong></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="install-os-2"><p><strong>暂无</strong></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div>              </div>            </details><details class="folding-tag" cyan><summary> 3） 网络配置 </summary>              <div class='content'>              <p>因为前面在设置CentOS7的网络适配器的时候，设置是NAT模式。所以这里有两种方法，一种是自动获取IP，另一种是固定获取IP。详细请戳此篇<a href="https://aceniu.github.io/posts/ba31607c.html">《VMware网络配置，只此一篇就够了！》</a>。</p><details class="folding-tag" cyan><summary> 3.1 自动获取IP </summary>              <div class='content'>              <ol><li><p>首先要确保的是CentOS为NAT模式。</p><p><img src="https://gitee.com/niiuu/images/raw/master/article_images/typora_images/1745215-20200701155823239-1019617442.png" alt="image"></p></li><li><p>在VMware界面（管理员方式启动）点击“编辑”里面的“虚拟网络编辑器”，然后勾选DHCP服务将IP地址分配给虚拟机，并设置子网IP(默认就好)。</p><p><img src="https://gitee.com/niiuu/images/raw/master/article_images/typora_images/1745215-20200701163206407-408019680.png" alt="image"></p><p><img src="https://gitee.com/niiuu/images/raw/master/article_images/typora_images/1745215-20200701163206863-358549546.png" alt="image"></p></li><li><p>点击NAT模式旁边的“NAT设置”，然后修改与子网IP同网段下的网关IP，就是前三位必须相同，即192.168.30要相同，最后一位数不相同即可（其实已经自动设置好了，默认），最后点击“确认”保存设置。</p><p><img src="https://gitee.com/niiuu/images/raw/master/article_images/typora_images/1745215-20200701163207167-139980290.png" alt="image"></p></li><li><p>然后启动虚拟机，进入网络配置文件目录：cd /etc/sysconfig/network-scripts/，并且用 ls 命令查看是否有ifcfg-xxx名称的配置文件（ifcfg-lo除外），如果没有则说明网卡没有被识别，这种只能重装或者换个CentOS的版本。</p><p><img src="https://gitee.com/niiuu/images/raw/master/article_images/typora_images/1745215-20200701155824126-673432678.png" alt="image"></p></li><li><p>编辑ifcfg-ens33文件：vi ifcfg-ens33。按 i 进入insert编辑模式，将BOOTPROTO设为dhcp，将ONBOOT设为yes，按下Esc进入命令模式输入:wq保存并退出。</p><p><img src="https://gitee.com/niiuu/images/raw/master/article_images/typora_images/1745215-20200701163207425-717637895.png" alt="image"></p></li><li><p>配置完成之后输入：service network restart，重启网卡让网卡设置生效，之后就可以上网了。</p><p><img src="https://gitee.com/niiuu/images/raw/master/article_images/typora_images/1745215-20200701164056088-720926395.png" alt="image"></p></li><li><p>输入ip addr检查一下动态分配的IP，可以发现分配的动态IP为192.168.30.128。</p><p><img src="https://gitee.com/niiuu/images/raw/master/article_images/typora_images/1745215-20200701164056482-555681813.png" alt="image"></p></li><li><p>最后验证是否可以访问外网。</p><p><img src="https://gitee.com/niiuu/images/raw/master/article_images/typora_images/1745215-20200701164056759-9331224.png" alt="image"></p><p>发现是可以访问外网的。自动获取IP至此就介绍完了，下面介绍另一种方式。</p></li></ol>              </div>            </details><details class="folding-tag" cyan><summary> 3.2 固定获取IP (推荐) </summary>              <div class='content'>              <ol><li><p>首先要确保的虚拟机网络适配器为 自定义<code>WMware8（NAT模式）</code>。（如果在同网段使用NAT模式也可以连通外网）</p><p><img src="https://gitee.com/aceniu/images/raw/master/article_images/typora_images/image-20230214000036153.png" alt="image-20230214000036153"></p></li><li><p>点击“编辑”里面的“虚拟网络编辑器”,取消勾选DHCP服务将IP地址分配给虚拟机。</p><p><img src="https://gitee.com/aceniu/images/raw/master/article_images/typora_images/image-20230214000809770.png" alt="image-20230214000809770"></p></li><li><p>启动虚拟机，进入网络配置文件目录：cd /etc/sysconfig/network-scripts/，然后编辑ifcfg-ens33文件：vi ifcfg-ens33。按shift+i进入insert编辑模式，修改以下内容：</p><blockquote><p>BOOTPROTO=static 启用静态IP地址</p><p>ONBOOT=yes   开启自动启用网络连接</p></blockquote><p>添加以下内容：</p><blockquote><p>IPADDR=192.168.30.100   设置IP地址</p><p>NETMASK=255.255.255.0  子网掩码</p><p>GATEWAY=192.168.30.2  设置网关</p></blockquote><p>注意：IPADDR不能和子网IP冲突(最后一位只要在0~255范围内随便取一个数字，这里选择100)，GATEWAY即”NAT设置“里面的网关IP。</p><p>最后按下Esc进入命令模式输入:wq保存并退出。</p><p><img src="https://gitee.com/aceniu/images/raw/master/article_images/typora_images/image-20230214001010813.png" alt="image-20230214001010813"></p><p><img src="https://gitee.com/aceniu/images/raw/master/article_images/typora_images/image-20230214001113573.png" alt="image-20230214001113573"></p><p>修改和添加内容后如下图：</p><p><img src="https://gitee.com/aceniu/images/raw/master/article_images/typora_images/image-20230214001427820.png" alt="image-20230214001427820"></p></li><li><p>输入 <code>service network restart</code> 重启网卡让网卡设置生效。</p></li><li><p>输入ip addr检查一下IP。</p></li><li><p>验证是否可以访问外网：<code>ping www.baidu.com</code></p><p>如果 <code>ping www.baidu.com</code> 不通，那么再测试一下百度的ip地址<code>14.215.177.38</code>能否ping通，如果ip能通而域名不通则说明DNS解析有误，需要设置DNS。</p></li><li><p>设置DNS（有两种方式）。</p><p>注意：DNS服务器可以只配一个，也可以配置多个，下面我用的是两个免费的DNS服务器，查看IP地址，测试联网。</p><p>①在 ifcfg-ens33 <a href="http://%E6%96%87%E4%BB%B6%E7%9A%84%E5%90%8E%E9%9D%A2%E8%BF%9B%E8%A1%8C%E6%B7%BB%E5%8A%A0DNS1=xxx.xxx.xxx.xxx">文件的后面进行添加DNS1=xxx.xxx.xxx.xxx</a>。</p><p><img src="https://gitee.com/niiuu/images/raw/master/article_images/typora_images/1745215-20200701182055948-798983910.png" alt="image"></p><p>注意改完后重启网卡才能生效。</p><p>②改 <code>vi /etc/resolv.conf</code> ,使用vi命令添加的时候要注意格式：</p><blockquote><p>nameserver xxx1.xxx1.xxx1.xxx1</p><p>nameserver xxx2.xxx2.xxx2.xxx2</p></blockquote><p>或者直接 <code>echo -e &quot;nameserver 114.114.114.114\nnameserver 223.5.5.5&quot; &gt;&gt;/etc/resolv.conf</code>。(\n是换行的意思)</p><p><img src="https://gitee.com/niiuu/images/raw/master/article_images/typora_images/1745215-20200701182056328-1371855461.png" alt="image"></p></li></ol>              </div>            </details><details class="folding-tag" cyan><summary> 常用的免费DNS地址 </summary>              <div class='content'>              <ul><li><p>国内移动、电信和联通通用的 DNS：<code>114.114.114.114</code></p></li><li><p>阿里：首选：<code>223.5.5.5</code> 备用：<code>223.6.6.6</code></p></li><li><p>百度 ：<code>180.76.76.76</code></p></li><li><p>腾讯：首选：<code>119.29.29.29</code>，备用：<code>119.28.28.28</code></p></li><li><p>谷歌： <code>8.8.8.8</code></p></li></ul>              </div>            </details>              </div>            </details><hr><h1 id="3）安装-VMware-Tools">3）安装 VMware Tools</h1><details class="folding-tag" cyan><summary> 安装VMware Tools </summary>              <div class='content'>              <blockquote><p>VMware Tools 是 VMware 虚拟机中自带的一种增强工具，相当于 VirtualBox 中的增强功能（Sun VirtualBox Guest Additions），是VMware 提供的增强虚拟显卡和硬盘性能、以及同步虚拟机与主机时钟的驱动程序。</p></blockquote><p>⚠️ <strong>请在连接外网后再这样做</strong></p><ol><li><p>首先关闭虚拟机，如果之前使用过iso镜像启动的，请将连接选项中更改为使用物理驱动器。</p><p><img src="https://gitee.com/aceniu/images/raw/master/article_images/typora_images/image-20230214014512998.png" alt="image-20230214014512998"></p></li><li><p>启动虚拟机成功以后使用root用户登录虚拟机，然后点击VMware菜单→虚拟机→安装VMware Tools。</p><p><img src="https://gitee.com/aceniu/images/raw/master/article_images/typora_images/1366-e15f161772830acd336097569a0e6ce4.png" alt="img"></p></li><li><p>勾选安装VMware-Tools以后会弹出提示，默认如下页面。</p><p><img src="https://gitee.com/aceniu/images/raw/master/article_images/typora_images/2a62-2136cc7201d2e5d68a28978baaa487c1.png" alt="img"></p></li><li><p>安装过程为了方便复制命令，我这里使用第三方工具finashell 登录centos系统。</p></li><li><p>进入虚拟机，将光盘里面的安装文件挂载到/mnt 目录下。</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># mount /dev/sr0 /mnt</span></span><br><span class="line"></span><br><span class="line">[root@localhost ~]<span class="comment"># ls /mnt</span></span><br><span class="line">manifest.txt  run_upgrader.sh  VMwareTools-10.3.25-20206839.tar.gz  vmware-tools-upgrader-32  vmware-tools-upgrader-64</span><br><span class="line"><span class="comment"># 看到安装文件已经正确挂载</span></span><br><span class="line"></span><br></pre></td></tr></table></figure></li><li><p>文件复制到root目录下，解压。</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 注意文件版本不通名字一样的需要修改</span></span><br><span class="line">[root@localhost ~]<span class="comment"># cp /mnt/VMwareTools-10.3.25-20206839.tar.gz /root</span></span><br><span class="line"><span class="comment"># 进行解压</span></span><br><span class="line">[root@localhost ~]<span class="comment"># tar -zxvf VMwareTools-10.3.25-20206839.tar.gz</span></span><br></pre></td></tr></table></figure></li><li><p>安装依赖包。</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum -y install perl gcc make kernel-headers kernel-devel</span><br></pre></td></tr></table></figure></li><li><p>进入VMwareTools安装目录，并执行安装。</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /root/vmware-tools-distrib</span><br><span class="line">./vmware-install.pl</span><br><span class="line"><span class="comment"># 执行安装脚本进行安装，一直按回车按键即可。</span></span><br></pre></td></tr></table></figure></li></ol>              </div>            </details>]]></content>
    
    
    <summary type="html">VMware 是一款虚拟机软件，可以在 Windows、Linux 和 macOS 等操作系统上运行虚拟机。使用 VMware，您可以在同一台计算机上同时运行多个操作系统，包括各种版本的 Linux 操作系统。常见的 Linux 操作系统有：Ubuntu, Debian, Fedora, CentOS, Red Hat Enterprise Linux。</summary>
    
    
    
    <category term="Program" scheme="https://blog.halfsummer.xyz/categories/Program/"/>
    
    <category term="VMware" scheme="https://blog.halfsummer.xyz/categories/Program/VMware/"/>
    
    
    <category term="Linux" scheme="https://blog.halfsummer.xyz/tags/Linux/"/>
    
    <category term="VMware" scheme="https://blog.halfsummer.xyz/tags/VMware/"/>
    
    <category term="CentOS" scheme="https://blog.halfsummer.xyz/tags/CentOS/"/>
    
    <category term="Ubuntu" scheme="https://blog.halfsummer.xyz/tags/Ubuntu/"/>
    
  </entry>
  
  <entry>
    <title>VMware网络配置，只此一篇就够了！</title>
    <link href="https://blog.halfsummer.xyz/posts/ba31607c.html"/>
    <id>https://blog.halfsummer.xyz/posts/ba31607c.html</id>
    <published>2023-02-13T12:23:06.000Z</published>
    <updated>2023-03-11T12:51:07.430Z</updated>
    
    <content type="html"><![CDATA[<meta name="referrer" content="no-referrer" /><h1 id="1-使用VMware虚拟机连接网络时，经常会遇到以下问题">1. 使用VMware虚拟机连接网络时，经常会遇到以下问题</h1><ul><li>主机和虚拟机如何建立网络连接</li><li>虚拟机如何访问Internet</li><li>在工作单位的网络中如何使用虚拟机，避免虚拟机影响正常网络</li></ul><hr><h1 id="2-网络场景配置">2. 网络场景配置</h1><h2 id="2-1-宿主机与虚拟机组成局域网，其他电脑不能访问该网络">2.1 宿主机与虚拟机组成局域网，其他电脑不能访问该网络</h2><p>相当于把虚拟机当成PC，宿主机当成路由器。&quot;路由器&quot;不接入外网。</p><p><strong>仅主机模式</strong></p><ul><li><p><strong>特点</strong>：</p><ul><li>虚拟机和宿主机组成一个封闭的局域网</li><li>虚拟机不能访问外部网络、互联网</li><li>外部网络也不能访问虚拟机</li></ul></li><li><p><strong>具体操作过程</strong></p><div class="note default modern"><p>进入VMware-&gt;主菜单-&gt; 虚拟网络编辑器</p></div><p><img src="https://gitee.com/aceniu/images/raw/master/article_images/typora_images/image-20230213123835460.png" alt="image-20230213123835460"></p><p><img src="https://gitee.com/aceniu/images/raw/master/article_images/typora_images/image-20230213124245129.png" alt="image-20230213124245129"></p><p><img src="https://gitee.com/aceniu/images/raw/master/article_images/typora_images/image-20230213124434486.png" alt="image-20230213124434486"></p><blockquote><ul><li>在网络列表中选择“VMnet1”,如果没有，可以点击“添加网络”按钮增加，为什么是VMnet1呢，这个应该是VMWare默认设置，当然是用其他网卡也是可以的。</li><li>选择“仅主机模式”</li><li>并选择“将主机虚拟适配器连接到此网络”和“是用本地DHCP服务将IP地址分配给虚拟机”选项</li><li>子网IP:10.10.10.0，子网掩码：255.255.255.0，我习惯将“仅主机模式”的子网网段配置为“10.10.10.0”，这个可以根据自己的喜好来设置。</li></ul></blockquote><div class="note default modern"><p>修改虚拟机设置，将网络适配器修改为“仅主机模式”</p></div><p><img src="https://gitee.com/aceniu/images/raw/master/article_images/typora_images/image-20230213124901613.png" alt="image-20230213124901613"></p></li><li><p>总结</p><p>宿主机主机IP地址为：10.10.10.1<br>虚拟机的IP地址为自动获取，一般为：10.10.10.128<br>此时宿主机和虚拟机组成了一个小的独立局域网，其他电脑不能访问该网络，同时该网络内的虚拟机也不能访问外部网络，如果大家有此种应用需求，就可以使用该方式搭建网络。</p></li></ul><h2 id="2-2-虚拟机加入工作单位局域网，其他电脑允许访问虚拟机">2.2 虚拟机加入工作单位局域网，其他电脑允许访问虚拟机</h2><p>相当于把虚拟机当成PC，去连接宿主机。宿主机和虚拟机连接路由后再接入外网。</p><p><strong>桥接模式</strong></p><ul><li><p><strong>特点</strong></p><ul><li>可以将虚拟机看做一台新电脑，接入了宿主机所在的网络，如果是在工作单位，可能造成虚拟机IP占用单位同事电脑的IP地址，小心单位网管会找你呦。。。</li><li>虚拟机允许访问宿主机所在网络的其他电脑</li><li>虚拟机允许访问Internet互联网（当然宿主机必须可以访问互联网才行）。</li><li>主机和虚拟机通过单位局域网，互联互通。</li></ul></li><li><p><strong>具体操作过程</strong></p><div class="note default modern"><p>进入VMware-&gt;主菜单-&gt; 虚拟网络编辑器</p></div><p><img src="https://gitee.com/aceniu/images/raw/master/article_images/typora_images/image-20230213123835460.png" alt="image-20230213123835460"></p><p><img src="https://gitee.com/aceniu/images/raw/master/article_images/typora_images/image-20230213124245129.png" alt="image-20230213124245129"></p><p><img src="https://gitee.com/aceniu/images/raw/master/article_images/typora_images/image-20230213132601922.png" alt="image-20230213132601922"></p><blockquote><ul><li>在网络列表中选择“VMnet0”,如果没有，可以点击“添加网络”按钮增加，为什么是VMnet0呢，这个应该是VMware默认设置，当然是用其他网卡也是可以的。</li><li>选择“桥接模式”</li><li>选择宿主机访问外部网络的物理网卡，可以使有线网卡也可以是无线网卡。</li><li>确定，保存</li></ul></blockquote><div class="note default modern"><p>修改虚拟机设置，将网络适配器修改为“桥接模式”</p></div><p><img src="https://gitee.com/aceniu/images/raw/master/article_images/typora_images/image-20230213133120357.png" alt="image-20230213133120357"></p></li><li><p>总结</p><p>虚拟机从单位局域网自动获取IP地址，如果未获取到IP地址，需要自己指定IP<br>宿主机仍然使用单位内原有IP<br>宿主机和虚拟机同时接入工作单位局域网络虚拟机通过公司局域网，访问Internet互联网（当然需要网管人员为虚拟机IP开通外网访问权限）。</p></li></ul><h2 id="2-3-虚拟机通过宿主机访问互联网">2.3 虚拟机通过宿主机访问互联网</h2><p>相当于把虚拟机当成PC，去连接宿主机（宿主机也是一层路由）。宿主机再连接路由后再接入外网。</p><p><strong>NAT模式</strong></p><ul><li><p><strong>特点</strong></p><ul><li><p>虚拟机和宿主机组成小局域网，做到互联互通。</p></li><li><p>虚拟机通过宿主机访问外部网络（此时宿主机起到路由器作用），但外部网络不能访问虚拟机</p></li><li><p>虚拟机允许访问Internet互联网（当然宿主机必须可以访问互联网才行）</p></li></ul></li><li><p><strong>具体操作过程</strong></p><div class="note default modern"><p>进入VMware-&gt;主菜单-&gt; 虚拟网络编辑器</p></div><p><img src="https://gitee.com/aceniu/images/raw/master/article_images/typora_images/image-20230213123835460.png" alt="image-20230213123835460"></p><p><img src="https://gitee.com/aceniu/images/raw/master/article_images/typora_images/image-20230213124245129.png" alt="image-20230213124245129"></p><p><img src="https://gitee.com/aceniu/images/raw/master/article_images/typora_images/image-20230213133801249.png" alt="image-20230213133801249"></p><blockquote><ul><li>在网络列表中选择“VMnet8”,如果没有，可以点击“添加网络”按钮增加，为什么是VMnet8呢，这个应该是VMware默认设置，当然是用其他网卡也是可以的。</li><li>选择“NAT模式”</li><li>并选择“将主机虚拟适配器连接到此网络”和“是用本地DHCP服务将IP地址分配给虚拟机”选项</li><li>子网IP:10.0.0.0，子网掩码：255.255.255.0，为了与“仅主机模式”区分，我习惯将“NAT模式”的子网网段配置为“10.0.0.0”，这个可以根据自己的喜好来设置。</li></ul></blockquote><div class="note default modern"><p>修改虚拟机设置，将网络适配器修改为“NAT模式”</p></div><p><img src="https://gitee.com/aceniu/images/raw/master/article_images/typora_images/image-20230213134055381.png" alt="image-20230213134055381"></p></li><li><p>总结</p><p>宿主机主机IP地址为：10.0.0.1<br>虚拟机的IP地址为自动获取，一般为：10.0.0.128<br>此时宿主机和虚拟机组成了一个小的独立局域网，其他电脑不能访问该网络虚拟机可以访问外部网络，如果宿主机可以访问Internet互联网，此时虚拟就具备了访问互联网的能力；我个人在工作单位一般使用该方式，虚拟机可以使用互联网功能，又不会有网管找上门来。如果大家有此种应用需求，就可以使用该方式搭建网络。</p></li></ul><hr><h1 id="3-图解分析">3. 图解分析</h1><p><img src="https://gitee.com/aceniu/images/raw/master/article_images/typora_images/17031708005610.jpg" alt="17031708005610"></p>]]></content>
    
    
    <summary type="html">我们在使用 VMware虚拟机时，配置频度最高的往往是网络配置，最让人困惑的往往也是网络设置，虚拟机如何实现和宿主机的通信？虚拟机如何实现与宿主机之外的外部主机通信？同一个宿主机内的多个虚拟机之间如何通信？这些问题是否常常困惑着你。</summary>
    
    
    
    <category term="Program" scheme="https://blog.halfsummer.xyz/categories/Program/"/>
    
    <category term="VMware" scheme="https://blog.halfsummer.xyz/categories/Program/VMware/"/>
    
    
    <category term="VMware" scheme="https://blog.halfsummer.xyz/tags/VMware/"/>
    
    <category term="虚拟机" scheme="https://blog.halfsummer.xyz/tags/%E8%99%9A%E6%8B%9F%E6%9C%BA/"/>
    
  </entry>
  
</feed>
