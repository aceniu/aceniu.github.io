<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><title>Docker å­¦ä¹ ç¬”è®° | è‰¾æ–¯ç‰› Blog</title><meta name="author" content="aceniu,123354319@qq.com"><meta name="copyright" content="aceniu"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="1ï¼‰ç®€ä»‹ Dockerï¼šhttps:&#x2F;&#x2F;www.docker.com  Docker Hubï¼šhttps:&#x2F;&#x2F;hub.docker.com  1.1 Docker ä¸ºä»€ä¹ˆæ¨ªç©ºå‡ºä¸– ä¼ ç»Ÿå¼€å‘ä¸­ï¼Œè½¯ä»¶ç¼–ç å¼€å‘&#x2F;æµ‹è¯•ç»“æŸåï¼Œæ‰€äº§å‡ºçš„æˆæœå³æ˜¯ç¨‹åºæˆ–æ˜¯èƒ½å¤Ÿç¼–è¯‘æ‰§è¡Œçš„äºŒè¿›åˆ¶å­—èŠ‚ç ç­‰(javaä¸ºä¾‹)ã€‚è€Œä¸ºäº†è®©è¿™äº›ç¨‹åºå¯ä»¥é¡ºåˆ©æ‰§è¡Œï¼Œå¼€å‘å›¢é˜Ÿä¹Ÿå¾—å‡†å¤‡å®Œæ•´çš„éƒ¨ç½²æ–‡ä»¶ï¼Œè®©ç»´è¿å›¢é˜Ÿå¾—ä»¥éƒ¨ç½²åº”ç”¨ç¨‹å¼ï¼Œå¼€å‘éœ€è¦æ¸…æ¥šçš„å‘Šè¯‰"><meta property="og:type" content="article"><meta property="og:title" content="Docker å­¦ä¹ ç¬”è®°"><meta property="og:url" content="https://blog.halfsummer.xyz/posts/920e92d1.html"><meta property="og:site_name" content="è‰¾æ–¯ç‰› Blog"><meta property="og:description" content="1ï¼‰ç®€ä»‹ Dockerï¼šhttps:&#x2F;&#x2F;www.docker.com  Docker Hubï¼šhttps:&#x2F;&#x2F;hub.docker.com  1.1 Docker ä¸ºä»€ä¹ˆæ¨ªç©ºå‡ºä¸– ä¼ ç»Ÿå¼€å‘ä¸­ï¼Œè½¯ä»¶ç¼–ç å¼€å‘&#x2F;æµ‹è¯•ç»“æŸåï¼Œæ‰€äº§å‡ºçš„æˆæœå³æ˜¯ç¨‹åºæˆ–æ˜¯èƒ½å¤Ÿç¼–è¯‘æ‰§è¡Œçš„äºŒè¿›åˆ¶å­—èŠ‚ç ç­‰(javaä¸ºä¾‹)ã€‚è€Œä¸ºäº†è®©è¿™äº›ç¨‹åºå¯ä»¥é¡ºåˆ©æ‰§è¡Œï¼Œå¼€å‘å›¢é˜Ÿä¹Ÿå¾—å‡†å¤‡å®Œæ•´çš„éƒ¨ç½²æ–‡ä»¶ï¼Œè®©ç»´è¿å›¢é˜Ÿå¾—ä»¥éƒ¨ç½²åº”ç”¨ç¨‹å¼ï¼Œå¼€å‘éœ€è¦æ¸…æ¥šçš„å‘Šè¯‰"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="http://cos.halfsummer.xyz/pictures/niubb/2023/20230228-63fdc7d0ce7ba.jpeg"><meta property="article:published_time" content="2023-03-13T23:04:59.000Z"><meta property="article:modified_time" content="2023-03-13T17:48:54.679Z"><meta property="article:author" content="aceniu"><meta property="article:tag" content="aceniu,blog"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="http://cos.halfsummer.xyz/pictures/niubb/2023/20230228-63fdc7d0ce7ba.jpeg"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://blog.halfsummer.xyz/posts/920e92d1.html"><link rel="preconnect" href="//cdn.jsdelivr.net"><link rel="preconnect" href="//busuanzi.ibruce.info"><link rel="manifest" href="/manifest.json"><meta name="msapplication-TileColor" content="#3b70fc"><link rel="apple-touch-icon" sizes="180x180" href="/img/siteicon/128.png"><link rel="icon" type="image/png" sizes="32x32" href="/img/siteicon/32.png"><link rel="icon" type="image/png" sizes="16x16" href="/img/siteicon/16.png"><link rel="mask-icon" href="/img/siteicon/128.png" color="#5bbad5"><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload='this.media="all"'><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.min.css" media="print" onload='this.media="all"'><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"languages":{"hits_empty":"æ‰¾ä¸åˆ°æ‚¨æŸ¥è¯¢çš„å†…å®¹ï¼š${query}"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: 'å¤åˆ¶æˆåŠŸ',
    error: 'å¤åˆ¶é”™è¯¯',
    noSupport: 'æµè§ˆå™¨ä¸æ”¯æŒ'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: 'åˆšåˆš',
    min: 'åˆ†é’Ÿå‰',
    hour: 'å°æ—¶å‰',
    day: 'å¤©å‰',
    month: 'ä¸ªæœˆå‰'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  }
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE={title:"Docker å­¦ä¹ ç¬”è®°",isPost:!0,isHome:!1,isHighlightShrink:!1,isToc:!0,postUpdate:"2023-03-13 17:48:54"}</script><noscript><style>#nav{opacity:1}.justified-gallery img{opacity:1}#post-meta time,#recent-posts time{display:inline!important}</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
    win.getCSS = url => new Promise((resolve, reject) => {
      const link = document.createElement('link')
      link.rel = 'stylesheet'
      link.href = url
      link.onload = () => resolve()
      link.onerror = () => reject()
      document.head.appendChild(link)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><link rel="stylesheet" href="/css/custom.css" media="defer" onload='this.media="all"'><link rel="stylesheet" href="https://cdn.cbd.int/hexo-butterfly-tag-plugins-plus@latest/lib/assets/font-awesome-animation.min.css" media="defer" onload='this.media="all"'><link rel="stylesheet" href="https://cdn.cbd.int/hexo-butterfly-tag-plugins-plus@latest/lib/tag_plugins.css" media="defer" onload='this.media="all"'><script src="https://cdn.cbd.int/hexo-butterfly-tag-plugins-plus@latest/lib/assets/carousel-touch.js"></script><link rel="stylesheet" href="https://cdn.cbd.int/hexo-butterfly-wowjs/lib/animate.min.css" media="print" onload='this.media="screen"'><meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="è‰¾æ–¯ç‰› Blog" type="application/atom+xml"></head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="http://cos.halfsummer.xyz/pictures/niubb/2023/20230228-63fdc7d0ce7ba.jpeg" onerror='onerror=null,src="/img/friend_404.gif"' alt="avatar"></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">33</div></a><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">13</div></a><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">10</div></a></div><hr><div class="menus_items"><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/"><i class="fa-fw fas fa-home faa-tada"></i> <span>Home</span></a></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/comments/"><i class="fa-fw fas fa-envelope faa-tada"></i> <span>ç•™è¨€æ¿</span></a></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/bangumis/index.html"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-bilibili"></use></svg> <span>è¿½ç•ª</span></a></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="javascript:void(0);"><i class="fa-fw fas fa-list hide"></i> <span>List</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/images/"><i class="fa-fw fa fa-images faa-tada"></i> <span>å›¾åºŠ</span></a></li></ul></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><span id="blog-info"><a href="/" title="è‰¾æ–¯ç‰› Blog"><span class="site-name">è‰¾æ–¯ç‰› Blog</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i> <span>æœç´¢</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/"><i class="fa-fw fas fa-home faa-tada"></i> <span>Home</span></a></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/comments/"><i class="fa-fw fas fa-envelope faa-tada"></i> <span>ç•™è¨€æ¿</span></a></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/bangumis/index.html"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-bilibili"></use></svg> <span>è¿½ç•ª</span></a></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="javascript:void(0);"><i class="fa-fw fas fa-list hide"></i> <span>List</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/images/"><i class="fa-fw fa fa-images faa-tada"></i> <span>å›¾åºŠ</span></a></li></ul></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">Docker å­¦ä¹ ç¬”è®°</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">å‘è¡¨äº</span><time class="post-meta-date-created" datetime="2023-03-13T23:04:59.000Z" title="å‘è¡¨äº 2023-03-13 23:04:59">2023-03-13</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">æ›´æ–°äº</span><time class="post-meta-date-updated" datetime="2023-03-13T17:48:54.679Z" title="æ›´æ–°äº 2023-03-13 17:48:54">2023-03-13</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" data-flag-title="Docker å­¦ä¹ ç¬”è®°"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">é˜…è¯»é‡:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><meta name="referrer" content="no-referrer"><h1 id="1ï¼‰ç®€ä»‹">1ï¼‰ç®€ä»‹</h1><div class="tip home"><p>Dockerï¼š<a target="_blank" rel="noopener" href="https://www.docker.com">https://www.docker.com</a></p></div><div class="tip home"><p>Docker Hubï¼š<a target="_blank" rel="noopener" href="https://hub.docker.com">https://hub.docker.com</a></p></div><h2 id="1-1-Docker-ä¸ºä»€ä¹ˆæ¨ªç©ºå‡ºä¸–">1.1 Docker ä¸ºä»€ä¹ˆæ¨ªç©ºå‡ºä¸–</h2><p>ä¼ ç»Ÿå¼€å‘ä¸­ï¼Œè½¯ä»¶ç¼–ç å¼€å‘/æµ‹è¯•ç»“æŸåï¼Œæ‰€äº§å‡ºçš„æˆæœå³æ˜¯ç¨‹åºæˆ–æ˜¯èƒ½å¤Ÿç¼–è¯‘æ‰§è¡Œçš„äºŒè¿›åˆ¶å­—èŠ‚ç ç­‰(javaä¸ºä¾‹)ã€‚è€Œä¸ºäº†è®©è¿™äº›ç¨‹åºå¯ä»¥é¡ºåˆ©æ‰§è¡Œï¼Œå¼€å‘å›¢é˜Ÿä¹Ÿå¾—å‡†å¤‡å®Œæ•´çš„éƒ¨ç½²æ–‡ä»¶ï¼Œè®©ç»´è¿å›¢é˜Ÿå¾—ä»¥éƒ¨ç½²åº”ç”¨ç¨‹å¼ï¼Œ<b style="color:#01b4bc">å¼€å‘éœ€è¦æ¸…æ¥šçš„å‘Šè¯‰è¿ç»´éƒ¨ç½²å›¢é˜Ÿï¼Œç”¨çš„å…¨éƒ¨é…ç½®æ–‡ä»¶+æ‰€æœ‰è½¯ä»¶ç¯å¢ƒã€‚ä¸è¿‡ï¼Œå³ä¾¿å¦‚æ­¤ï¼Œä»ç„¶å¸¸å¸¸å‘ç”Ÿéƒ¨ç½²å¤±è´¥çš„çŠ¶å†µ</b>ã€‚<b style="color:#fa5457">Dockerçš„å‡ºç°ä½¿å¾—Dockerå¾—ä»¥æ‰“ç ´è¿‡å»ã€Œç¨‹åºå³åº”ç”¨ã€çš„è§‚å¿µã€‚é€è¿‡é•œåƒ(images)å°†ä½œä¸šç³»ç»Ÿæ ¸å¿ƒé™¤å¤–ï¼Œè¿ä½œåº”ç”¨ç¨‹å¼æ‰€éœ€è¦çš„ç³»ç»Ÿç¯å¢ƒï¼Œç”±ä¸‹è€Œä¸Šæ‰“åŒ…ï¼Œè¾¾åˆ°åº”ç”¨ç¨‹å¼è·¨å¹³å°é—´çš„æ— ç¼æ¥è½¨è¿ä½œ</b>ã€‚</p><h2 id="1-2-æ¦‚è¿°">1.2 æ¦‚è¿°</h2><p><b style="color:#fa5457">Dockeræ˜¯åŸºäºGoè¯­è¨€å®ç°çš„äº‘å¼€æºé¡¹ç›®</b>ã€‚</p><p>Dockerçš„ä¸»è¦ç›®æ ‡æ˜¯â€œBuildï¼ŒShip and Run Any App,Anywhereâ€ï¼Œä¹Ÿå°±æ˜¯é€šè¿‡å¯¹åº”ç”¨ç»„ä»¶çš„å°è£…ã€åˆ†å‘ã€éƒ¨ç½²ã€è¿è¡Œç­‰ç”Ÿå‘½å‘¨æœŸçš„ç®¡ç†ï¼Œä½¿ç”¨æˆ·çš„ APPï¼ˆå¯ä»¥æ˜¯ä¸€ä¸ªWEBåº”ç”¨æˆ–æ•°æ®åº“åº”ç”¨ç­‰ç­‰ï¼‰åŠå…¶è¿è¡Œç¯å¢ƒèƒ½å¤Ÿåšåˆ°â€œ<b style="color:#fa5457">ä¸€æ¬¡é•œåƒï¼Œå¤„å¤„è¿è¡Œ</b>â€ã€‚</p><p><b style="color:#01b4bc">Linuxå®¹å™¨æŠ€æœ¯çš„å‡ºç°å°±è§£å†³äº†è¿™æ ·ä¸€ä¸ªé—®é¢˜ï¼Œè€Œ Docker å°±æ˜¯åœ¨å®ƒçš„åŸºç¡€ä¸Šå‘å±•è¿‡æ¥çš„</b>ã€‚å°†åº”ç”¨æ‰“æˆé•œåƒï¼Œé€šè¿‡é•œåƒæˆä¸ºè¿è¡Œåœ¨Dockerå®¹å™¨ä¸Šé¢çš„å®ä¾‹ï¼Œè€Œ Dockerå®¹å™¨åœ¨ä»»ä½•æ“ä½œç³»ç»Ÿä¸Šéƒ½æ˜¯ä¸€è‡´çš„ï¼Œè¿™å°±å®ç°äº†è·¨å¹³å°ã€è·¨æœåŠ¡å™¨ã€‚<b style="color:#fa5457">åªéœ€è¦ä¸€æ¬¡é…ç½®å¥½ç¯å¢ƒï¼Œæ¢åˆ°åˆ«çš„æœºå­ä¸Šå°±å¯ä»¥ä¸€é”®éƒ¨ç½²å¥½ï¼Œå¤§å¤§ç®€åŒ–äº†æ“ä½œ</b>ã€‚</p><h2 id="1-3-å®¹å™¨ä¸è™šæ‹Ÿæœºçš„æ¯”è¾ƒ">1.3 å®¹å™¨ä¸è™šæ‹Ÿæœºçš„æ¯”è¾ƒ</h2><p>ğŸ“Œ <strong>çº¯ç‰©ç†éƒ¨ç½²ã€è™šæ‹Ÿæœºçš„éƒ¨ç½²çš„ç¼ºç‚¹</strong></p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cos.halfsummer.xyz/pictures/niubb/2023/20230313-640f3c13d7da4.png" alt="image-20230106105948208"></p><p>ğŸ“Œ <strong>è™šæ‹ŸåŒ–å‘å±•å²</strong></p><ul><li><p>ä¸ªäººè™šæ‹ŸåŒ– vmware workstationï¼Œä¸»è¦ç”¨äºä¸ªäººç”µè„‘ã€‚</p></li><li><p>ä¼ä¸šç‰ˆè™šæ‹ŸåŒ– vmware esxi è™šæ‹ŸåŒ–å·¥å…·ï¼Œç”¨äºé«˜æ€§èƒ½æœåŠ¡å™¨</p></li><li><p>Linuxä¸‹è™šæ‹Ÿæœºå·¥ä½œï¼Œkvm å·¥å…·</p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gitee.com/niiuu/images/raw/master/article_images/typora_images/image-20230106111151052.png" alt="image-20230106111151052" style="zoom:50%"></li><li><p>å®¹å™¨-LXC &amp; docker</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cos.halfsummer.xyz/pictures/niubb/2023/20230313-640f3c1311949.png" alt="image-20230106111707293"></p></li></ul><p>ğŸ“Œ <strong>å¼€å‘ä¸­çš„é—®é¢˜</strong></p><ul><li>åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œä¾èµ–çš„ç»„ä»¶éå¸¸å¤šï¼Œä¸åŒç»„ä»¶ä¹‹é—´éƒ¨ç½²æ—¶å¾€å¾€ä¼šäº§ç”Ÿä¸€äº›å†²çªã€‚</li><li>åœ¨æ•°ç™¾ä¸Šåƒå°æœåŠ¡ä¸­é‡å¤éƒ¨ç½²ï¼Œç¯å¢ƒä¸ä¸€å®šä¸€è‡´ï¼Œå¼€å‘ã€æµ‹è¯•ã€ç”Ÿäº§ç¯å¢ƒæœ‰å·®å¼‚ï¼Œä¼šé‡åˆ°å„ç§é—®é¢˜</li></ul><p>ğŸ“Œ <strong>Docker è§£å†³ä¾èµ–å…¼å®¹é—®é¢˜</strong></p><ul><li>å°†åº”ç”¨çš„Libsï¼ˆå‡½æ•°åº“ï¼‰ã€Depsï¼ˆä¾èµ–ï¼‰ã€é…ç½®ä¸åº”ç”¨ä¸€èµ·æ‰“åŒ…</li><li>å°†æ¯ä¸ªåº”ç”¨æ”¾åˆ°ä¸€ä¸ªéš”ç¦»<strong>å®¹å™¨</strong>å»è¿è¡Œï¼Œé¿å…äº’ç›¸å¹²æ‰°</li></ul><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cos.halfsummer.xyz/pictures/niubb/2023/20230313-640f3c14030d7.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" style="zoom:33%"><p>ğŸ“Œ <strong>Docker è§£å†³æ“ä½œç³»ç»Ÿç¯å¢ƒå·®å¼‚</strong></p><p>åº”ç”¨ç¨‹åºåœ¨è®¡ç®—æœºä¸­äº¤äº’çš„æµç¨‹å¦‚ä¸‹ï¼š</p><p>1ï¼‰åº”ç”¨è°ƒç”¨æ“ä½œç³»ç»Ÿåº”ç”¨ï¼ˆå‡½æ•°åº“ï¼‰ï¼Œå®ç°å„ç§åŠŸèƒ½</p><p>2ï¼‰ç³»ç»Ÿå‡½æ•°åº“æ˜¯å¯¹å†…æ ¸æŒ‡ä»¤é›†çš„å°è£…ï¼Œä¼šè°ƒç”¨å†…æ ¸æŒ‡ä»¤</p><p>3ï¼‰å†…æ ¸æŒ‡ä»¤æ“ä½œè®¡ç®—æœºç¡¬ä»¶</p><p>ğŸ“Œ <strong>Dockerå¦‚ä½•è§£å†³ä¸åŒç³»ç»Ÿç¯å¢ƒçš„é—®é¢˜ï¼Ÿ</strong></p><ul><li><b style="color:#01b4bc">Dockerå°†ç”¨æˆ·ç¨‹åºä¸æ‰€éœ€è¦è°ƒç”¨çš„ç³»ç»Ÿ(æ¯”å¦‚Ubuntu)å‡½æ•°åº“ä¸€èµ·æ‰“åŒ…</b>ï¼Œä¸ç®¡å®é™…çš„è¿è¡Œç³»ç»Ÿæ˜¯Centosè¿˜æ˜¯Ubuntuéƒ½å¯ä»¥æ­£å¸¸è¿è¡Œï¼Œå› ä¸ºåº”ç”¨ç¨‹åºè°ƒç”¨çš„æ˜¯æ†ç»‘åœ¨ä¸€èµ·çš„ç³»ç»Ÿçš„å‡½æ•°ï¼Œç³»ç»Ÿå‡½æ•°å†è°ƒç”¨linuxå†…æ ¸çš„å‡½æ•°ã€‚</li><li>Dockerè¿è¡Œåˆ°ä¸åŒæ“ä½œç³»ç»Ÿæ—¶ï¼Œç›´æ¥åŸºäºæ‰“åŒ…çš„å‡½æ•°åº“ï¼Œ<b style="color:#01b4bc">åªå€ŸåŠ©äºæ“ä½œç³»ç»Ÿçš„Linuxå†…æ ¸æ¥è¿è¡Œï¼Œä¸åœ¨ä¹å®é™…è¿è¡Œçš„ç³»ç»Ÿç‰ˆæœ¬æ˜¯ä»€ä¹ˆ</b>ã€‚</li></ul><blockquote><p>Dockeræ˜¯ä¸€ä¸ªå¿«é€Ÿäº¤ä»˜åº”ç”¨ã€è¿è¡Œåº”ç”¨çš„æŠ€æœ¯ï¼Œå…·å¤‡ä¸‹åˆ—ä¼˜åŠ¿ï¼š</p><ul><li>å¯ä»¥<b style="color:#01b4bc">å°†ç¨‹åºåŠå…¶ä¾èµ–ã€è¿è¡Œç¯å¢ƒä¸€èµ·æ‰“åŒ…ä¸ºä¸€ä¸ªé•œåƒï¼Œå¯ä»¥è¿ç§»åˆ°ä»»æ„Linuxæ“ä½œç³»ç»Ÿ</b></li><li>è¿è¡Œæ—¶<b style="color:#01b4bc">åˆ©ç”¨æ²™ç®±æœºåˆ¶å½¢æˆéš”ç¦»å®¹å™¨</b>ï¼Œå„ä¸ªåº”ç”¨<b style="color:#01b4bc">äº’ä¸å¹²æ‰°</b></li><li>å¯åŠ¨ã€ç§»é™¤éƒ½å¯ä»¥é€šè¿‡ä¸€è¡Œå‘½ä»¤å®Œæˆï¼Œæ–¹ä¾¿å¿«æ·</li></ul></blockquote><blockquote><p>Dockerå’Œè™šæ‹Ÿæœºçš„å·®å¼‚ï¼š</p><ul><li>dockeræ˜¯ä¸€ä¸ªç³»ç»Ÿè¿›ç¨‹ï¼›è™šæ‹Ÿæœºæ˜¯åœ¨æ“ä½œç³»ç»Ÿä¸­çš„æ“ä½œç³»ç»Ÿ</li><li>dockerä½“ç§¯å°ã€å¯åŠ¨é€Ÿåº¦å¿«ã€æ€§èƒ½å¥½ï¼›è™šæ‹Ÿæœºä½“ç§¯å¤§ã€å¯åŠ¨é€Ÿåº¦æ…¢ã€æ€§èƒ½ä¸€èˆ¬</li></ul></blockquote><h2 id="1-4-Docker-æ¶æ„">1.4 Docker æ¶æ„</h2><p>Dockeræ˜¯ä¸€ä¸ªCSæ¶æ„çš„ç¨‹åºï¼Œç”±ä¸¤éƒ¨åˆ†ç»„æˆï¼š</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cos.halfsummer.xyz/pictures/niubb/2023/20230313-640f3c13edfdc.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><ul><li>æœåŠ¡ç«¯(server)ï¼šDockerå®ˆæŠ¤è¿›ç¨‹ï¼Œè´Ÿè´£å¤„ç†DockeræŒ‡ä»¤ï¼Œç®¡ç†é•œåƒã€å®¹å™¨ç­‰</li><li>å®¢æˆ·ç«¯(client)ï¼šé€šè¿‡å‘½ä»¤æˆ–RestAPIå‘DockeræœåŠ¡ç«¯å‘é€æŒ‡ä»¤ã€‚å¯ä»¥åœ¨æœ¬åœ°æˆ–è¿œç¨‹å‘æœåŠ¡ç«¯å‘é€æŒ‡ä»¤ã€‚</li></ul><h2 id="1-5-Docker-å¼•æ“">1.5 Docker å¼•æ“</h2><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cos.halfsummer.xyz/pictures/niubb/2023/20230313-640f3c13c4845.png" alt="image-20230106114851591"></p><h2 id="1-6-Docker-å¹³å°ç»„æˆ">1.6 Docker å¹³å°ç»„æˆ</h2><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cos.halfsummer.xyz/pictures/niubb/2023/20230313-640f3c10526cd.png" alt="image-20230106115104206"></p><h2 id="1-7-é•œåƒ-å®¹å™¨">1.7 é•œåƒ&amp;å®¹å™¨</h2><p><strong>é•œåƒï¼ˆImageï¼‰</strong>ï¼šDockerå°†åº”ç”¨ç¨‹åºåŠå…¶æ‰€éœ€çš„ä¾èµ–ã€å‡½æ•°åº“ã€ç¯å¢ƒã€é…ç½®ç­‰æ–‡ä»¶æ‰“åŒ…åœ¨ä¸€èµ·ï¼Œç§°ä¸ºé•œåƒã€‚</p><p><strong>å®¹å™¨ï¼ˆContainerï¼‰</strong>ï¼šé•œåƒä¸­çš„åº”ç”¨ç¨‹åºè¿è¡Œåå½¢æˆçš„è¿›ç¨‹å°±æ˜¯<strong>å®¹å™¨</strong>ï¼Œåªæ˜¯Dockerä¼šç»™å®¹å™¨è¿›ç¨‹åšéš”ç¦»ï¼Œå¯¹å¤–ä¸å¯è§ã€‚</p><blockquote><p><strong>é•œåƒ</strong>å°±æ˜¯æŠŠä¸€ä¸ªåº”ç”¨åœ¨ç¡¬ç›˜ä¸Šçš„æ–‡ä»¶ã€åŠå…¶è¿è¡Œç¯å¢ƒã€éƒ¨åˆ†ç³»ç»Ÿå‡½æ•°åº“æ–‡ä»¶ä¸€èµ·æ‰“åŒ…å½¢æˆçš„æ–‡ä»¶åŒ…ã€‚è¿™ä¸ªæ–‡ä»¶åŒ…æ˜¯åªè¯»çš„ã€‚</p><p><strong>å®¹å™¨</strong>å°±æ˜¯å°†è¿™äº›æ–‡ä»¶ä¸­ç¼–å†™çš„ç¨‹åºã€å‡½æ•°åŠ è½½åˆ°å†…å­˜ä¸­å…è®¸ï¼Œå½¢æˆè¿›ç¨‹ï¼Œåªä¸è¿‡è¦éš”ç¦»èµ·æ¥ã€‚å› æ­¤ä¸€ä¸ªé•œåƒå¯ä»¥å¯åŠ¨å¤šæ¬¡ï¼Œå½¢æˆå¤šä¸ªå®¹å™¨è¿›ç¨‹ã€‚</p></blockquote><h2 id="1-8-Docker-ç”Ÿå‘½å‘¨æœŸ">1.8 Docker ç”Ÿå‘½å‘¨æœŸ</h2><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cos.halfsummer.xyz/pictures/niubb/2023/20230313-640f3c10de085.png" alt="image-20230106201947897"></p><h2 id="1-9-Docker-é•œåƒåŸç†ç†è§£">1.9 Docker é•œåƒåŸç†ç†è§£</h2><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cos.halfsummer.xyz/pictures/niubb/2023/20230313-640f3c1088a88.png" alt="image-20230106214026388"></p><h1 id="2ï¼‰Docker-å®‰è£…">2ï¼‰Docker å®‰è£…</h1><h2 id="2-1-Docker-ç‰ˆæœ¬è¯´æ˜">2.1 Docker ç‰ˆæœ¬è¯´æ˜</h2><ul><li><a target="_blank" rel="noopener" href="https://hub.docker.com/">DockerHub</a>ï¼šDockerHubæ˜¯ä¸€ä¸ªå®˜æ–¹çš„Dockeré•œåƒçš„æ‰˜ç®¡å¹³å°ã€‚è¿™æ ·çš„å¹³å°ç§°ä¸ºDocker Registryã€‚</li><li>å›½å†…ä¹Ÿæœ‰ç±»ä¼¼äºDockerHub çš„å…¬å¼€æœåŠ¡ï¼Œæ¯”å¦‚ ç½‘æ˜“äº‘é•œåƒæœåŠ¡ã€é˜¿é‡Œäº‘é•œåƒåº“ç­‰ã€‚</li></ul><p>Docker åˆ†ä¸º CE å’Œ EE ä¸¤å¤§ç‰ˆæœ¬ã€‚CE å³ç¤¾åŒºç‰ˆï¼ˆå…è´¹ï¼Œæ”¯æŒå‘¨æœŸ 7 ä¸ªæœˆï¼‰ï¼ŒEE å³ä¼ä¸šç‰ˆï¼Œå¼ºè°ƒå®‰å…¨ï¼Œä»˜è´¹ä½¿ç”¨ï¼Œæ”¯æŒå‘¨æœŸ 24 ä¸ªæœˆã€‚</p><p>Docker CE åˆ†ä¸º <code>stable</code> <code>test</code> å’Œ <code>nightly</code> ä¸‰ä¸ªæ›´æ–°é¢‘é“ã€‚</p><blockquote><p>Docker CE æ”¯æŒ 64 ä½ç‰ˆæœ¬ CentOS 7ï¼Œå¹¶ä¸”è¦æ±‚å†…æ ¸ç‰ˆæœ¬ä¸ä½äº 3.10ï¼Œ CentOS 7 æ»¡è¶³æœ€ä½å†…æ ¸çš„è¦æ±‚ï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨CentOS 7å®‰è£…Dockerã€‚</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æŸ¥è¯¢å†…æ ¸ç‰ˆæœ¬</span></span><br><span class="line">cat /etc/redhat-release</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æŸ¥è¯¢æ“ä½œç³»ç»Ÿçš„å‘å‹ç‰ˆå·</span></span><br><span class="line">uname -r</span><br></pre></td></tr></table></figure><h2 id="2-2-å¸è½½">2.2 å¸è½½</h2><p>å¦‚æœä¹‹å‰å®‰è£…è¿‡æ—§ç‰ˆæœ¬çš„Dockerï¼Œå¯ä»¥ä½¿ç”¨ä¸‹é¢å‘½ä»¤å¸è½½ï¼š(<code>'\'</code>è¡¨ç¤ºæœ¬è¡Œå‘½ä»¤æœªç»“æŸï¼Œä¸‹ä¸€è¡Œç»§ç»­ï¼Œ<code>'\'</code>å‰è®°å¾—æœ‰ä¸€ä¸ªç©ºæ ¼)</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">yum remove docker \</span><br><span class="line">                  docker-client \</span><br><span class="line">                  docker-client-latest \</span><br><span class="line">                  docker-common \</span><br><span class="line">                  docker-latest \</span><br><span class="line">                  docker-latest-logrotate \</span><br><span class="line">                  docker-logrotate \</span><br><span class="line">                  docker-selinux \</span><br><span class="line">                  docker-engine-selinux \</span><br><span class="line">                  docker-engine \</span><br><span class="line">                  docker-ce</span><br></pre></td></tr></table></figure><h2 id="2-3-å®‰è£…">2.3 å®‰è£…</h2><p>ğŸ“Œ <strong>åŸºç¡€ç¯å¢ƒé…ç½®</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">wget -O /etc/yum.repos.d/Centos-base.repo http://mirrors.aliyun.com/repo/Centos-7.repo</span><br><span class="line">wget -O /etc/yum.repos.d/epel.repo http://mirrors.aliyun.com/repo/epel-7.repo</span><br><span class="line"></span><br><span class="line">yum clean all</span><br><span class="line">yum makecache</span><br></pre></td></tr></table></figure><p>å¼€å¯linuxå†…æ ¸çš„æµé‡è½¬å‘ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">cat &lt;&lt;EOF &gt; /etc/sysctl.d/docker.conf</span><br><span class="line">net.bridge.bridge-nf-call-ip6tables = 1</span><br><span class="line">net.bridge.bridge-nf-call-iptables = 1</span><br><span class="line">net.ipv4.conf.default.rp_filter = 0</span><br><span class="line">net.ipv4.conf.all.rp_filter = 0</span><br><span class="line">net.ipv4.ip_forward=1</span><br><span class="line">EOF</span><br></pre></td></tr></table></figure><p>é‡æ–°åŠ è½½ä¿®æ”¹å†…æ ¸å‚æ•°çš„é…ç½®æ–‡ä»¶ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sysctl -p /etc/sysctl.d/docker.conf</span><br></pre></td></tr></table></figure><blockquote><p>ğŸ”´ å¦‚æœæŠ¥é”™ï¼š</p><blockquote><p>No such file or directory<br>sysctl: cannot stat /proc/sys/net/bridge/bridge-nf-call-ip6tables: No such file or directory<br>sysctl: cannot stat /proc/sys/net/bridge/beidge-nf-call-iptables: No such file or directory<br>net.ipv4.conf.default.rp_filter = 0<br>net.ipv4.conf.all.rp_filter = 0<br>net.ipv4.ip_forward = 1</p></blockquote><p>å°±æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼šï¼ˆå‘å†…æ ¸ä¸­åŠ è½½æ¨¡å—ï¼‰</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">modprobe br_netfilter</span><br></pre></td></tr></table></figure><p>ç„¶åå†é‡æ–°æ‰§è¡Œï¼š</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sysctl -p /etc/sysctl.d/docker.conf</span><br></pre></td></tr></table></figure></blockquote><p>ğŸ“Œ <strong>yumå®‰è£…</strong></p><ul><li><p><strong>æ–¹æ³•1</strong>ï¼š</p><p>é¦–å…ˆéœ€è¦å°†è™šæ‹Ÿæœºè”ç½‘ï¼Œå®‰è£…yumå·¥å…·ã€å­˜å‚¨é©±åŠ¨ã€é€»è¾‘å·ç®¡ç†ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">yum install -y yum-utils \</span><br><span class="line">           device-mapper-persistent-data \</span><br><span class="line">           lvm2 --skip-broken</span><br></pre></td></tr></table></figure><p>æ›´æ–°æœ¬åœ°é•œåƒæºï¼š(<code>yum-config-manager</code> å‘½ä»¤çš„æœ¬è´¨æ˜¯å¯¹ <code>/etc/yum.repos.d/</code>(åº“æ•°æ®çš„å‚¨å­˜ä½ç½®)æ–‡ä»¶å¤¹ä¸‹æ–‡ä»¶çš„å¢åˆ æŸ¥æ”¹ã€‚)</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">yum-config-manager \</span><br><span class="line">    --add-repo \</span><br><span class="line">    https://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo</span><br><span class="line">    </span><br><span class="line">sed -i &#x27;s/download.docker.com/mirrors.aliyun.com\/docker-ce/g&#x27; /etc/yum.repos.d/docker-ce.repo</span><br><span class="line"></span><br><span class="line">yum makecache fast</span><br><span class="line"></span><br><span class="line">yum -y install docker-ce</span><br></pre></td></tr></table></figure></li><li><p><strong>æ–¹æ³•2</strong>ï¼š</p><p>æŸ¥çœ‹æºä¸­å¯ç”¨ç‰ˆæœ¬ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum list docker-ce --showduplicates | sort -r</span><br></pre></td></tr></table></figure><p>å¦‚æœæ²¡æœ‰åŒ¹é…é¡¹ï¼Œåˆ™ä¸‹è½½é˜¿é‡Œæºrepoæ–‡ä»¶ ç¬¬ä¸€ä¸ªæ˜¯é˜¿é‡Œäº‘è‡ªå¸¦ä»“åº“ ç¬¬äºŒä¸ªæ˜¯é˜¿é‡Œäº‘æä¾›çš„dockerä¸“å±repoä»“åº“</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">curl -o /etc/yum.repos.d/CentOS-7.repo http://mirrors.aliyun.com/repo/Centos-7.repo</span><br><span class="line"></span><br><span class="line">curl -o /etc/yum.repos.d/docker-ce.repo http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo</span><br></pre></td></tr></table></figure><p>æ›´æ–°yumç¼“å­˜:</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum clean all &amp;&amp; yum makecache</span><br></pre></td></tr></table></figure><p>å®‰è£…ä¸å¸è½½:</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">yum install -y docker-ce-xxx </span><br><span class="line"></span><br><span class="line">yum remove -y docker-xxx</span><br></pre></td></tr></table></figure></li></ul><h2 id="2-4-é…ç½®é•œåƒåŠ é€Ÿå™¨">2.4 é…ç½®é•œåƒåŠ é€Ÿå™¨</h2><p>Dockerçš„é•œåƒé»˜è®¤æ˜¯ä»Docker hubä¸‹è½½ï¼Œç½‘é€Ÿå¾ˆæ…¢ï¼Œå›½å†…æœ‰å¾ˆå¤šäº‘æœåŠ¡å•†éƒ½æä¾›äº†åŠ é€Ÿå™¨æœåŠ¡ï¼ˆé˜¿é‡Œäº‘åŠ é€Ÿå™¨ï¼ŒDaocloudåŠ é€Ÿå™¨ï¼Œçµé›€äº‘åŠ é€Ÿå™¨ç­‰ï¼‰</p><p>æ³¨æ„ï¼šæ­¤å¤„dockerç‰ˆæœ¬ä¸åŒdaemonæ–‡ä»¶çš„åç¼€ä¸åŒï¼Œæ–°ç‰ˆåç¼€ä¸º.confï¼Œæ—§ç‰ˆçš„å¯èƒ½ä¸º.jsonã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">[root@VM-4-9-centos ~]# mkdir -p /etc/docker</span><br><span class="line">[root@VM-4-9-centos ~]#</span><br><span class="line">[root@VM-4-9-centos ~]# touch /etc/docker/daemon.conf</span><br><span class="line">[root@VM-4-9-centos ~]#</span><br><span class="line">[root@VM-4-9-centos ~]# vim /etc/docker/daemon.conf</span><br><span class="line">[root@VM-4-9-centos ~]# cat /etc/docker/daemon.conf</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">ã€€ã€€&quot;registry-mirrors&quot;:[</span><br><span class="line">ã€€ã€€ã€€ã€€&quot;https://8xpk5wnt.mirror.aliyun.com&quot;</span><br><span class="line">ã€€ã€€]</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">æˆ–è€…ï¼š</span></span><br><span class="line">&#123;</span><br><span class="line">  &quot;registry-mirrors&quot;: [&quot;http://hub-mirror.c.163.com&quot;]</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">æˆ–è€…</span></span><br><span class="line">&#123;</span><br><span class="line">  &quot;registry-mirrors&quot;: [&quot;https://hub.daocloud.io&quot;]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="2-5-å¯åŠ¨">2.5 å¯åŠ¨</h2><p>å…³é—­é˜²ç«å¢™</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">å…³é—­</span></span><br><span class="line">systemctl stop firewalld</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">ç¦æ­¢å¼€æœºå¯åŠ¨é˜²ç«å¢™</span></span><br><span class="line">systemctl disable firewalld</span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">é‡è½½é…ç½®æ–‡ä»¶</span></span><br><span class="line">systemctl daemon-reload</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æ·»åŠ å¼€æœºå¯åŠ¨</span></span><br><span class="line">systemctl enable docker</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">å¯åŠ¨æœåŠ¡</span></span><br><span class="line">systemctl start docker</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">é‡æ–°å¯åŠ¨æœåŠ¡</span></span><br><span class="line">systemctl restart docker</span><br></pre></td></tr></table></figure><h2 id="2-6-æµ‹è¯•">2.6 æµ‹è¯•</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># docker run hello-world</span></span><br><span class="line">Unable to find image <span class="string">&#x27;hello-world:latest&#x27;</span> locally</span><br><span class="line">latest: Pulling from library/hello-world</span><br><span class="line">2db29710123e: Pull complete </span><br><span class="line">Digest: sha256:6e8b6f026e0b9c419ea0fd02d3905dd0952ad1feea67543f525c73a0a790fefb</span><br><span class="line">Status: Downloaded newer image <span class="keyword">for</span> hello-world:latest</span><br><span class="line"></span><br><span class="line">Hello from Docker!</span><br><span class="line">This message shows that your installation appears to be working correctly.</span><br><span class="line">...çœç•¥éƒ¨åˆ†æ•°æ®...</span><br></pre></td></tr></table></figure><hr><h1 id="3ï¼‰é•œåƒç®¡ç†å‘½ä»¤">3ï¼‰é•œåƒç®¡ç†å‘½ä»¤</h1><p>ä½¿ç”¨é•œåƒçš„æµç¨‹ï¼š</p><ol><li>è·å–è¯¥è½¯ä»¶çš„dockeré•œåƒã€‚</li><li>è¿è¡Œè¯¥é•œåƒï¼Œå°±å¯åŠ¨äº†ä¸€ä¸ªå®¹å™¨ã€‚</li><li>åœæ­¢å®¹å™¨ï¼Œåˆ é™¤è¯¥é•œåƒã€‚</li></ol><h2 id="8-1-æœç´¢é•œåƒæ˜¯å¦å­˜åœ¨äºé•œåƒåº“">8.1 æœç´¢é•œåƒæ˜¯å¦å­˜åœ¨äºé•œåƒåº“</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# docker search é•œåƒå:tag	# tagå°±æ˜¯å…·ä½“çš„æ ‡ç­¾ç‰ˆæœ¬</span><br></pre></td></tr></table></figure><h2 id="8-2-æŸ¥çœ‹é•œåƒ">8.2 æŸ¥çœ‹é•œåƒ</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æŸ¥çœ‹å½“å‰æ‰€æœ‰é•œåƒ</span></span><br><span class="line">[root@localhost ~]# docker images</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æˆ–è€…</span></span><br><span class="line">[root@localhost ~]# docker image ls</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æŸ¥çœ‹æŸä¸ªé•œåƒè¯¦ç»†ä¿¡æ¯</span></span><br><span class="line">[root@localhost ~]# docker images é•œåƒå</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">åªæ˜¾ç¤ºé•œåƒ<span class="built_in">id</span> --quiet</span></span><br><span class="line">[root@localhost ~]# docker images -q</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æ ¼å¼åŒ–æ˜¾ç¤ºé•œåƒåªæå–å‡ºéœ€è¦çš„ä¿¡æ¯</span></span><br><span class="line">[root@localhost ~]# docker images --format &quot;&#123;&#123;.ID&#125;&#125;--&#123;&#123;.Repository&#125;&#125;&quot;</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æ ¼å¼åŒ–æˆè¡¨æ ¼ æ˜¾ç¤ºé•œåƒåªæå–å‡ºéœ€è¦çš„ä¿¡æ¯</span></span><br><span class="line">[root@localhost ~]# docker images --format &quot;table &#123;&#123;.ID&#125;&#125;\t&#123;&#123;.Repository&#125;&#125;&quot;</span><br></pre></td></tr></table></figure><h2 id="8-2-é•œåƒæ‹‰å–">8.2 é•œåƒæ‹‰å–</h2><p>è·å–é•œåƒï¼Œé•œåƒæ‰˜ç®¡ä»“åº“ï¼Œå¥½æ¯”yumæºä¸€æ ·ã€‚ï¼ˆdockeré»˜è®¤ä»“åº“æ˜¯dockerhubï¼‰</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# docker pull é•œåƒå:tag	# tag | latest</span><br></pre></td></tr></table></figure><h2 id="8-3-æŸ¥çœ‹-Docker-çš„æœåŠ¡ä¿¡æ¯">8.3 æŸ¥çœ‹ Docker çš„æœåŠ¡ä¿¡æ¯</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# docker info</span><br><span class="line"></span><br><span class="line">[root@localhost ~]# docker info | grep Root</span><br><span class="line"> Docker Root Dir: /var/lib/docker</span><br></pre></td></tr></table></figure><p>é•œåƒå­˜æ”¾åœ¨ï¼š<code>ll /var/lib/docker/image/overlay2/imagedb/content/sha256/</code></p><p>é•œåƒæ–‡ä»¶å…¶å®æ˜¯ä¸€ä¸ªjsonæ•°æ®ç±»å‹çš„æ–‡ä»¶ï¼Œè®°å½• é•œåƒå’Œå®¹å™¨çš„é…ç½®å…³ç³»</p><h2 id="8-4-åˆ é™¤é•œåƒ">8.4 åˆ é™¤é•œåƒ</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# docker rmi é•œåƒå(æˆ– ID æˆ– IDå‰ä¸‰ä½)</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æ‰¹é‡åˆ é™¤</span> </span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">docker images -aqæ˜¯åˆ—å‡ºæ‰€æœ‰çš„é•œåƒ ç”¨åå¼•å·â€˜`â€™æ¡†æŸ±è¡¨ç¤ºå–å‡ºå‘½ä»¤çš„ç»“æœ</span></span><br><span class="line">[root@localhost ~]# docker rmi `docker images -aq`</span><br></pre></td></tr></table></figure><h2 id="8-5-å¯¼å‡ºé•œåƒ">8.5 å¯¼å‡ºé•œåƒ</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# docker image save é•œåƒå[:tag] &gt; /é‡å®šå‘çš„ä½ç½®/é•œåƒå.tgz</span><br></pre></td></tr></table></figure><h2 id="8-6-å¯¼å…¥é•œåƒ">8.6 å¯¼å…¥é•œåƒ</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# docker image load -i /ä½ç½®/é•œåƒå.tgz</span><br></pre></td></tr></table></figure><h2 id="8-7-æŸ¥çœ‹-Docker-é•œåƒä¿¡æ¯">8.7 æŸ¥çœ‹ Docker é•œåƒä¿¡æ¯</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker image inspect é•œåƒid</span><br></pre></td></tr></table></figure><hr><h1 id="4ï¼‰å®¹å™¨ç®¡ç†å‘½ä»¤">4ï¼‰å®¹å™¨ç®¡ç†å‘½ä»¤</h1><h2 id="9-1-è¿è¡Œã€åˆ›å»ºå®¹å™¨">9.1 è¿è¡Œã€åˆ›å»ºå®¹å™¨</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">å¦‚æœé•œåƒä¸å­˜åœ¨æœ¬åœ°ï¼Œåˆ™å›å»ä¸‹è½½è¯¥é•œåƒ</span></span><br><span class="line">docker run é•œåƒå</span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">ä¸°å¯Œdockerè¿è¡Œçš„å‚æ•°</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">-d åå°è¿è¡Œ</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">--<span class="built_in">rm</span> å®¹å™¨æŒ‚æ‰åè¢«åˆ é™¤</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">--name niubb ç»™å®¹å™¨å‘½åniubb</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">ping æ˜¯åé¢å®¹å™¨æ‰§è¡Œçš„æŒ‡ä»¤</span></span><br><span class="line"></span><br><span class="line">[root@localhost ~]# docker run -d --rm --name niubb centos:7.6.1810 ping baidu.com</span><br><span class="line">5579d43af5173d37d575cbb497573ec5b7db6e0daeed70730115e0eb6db34ad7</span><br><span class="line">[root@localhost ~]# docker ps</span><br><span class="line">CONTAINER ID   IMAGE             COMMAND            CREATED          STATUS          PORTS     NAMES</span><br><span class="line">5579d43af517   centos:7.6.1810   &quot;ping baidu.com&quot;   12 seconds ago   Up 11 seconds             niubb</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">ä½¿ç”¨--<span class="built_in">rm</span>åï¼Œå®¹å™¨æŒ‚æ‰ååˆ é™¤äº†çŠ¶æ€è®°å½•</span></span><br><span class="line">[root@localhost ~]# docker ps -a</span><br><span class="line">CONTAINER ID   IMAGE          COMMAND                  CREATED          STATUS                      PORTS     NAMES</span><br><span class="line">52e5ccb0d743   centos         &quot;/bin/bash&quot;              11 minutes ago   Exited (0) 11 minutes ago             heuristic_rosalind</span><br><span class="line">6684befd9bfa   f1cb7c7d58b7   &quot;bash&quot;                   2 hours ago      Exited (130) 2 hours ago              agitated_bartik</span><br><span class="line">3bbc199beb84   f1cb7c7d58b7   &quot;bash&quot;                   3 hours ago      Exited (127) 2 hours ago              tender_shtern</span><br><span class="line">2f2c4da21e01   5d0da3dc9764   &quot;bash&quot;                   3 hours ago      Exited (0) 3 hours ago                agitated_buck</span><br><span class="line">e2c3e6042ba3   nginx          &quot;/docker-entrypoint.â€¦&quot;   4 hours ago      Exited (0) 10 minutes ago             busy_lewin</span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">-v å®¿ä¸»æœºè·¯å¾„:å®¹å™¨å†…è·¯å¾„</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">:rw ä¸ºå¯è¯»å†™å¯çœç•¥</span> </span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">:ro åœ¨å®¹å™¨å†…åªè¯»ï¼Œå¦‚æœå†™å…¥ä¼šæŠ¥é”™</span></span><br><span class="line">[root@localhost ~]# docker run -d -v /opt:/tep/centos7.6 centos:7.6.1810</span><br><span class="line">[root@localhost ~]# docker run -d -v /opt:/tep/centos7.6:rw centos:7.6.1810</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">é»˜è®¤æƒ…å†µä¸‹ï¼Œä»“åº“è¢«åˆ›å»ºåœ¨/var/lib/registryç›®å½•ä¸‹</span></span><br></pre></td></tr></table></figure><p><span style="color:red;background:#ff0">â€»æ³¨æ„ï¼š</span></p><ol><li><p><span style="color:red">å®¹å™¨å†…çš„ç¨‹åºå¿…é¡»å¤„äºå‰å°è¿è¡ŒçŠ¶æ€ï¼Œå¦åˆ™å®¹å™¨å°±ä¼šç›´æ¥é€€å‡ºã€‚</span></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# docker run centos</span><br><span class="line">[root@localhost ~]# docker ps</span><br><span class="line">CONTAINER ID   IMAGE     COMMAND                  CREATED       STATUS       PORTS                NAMES</span><br></pre></td></tr></table></figure></li><li><p>å¦‚æœå®¹å™¨å†…ï¼Œä»€ä¹ˆäº‹æƒ…ä¹Ÿä¸åšï¼Œå®¹å™¨ä¹Ÿä¼šæŒ‚æ‰ã€‚å®¹å™¨å†…å¿…é¡»æœ‰ä¸€ä¸ªè¿›ç¨‹åœ¨å‰å°è¿è¡Œã€‚</p></li></ol><h2 id="9-2-å¯åŠ¨ã€åœæ­¢ã€é‡å¯å®¹å™¨">9.2 å¯åŠ¨ã€åœæ­¢ã€é‡å¯å®¹å™¨</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">docker start å®¹å™¨id/åå­—</span><br><span class="line">docker stop å®¹å™¨id/åå­—</span><br><span class="line">docker restart å®¹å™¨id/åå­—</span><br></pre></td></tr></table></figure><h2 id="9-3-æŸ¥çœ‹å®¹å™¨ã€å®¹å™¨æ—¥å¿—ã€å®¹å™¨çš„è¯¦ç»†ä¿¡æ¯">9.3 æŸ¥çœ‹å®¹å™¨ã€å®¹å™¨æ—¥å¿—ã€å®¹å™¨çš„è¯¦ç»†ä¿¡æ¯</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æŸ¥çœ‹å®¹å™¨</span></span><br><span class="line">[root@localhost ~]# docker ps</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æŸ¥çœ‹æ‰€æœ‰å®¹å™¨çŠ¶æ€</span></span><br><span class="line">[root@localhost ~]# docker ps -a</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æŸ¥çœ‹å®¹å™¨æ—¥å¿—</span></span><br><span class="line">[root@localhost ~]# docker logs å®¹å™¨id</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">å®æ—¶åˆ·æ–°å®¹å™¨æ—¥å¿—</span></span><br><span class="line">[root@localhost ~]# docker logs -f å®¹å™¨id</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">å®¹å™¨çš„è¯¦ç»†ä¿¡æ¯</span></span><br><span class="line">[root@localhost ~]# docker container inspect å®¹å™¨id</span><br></pre></td></tr></table></figure><h2 id="9-4-åˆ é™¤å®¹å™¨">9.4 åˆ é™¤å®¹å™¨</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">1. åˆ é™¤æŒ‡å®šå®¹å™¨</span></span><br><span class="line">[root@localhost ~]# docker rm -f &lt;containerid&gt;</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">2. åˆ é™¤æœªå¯åŠ¨æˆåŠŸçš„å®¹å™¨</span></span><br><span class="line">[root@localhost ~]# docker rm $(docker ps -a|grep Created|awk &#x27;&#123;print $1&#125;&#x27;)</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æˆ–è€…</span></span><br><span class="line">[root@localhost ~]# docker rm $(docker ps -qf status=created)</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">3. åˆ é™¤é€€å‡ºçŠ¶æ€çš„å®¹å™¨</span></span><br><span class="line">[root@localhost ~]# docker rm $(docker ps -a|grep Exited|awk &#x27;&#123;print $1&#125;&#x27;)</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æˆ–è€…</span></span><br><span class="line">[root@localhost ~]# docker rm $(docker ps -qf status=exited)</span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">[root@docker_test ~]# docker ps -a</span><br><span class="line">CONTAINER ID   IMAGE     COMMAND                  CREATED             STATUS                           PORTS                               NAMES</span><br><span class="line">d13ef6c6cb8e   nginx     &quot;/docker-entrypoint.â€¦&quot;   6 minutes ago       Up 6 minutes                     0.0.0.0:80-&gt;80/tcp, :::80-&gt;80/tcp   nginx1</span><br><span class="line">e30bfa566607   docker    &quot;docker-entrypoint.sâ€¦&quot;   51 minutes ago      Exited (125) 13 minutes ago                                          peaceful_black</span><br><span class="line">886aa44c834e   docker    &quot;docker-entrypoint.sâ€¦&quot;   57 minutes ago      Exited (0) 55 minutes ago                                            festive_wing</span><br><span class="line">4d8d27bc3d78   nginx     &quot;/docker-entrypoint.â€¦&quot;   About an hour ago   Exited (0) 58 minutes ago                                            reverent_engelbart</span><br><span class="line">74026fa35fbe   nginx     &quot;/docker-entrypoint.â€¦&quot;   About an hour ago   Exited (0) About an hour ago                                         jovial_galois</span><br><span class="line">64d0278cd793   nginx     &quot;/docker-entrypoint.â€¦&quot;   About an hour ago   Exited (127) About an hour ago                                       practical_archimedes</span><br><span class="line">[root@docker_test ~]# docker rm $(docker ps -a|grep Exited|awk &#x27;&#123;print $1&#125;&#x27;)</span><br><span class="line">e30bfa566607</span><br><span class="line">886aa44c834e</span><br><span class="line">4d8d27bc3d78</span><br><span class="line">74026fa35fbe</span><br><span class="line">64d0278cd793</span><br><span class="line">[root@docker_test ~]# docker ps -a</span><br><span class="line">CONTAINER ID   IMAGE     COMMAND                  CREATED          STATUS          PORTS                               NAMES</span><br><span class="line">d13ef6c6cb8e   nginx     &quot;/docker-entrypoint.â€¦&quot;   28 minutes ago   Up 28 minutes   0.0.0.0:80-&gt;80/tcp, :::80-&gt;80/tcp   nginx1</span><br></pre></td></tr></table></figure><h2 id="9-5-è¿›å…¥å®¹å™¨å†…">9.5 è¿›å…¥å®¹å™¨å†…</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">-it äº¤äº’æ“ä½œ</span></span><br><span class="line">[root@localhost ~]# docker exec -it å®¹å™¨id bash</span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# docker ps</span><br><span class="line">CONTAINER ID   IMAGE     COMMAND                  CREATED         STATUS         PORTS     NAMES</span><br><span class="line">aa7cb64f6428   nginx     &quot;/docker-entrypoint.â€¦&quot;   6 seconds ago   Up 5 seconds   80/tcp    sleepy_faraday</span><br><span class="line">[root@localhost ~]# docker exec -it aa7cb64f6428 bash</span><br><span class="line">root@aa7cb64f6428:/# </span><br></pre></td></tr></table></figure><h2 id="9-6-å®¹å™¨çš„ç«¯å£æ˜ å°„">9.6 å®¹å™¨çš„ç«¯å£æ˜ å°„</h2><p>å®¿ä¸»æœºçš„ç«¯å£èŒƒå›´ï¼š0~65535</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">-p ç«¯å£æ˜ å°„ï¼šå®¿ä¸»æœºç«¯å£:å®¹å™¨ç«¯å£</span></span><br><span class="line">[root@localhost ~]# docker run -d -p ç«¯å£å·:ç«¯å£å· é•œåƒå</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">-P éšæœºç«¯å£æ˜ å°„</span></span><br><span class="line">[root@localhost ~]# docker run -d -P é•œåƒå</span><br></pre></td></tr></table></figure><h2 id="9-7-æŸ¥çœ‹å®¹å™¨çš„ç«¯å£æ˜ å°„">9.7 æŸ¥çœ‹å®¹å™¨çš„ç«¯å£æ˜ å°„</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# docker port å®¹å™¨id</span><br></pre></td></tr></table></figure><h2 id="9-8-æ›´æ–°å®¹å™¨å‚æ•°">9.8 æ›´æ–°å®¹å™¨å‚æ•°</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# docker update [é€‰é¡¹] å®¹å™¨id</span><br></pre></td></tr></table></figure><table><thead><tr><th style="text-align:left">åç§°</th><th style="text-align:left">æè¿°</th></tr></thead><tbody><tr><td style="text-align:left"><code>--blkio-weight</code></td><td style="text-align:left">é˜»å¡IO (ç›¸å¯¹æƒé‡)ï¼Œä»‹äº10åˆ°1000ä¹‹é—´ï¼Œ0è¡¨ç¤ºç¦ç”¨ï¼ˆé»˜è®¤ç¦æ­¢ï¼‰</td></tr><tr><td style="text-align:left"><code>--cpu-period</code></td><td style="text-align:left">é™åˆ¶CPU CFSï¼ˆå®Œå…¨å…¬å¹³çš„è°ƒåº¦ç¨‹åºï¼‰æœŸé™</td></tr><tr><td style="text-align:left"><code>--cpu-quota</code></td><td style="text-align:left">é™åˆ¶CPU CFSï¼ˆå®Œå…¨å…¬å¹³çš„è°ƒåº¦ç¨‹åºï¼‰é…é¢</td></tr><tr><td style="text-align:left"><code>--cpu-rt-period</code></td><td style="text-align:left"><code>API 1.25+</code>ï¼Œå°†CPUå®æ—¶æ—¶é—´é™åˆ¶ä¸ºå¾®ç§’</td></tr><tr><td style="text-align:left"><code>--cpu-rt-runtime</code></td><td style="text-align:left"><code>API 1.25+</code>ï¼Œå°†CPUå®æ—¶è¿è¡Œæ—¶é—´é™åˆ¶ä¸ºå¾®ç§’</td></tr><tr><td style="text-align:left"><code>--cpu-shares</code>, <code>-c</code></td><td style="text-align:left">CPUä»½é¢ï¼ˆç›¸å¯¹æƒé‡ï¼‰</td></tr><tr><td style="text-align:left"><code>--cpus</code></td><td style="text-align:left"><code>API 1.29+</code>ï¼ŒCPUæ•°é‡</td></tr><tr><td style="text-align:left"><code>--cpuset-cpus</code></td><td style="text-align:left">å…è®¸æ‰§è¡Œçš„CPUï¼ˆ0-3ï¼Œ0,1ï¼‰</td></tr><tr><td style="text-align:left"><code>--cpuset-mem</code></td><td style="text-align:left">å…è®¸æ‰§è¡Œçš„MEMï¼ˆ0-3ï¼Œ0,1ï¼‰</td></tr><tr><td style="text-align:left"><code>--kernel-memory</code></td><td style="text-align:left">å†…æ ¸å†…å­˜é™åˆ¶</td></tr><tr><td style="text-align:left"><code>--memory-swap</code></td><td style="text-align:left">äº¤æ¢é™åˆ¶ç­‰äºå†…å­˜åŠ äº¤æ¢ï¼Œâ€œ-1â€ä»¥å¯ç”¨æ— é™äº¤æ¢</td></tr><tr><td style="text-align:left"><code>--memory-reservatio</code></td><td style="text-align:left">å†…å­˜è½¯é™åˆ¶</td></tr><tr><td style="text-align:left"><code>--memory</code>, <code>-m</code></td><td style="text-align:left">å†…å­˜é™åˆ¶</td></tr><tr><td style="text-align:left"><code>--pids-limit</code></td><td style="text-align:left"><code>API 1.40+</code>ï¼Œè°ƒèŠ‚å®¹å™¨pidsé™åˆ¶ï¼ˆ-1è¡¨ç¤ºæ— é™åˆ¶ï¼‰</td></tr><tr><td style="text-align:left"><code>--restart</code></td><td style="text-align:left">å®¹å™¨é€€å‡ºæ—¶é‡æ–°å¯åŠ¨ç­–ç•¥ä»¥åº”ç”¨</td></tr></tbody></table><h2 id="9-9-å®¹å™¨çš„æ–‡ä»¶æ‹·è´">9.9 å®¹å™¨çš„æ–‡ä»¶æ‹·è´</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">ä»å®¹å™¨å†…æ‹·è´æ–‡ä»¶åˆ°linuxä¸»æœºä¸Š</span></span><br><span class="line">[root@localhost ~]# docker cp å®¹å™¨id:å®¹å™¨å†…è·¯å¾„ ç›®æ ‡ä¸»æœºè·¯å¾„</span><br><span class="line"><span class="meta prompt_"> </span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">ä»å®¿ä¸»æœºæ‹·è´æ–‡ä»¶åˆ°å®¹å™¨å†…</span> </span><br><span class="line">[root@localhost ~]# docker cp æ–‡ä»¶è·¯å¾„ å®¹å™¨id:å®¹å™¨å†…è·¯å¾„</span><br></pre></td></tr></table></figure><h2 id="9-8-å®¹å™¨çš„æäº¤">9.8 å®¹å™¨çš„æäº¤</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# docker commit å®¹å™¨id é‡å‘½åé•œåƒ</span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# docker ps -a</span><br><span class="line">CONTAINER ID   IMAGE             COMMAND                  CREATED          STATUS                            PORTS     NAMES</span><br><span class="line">a04a590adf6c   centos:7.6.1810   &quot;bash&quot;                   59 seconds ago   Exited (0) 7 seconds ago                    awesome_lamarr</span><br><span class="line">[root@localhost ~]# docker commit a04a590adf6c niubb/centos-vim-7.6.1810</span><br><span class="line">sha256:f6f3648f6cccdd589e6849d0075d96bd53c3727062b168fac6775b904850fef9</span><br><span class="line">[root@localhost ~]# docker images</span><br><span class="line">REPOSITORY                  TAG        IMAGE ID       CREATED         SIZE</span><br><span class="line">niubb/centos-vim-7.6.1810   latest     f6f3648f6ccc   9 seconds ago   449MB</span><br><span class="line">centos                      7.6.1810   f1cb7c7d58b7   3 years ago     202MB</span><br></pre></td></tr></table></figure><h2 id="9-9-å®¹å™¨çš„å¯¼å‡ºå’Œå¯¼å…¥">9.9 å®¹å™¨çš„å¯¼å‡ºå’Œå¯¼å…¥</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docker <span class="built_in">export</span> -o æ–‡ä»¶å.tar CONTAINER	<span class="comment"># å¯¼å‡ºå®¹å™¨çš„å†…å®¹ç•™ä½œä¸ºä¸€ä¸ªtarå½’æ¡£æ–‡ä»¶</span></span><br><span class="line">docker import [OPTIONS] æ–‡ä»¶å.tar å‘½åCONTAINER	<span class="comment"># ä»taråŒ…ä¸­å¾—å†…å®¹åˆ›å»ºä¸€ä¸ªæ–°çš„æ–‡ä»¶ç³»ç»Ÿå†å¯¼å…¥ä¸ºé•œåƒ</span></span><br></pre></td></tr></table></figure><h2 id="9-9-æŸ¥çœ‹å®¹å™¨è¯¦ç»†ä¿¡æ¯">9.9 æŸ¥çœ‹å®¹å™¨è¯¦ç»†ä¿¡æ¯</h2><p><strong>æ–¹æ³•ä¸€ï¼š</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# docker inspect å®¹å™¨åç§°/å®¹å™¨id</span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# docker inspect nginx1</span><br><span class="line">[</span><br><span class="line">    &#123;</span><br><span class="line">        &quot;Id&quot;: &quot;d13ef6c6cb8e10be379cd796956f3e334aa44ceef15da80db3f4fddf14b09479&quot;,</span><br><span class="line">        &quot;Created&quot;: &quot;2023-01-21T12:11:57.22722614Z&quot;,</span><br><span class="line">        &quot;Path&quot;: &quot;/docker-entrypoint.sh&quot;,</span><br><span class="line">        &quot;Args&quot;: [</span><br><span class="line">            &quot;nginx&quot;,</span><br><span class="line">            &quot;-g&quot;,</span><br><span class="line">            &quot;daemon off;&quot;</span><br><span class="line">        ],</span><br><span class="line">        &quot;State&quot;: &#123;</span><br><span class="line">            &quot;Status&quot;: &quot;running&quot;,</span><br><span class="line">            &quot;Running&quot;: true,</span><br><span class="line">            &quot;Paused&quot;: false,</span><br><span class="line">            &quot;Restarting&quot;: false,</span><br><span class="line">            &quot;OOMKilled&quot;: false,</span><br><span class="line">            &quot;Dead&quot;: false,</span><br><span class="line">            &quot;Pid&quot;: 84812,</span><br><span class="line">            &quot;ExitCode&quot;: 0,</span><br><span class="line">            &quot;Error&quot;: &quot;&quot;,</span><br><span class="line">            &quot;StartedAt&quot;: &quot;2023-01-21T12:11:57.504385223Z&quot;,</span><br><span class="line">            &quot;FinishedAt&quot;: &quot;0001-01-01T00:00:00Z&quot;</span><br><span class="line">        &#125;,</span><br><span class="line">        &quot;Image&quot;: &quot;sha256:a99a39d070bfd1cb60fe65c45dea3a33764dc00a9546bf8dc46cb5a11b1b50e9&quot;,</span><br><span class="line">...çœç•¥æ•°æ®...</span><br></pre></td></tr></table></figure><p><strong>æ–¹æ³•äºŒï¼š</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æŸ¥è¯¢å®¹å™¨åˆ›å»ºè¯­å¥</span></span><br><span class="line">[root@localhost ~]# runlike -p å®¹å™¨å</span><br></pre></td></tr></table></figure><ul><li><p>å®‰è£…runlike</p><p>éœ€è¦å®‰è£…pipå·¥å…·åŒ…</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# yum -y install python-pip</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">å¦‚æœä¸æˆåŠŸï¼Œå°è¯•ä¸‹åˆ—å‘½ä»¤</span></span><br><span class="line">[root@localhost ~]# yum -y install python36</span><br><span class="line">[root@localhost ~]# pip install --upgrade pip</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">ä¹Ÿå¯ä»¥å°è¯•æ›´æ¢å›½å†…æº</span></span><br><span class="line">[root@localhost ~]# touch /etc/pip.conf</span><br><span class="line">[root@docker_test ~]# cat &gt;&gt; /etc/pip.conf &lt;&lt; EOF</span><br><span class="line"><span class="meta prompt_">&gt; </span><span class="language-bash">[global]</span></span><br><span class="line"><span class="meta prompt_">&gt; </span><span class="language-bash">index-url = https://pypi.tuna.tsinghua.edu.cn/simple</span></span><br><span class="line"><span class="meta prompt_">&gt; </span><span class="language-bash">EOF</span></span><br><span class="line"></span><br><span class="line">[root@localhost ~]# pip3 install runlike</span><br></pre></td></tr></table></figure></li></ul><hr><h1 id="5ï¼‰Docker-é•œåƒ">5ï¼‰Docker é•œåƒ</h1><p>æ˜¯ä¸€ç§è½»é‡çº§ã€å¯æ‰§è¡Œçš„ç‹¬ç«‹è½¯ä»¶åŒ…ï¼Œå®ƒåŒ…å«è¿è¡ŒæŸä¸ªè½¯ä»¶æ‰€éœ€çš„æ‰€æœ‰å†…å®¹ï¼Œæˆ‘ä»¬æŠŠåº”ç”¨ç¨‹åºå’Œé…ç½®ä¾èµ–æ‰“åŒ…å¥½å½¢æˆä¸€ä¸ªå¯äº¤ä»˜çš„è¿è¡Œç¯å¢ƒ(åŒ…æ‹¬ä»£ç ã€è¿è¡Œæ—¶éœ€è¦çš„åº“ã€ç¯å¢ƒå˜é‡å’Œé…ç½®æ–‡ä»¶ç­‰)ï¼Œè¿™ä¸ªæ‰“åŒ…å¥½çš„è¿è¡Œç¯å¢ƒå°±æ˜¯imageé•œåƒæ–‡ä»¶ã€‚</p><p>åªæœ‰é€šè¿‡è¿™ä¸ªé•œåƒæ–‡ä»¶æ‰èƒ½ç”ŸæˆDockerå®¹å™¨å®ä¾‹(ç±»ä¼¼Javaä¸­newå‡ºæ¥ä¸€ä¸ªå¯¹è±¡)ã€‚</p><p>éƒ¨ç½²ä¸€ä¸ªç”¨äºä½ éœ€è¦çš„å®¹å™¨ç¯å¢ƒã€‚</p><ul><li>å®šåˆ¶dockeré•œåƒæœ‰ä¸¤ç§æ–¹å¼ï¼š<ol><li>æ‰‹åŠ¨ä¿®æ”¹å®¹å™¨å†…å®¹ï¼Œå¯¼å‡ºæ–°çš„é•œåƒ</li><li>åŸºäºDockerfile è‡ªè¡Œç¼–å†™æŒ‡ä»¤ï¼ŒåŸºäºæŒ‡ä»¤æµç¨‹åˆ›å»ºé•œåƒã€‚</li></ol></li></ul><h2 id="10-1-dockerfile-æŒ‡ä»¤">10.1 dockerfile æŒ‡ä»¤</h2><h3 id="10-1-1-FROM-æŒ‡å®šåŸºç¡€é•œåƒ">10.1.1 FROM æŒ‡å®šåŸºç¡€é•œåƒ</h3><h3 id="10-1-2-MAINTAINER-æŒ‡å®šç»´æŠ¤è€…ä¿¡æ¯">10.1.2 MAINTAINER æŒ‡å®šç»´æŠ¤è€…ä¿¡æ¯</h3><p>ï¼ˆå¯ä»¥æ²¡æœ‰ç»´æŠ¤è€…ï¼‰</p><h3 id="10-1-3-RUN-æ‰§è¡Œå‘½ä»¤">10.1.3 RUN æ‰§è¡Œå‘½ä»¤</h3><h3 id="10-1-4-ADD-æ‹·è´æ–‡ä»¶ï¼Œä¼šè‡ªåŠ¨è§£å‹">10.1.4 ADD æ‹·è´æ–‡ä»¶ï¼Œä¼šè‡ªåŠ¨è§£å‹</h3><ol><li>æ·»åŠ å®¿ä¸»æœºçš„æ–‡ä»¶åˆ°å®¹å™¨å†…ï¼Œå¦‚æœæ˜¯gzipã€bzip2ã€xzã€tar ADDèƒ½è‡ªåŠ¨è§£å‹åˆ°å½“å‰è·¯å¾„ä¸‹ã€‚</li><li>åŸæ–‡ä»¶å¦‚æœæ˜¯URLï¼Œæ­¤æ—¶dockerå¼•æ“ä¼šä¸‹è½½è¯¥é“¾æ¥ï¼Œæ”¾å…¥ç›®æ ‡è·¯å¾„ï¼Œä¸”è‡ªåŠ¨è®¾ç½®ä¸º600æƒé™ã€‚å¦‚æœURLæºæ–‡ä»¶æ˜¯å‹ç¼©åŒ…ï¼Œåˆ™ä¸è‡ªåŠ¨è§£å‹ã€‚</li></ol><h3 id="10-1-5-COPY-å¤åˆ¶æ–‡ä»¶">10.1.5 COPY å¤åˆ¶æ–‡ä»¶</h3><p>æ·»åŠ å®¿ä¸»æœºçš„æ–‡ä»¶åˆ°å®¹å™¨å†…ï¼ŒCOPYä»…å¤åˆ¶</p><h3 id="10-1-6-WORKDIR-è®¾ç½®å½“å‰å·¥ä½œç›®å½•">10.1.6 WORKDIR è®¾ç½®å½“å‰å·¥ä½œç›®å½•</h3><p>ï¼ˆç›¸å½“äºcdï¼‰</p><h3 id="10-1-7-VOLUME-è®¾ç½®å·ï¼ŒæŒ‚è½½åˆ°ä¸»æœºç›®å½•">10.1.7 VOLUME è®¾ç½®å·ï¼ŒæŒ‚è½½åˆ°ä¸»æœºç›®å½•</h3><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">VOLUME</span><span class="language-bash"> [<span class="string">&quot;/data1&quot;</span>,<span class="string">&quot;/data2&quot;</span>]</span></span><br><span class="line"><span class="comment"># æ”¯æŒåˆ—è¡¨çš„å½¢å¼æŒ‚è½½å¤šä¸ªæ–‡ä»¶å¤¹</span></span><br></pre></td></tr></table></figure><h3 id="10-1-8-EXPOSE-æŒ‡å®šå¯¹å¤–çš„ç«¯å£">10.1.8 EXPOSE æŒ‡å®šå¯¹å¤–çš„ç«¯å£</h3><h3 id="10-1-9-CMD-æŒ‡å®šå®¹å™¨å¯åŠ¨åè¦å¹²çš„äº‹æƒ…">10.1.9 CMD æŒ‡å®šå®¹å™¨å¯åŠ¨åè¦å¹²çš„äº‹æƒ…</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat /etc/os-release</span><br></pre></td></tr></table></figure><p>ç›¸å½“äº</p><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CMD</span><span class="language-bash"> [<span class="string">&quot;cat&quot;</span>ï¼Œ<span class="string">&quot;/etc/os-release&quot;</span>]</span></span><br></pre></td></tr></table></figure><ul><li><p>DockeræŒ‚è½½ä¸»æœºç›®å½•è®¿é—®å¦‚æœå‡ºç°cannot open directory.ï¼šPermission denied</p><p>è§£å†³åŠæ³•ï¼šåœ¨æŒ‚è½½ç›®å½•åå¤šåŠ ä¸€ä¸ªâ€“privileged=trueå‚æ•°å³å¯ï¼ˆæ‰©å¤§å®¹å™¨æƒé™ï¼Œä½¿å®¹å™¨å†…çš„rootæ‹¥æœ‰çœŸæ­£çš„rootæƒé™ï¼‰</p></li></ul><h3 id="10-1-10-ENTRYPOINT-å®¹å™¨å¯åŠ¨åæ‰§è¡Œçš„å‘½ä»¤">10.1.10 ENTRYPOINT å®¹å™¨å¯åŠ¨åæ‰§è¡Œçš„å‘½ä»¤</h3><p>å½“æŒ‡å®šäº†ENTRYPOINTä¹‹åï¼ŒCMDçš„æŒ‡ä»¤è¯­ä¹‰å°±æœ‰äº†å˜åŒ–ã€‚CMDçš„å†…å®¹å½“åšå‚æ•°ä¼ é€’ç»™ENTRYPOINTæŒ‡ä»¤ã€‚</p><h3 id="10-1-11-ENV-ç¯å¢ƒå˜é‡">10.1.11 ENV ç¯å¢ƒå˜é‡</h3><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ENV</span> MYSQL_VERSION=<span class="number">5.6</span></span><br></pre></td></tr></table></figure><p>ARGå’ŒENVçš„åŒºåˆ«åœ¨äºï¼ŒENVæ— è®ºå®åœ¨é•œåƒæ„å»ºæ—¶ï¼Œè¿˜æ˜¯å®¹å™¨è¿è¡Œæ—¶ï¼Œè¯¥å˜é‡éƒ½å¯ä»¥ä½¿ç”¨ã€‚ARGåªå­˜åœ¨äºæ„å»ºé•œåƒæ—¶ã€‚</p><p>10.1.12 USER ç”¨æˆ·åˆ‡æ¢</p><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">USER</span> root</span><br><span class="line"><span class="keyword">USER</span> niubb</span><br></pre></td></tr></table></figure><h3 id="10-1-12-restart-é‡å¯æœºåˆ¶">10.1.12 restart é‡å¯æœºåˆ¶</h3><p>dockerå®¹å™¨çš„é‡å¯ç­–ç•¥æœ‰ä¸‹é¢å››ç§:</p><ul><li><code>no</code><br>æ˜¯é»˜è®¤çš„é‡å¯ç­–ç•¥,dockerå®¹å™¨å¦‚å¯åŠ¨å¤±è´¥æˆ–æ„å¤–åœæ­¢åDocker Daemonä¸ä¼šå°è¯•è¿›è¡Œé‡å¯ï¼Œé™¤éæ‰‹åŠ¨å¯åŠ¨å®¹å™¨ï¼Œå¦åˆ™ä¸€ç›´æ˜¯stopçš„çŠ¶æ€ã€‚</li><li><code>always</code><br>è¡¨ç¤ºæ°¸è¿œé‡å¯ï¼Œå®ƒçš„å…ˆå†³æ¡ä»¶æ˜¯å¦‚æœä½ ä½¿ç”¨<code>docker stop</code>å‘½ä»¤åœæ­¢äº†å®¹å™¨åˆ™dockerä¸ä¼šè‡ªè¡Œå¯åŠ¨è¯¥å®¹å™¨ï¼Œä½†å¦‚æœæ‰§è¡Œ<code>docker stop</code>å‘½ä»¤åé‡å¯äº†Docker Daemonåˆ™è¯¥å®¹å™¨ä¼šè§¦å‘<code>always</code>é‡å¯ç­–ç•¥ï¼Œè¿›è€Œå¯åŠ¨å®¹å™¨ã€‚</li><li><code>on-failure</code><br>é‡å¯ç­–ç•¥çš„è§¦å‘æ ‡å‡†æ˜¯å½“<code>Docker Daemon</code>æ£€æµ‹åˆ°å®¹å™¨éæ­£å¸¸åœæ­¢ååˆ™ä¼šæ‰§è¡Œè¯¥é‡å¯ç­–ç•¥ã€‚<code>on-failure</code>è¦æ±‚ä¼ å…¥ä¸€ä¸ªæ•´å‹å‚æ•°è¡¨ç¤ºé‡å¯æ¬¡æ•°ï¼Œå½“é‡å¯æ¬¡æ•°<code>&gt;=</code>è¯¥æ•´æ•°å€¼åˆ™ä¸ä¼šäºˆä»¥é‡å¯ã€‚</li><li><code>unless-stopped</code><br>é‡å¯ç­–ç•¥ä¸<code>always</code>å¾ˆç›¸ä¼¼ï¼Œå”¯ä¸€ä¸åŒå¤„åœ¨äº<code>unless-stopped</code>ä¼šåœ¨<code>Docker Daemon</code>å¯åŠ¨æ—¶ä¼šæ£€æµ‹dockerå®¹å™¨åˆ—è¡¨å†…çš„å®¹å™¨åœ¨ä¸Šæ¬¡åœæ­¢æ—¶çš„çŠ¶æ€ï¼Œå¦‚æœä¸Šä¸€æ¬¡å®¹å™¨åœæ­¢æ—¶å°±æ˜¯stopçŠ¶æ€åˆ™ä¸ä¼šå¯åŠ¨è¯¥å®¹å™¨ï¼Œå¦åˆ™å¯åŠ¨è¯¥å®¹å™¨ã€‚</li></ul><h2 id="10-2-æ„å»ºé•œåƒ">10.2 æ„å»ºé•œåƒ</h2><p>cdåˆ‡æ¢åˆ°å†™å¥½çš„dockerfileæ–‡ä»¶å¤¹</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docker bulid .</span><br><span class="line">docker bulid -t &#x27;å–ä¸€ä¸ªé•œåƒå&#x27; .</span><br></pre></td></tr></table></figure><h1 id="11ï¼‰å®¹å™¨æ•°æ®å·">11ï¼‰å®¹å™¨æ•°æ®å·</h1><h2 id="1-å‘½ä»¤">.1 å‘½ä»¤</h2><ol><li><p>åˆå§‹åŒ–è¿è¡Œå®¹å™¨æ—¶ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -it --privileged=true -v /å®¿ä¸»æœºç»å¯¹è·¯å¾„ç›®å½•:/å®¹å™¨å†…ç›®å½• é•œåƒå</span><br></pre></td></tr></table></figure></li><li><p>dockerfile:</p><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">VOLUME</span><span class="language-bash"> [<span class="string">&quot;å®¿ä¸»æœºç»å¯¹è·¯å¾„&quot;</span>]</span></span><br></pre></td></tr></table></figure><p>å€¼å¾—æ³¨æ„çš„æ˜¯é€šè¿‡ VOLUME æŒ‡ä»¤åˆ›å»ºçš„æŒ‚è½½ç‚¹ï¼Œæ— æ³•æŒ‡å®šä¸»æœºä¸Šå¯¹åº”çš„ç›®å½•ï¼Œè€Œæ˜¯è‡ªåŠ¨ç”Ÿæˆçš„ã€‚</p><p>åœ¨dockerfileä¸­VOLUMEå¯ä»¥æŒ‡å®šå¤šä¸ªæŒ‚åœ¨ç›®å½•ï¼Œå³<code>[&quot;å®¿ä¸»æœºç»å¯¹è·¯å¾„1&quot;,&quot;å®¿ä¸»æœºç»å¯¹è·¯å¾„2&quot;]</code>ä»£è¡¨è¿™ä¸¤ä¸ªç›®å½•éƒ½ä¼šæŒ‚åœ¨åˆ°å®¿ä¸»æœºçš„è‡ªåŠ¨ç”Ÿæˆçš„ç›®å½•ã€‚</p></li></ol><h2 id="2-æ¦‚è¿°">.2 æ¦‚è¿°</h2><ul><li><p>å®¹å™¨åœ¨è¿è¡Œæ—¶ï¼Œåº”è¯¥ä¿è¯åœ¨å­˜å‚¨å±‚ä¸å†™å…¥ä»»ä½•æ•°æ®ï¼Œè¿è¡Œåœ¨å®¹å™¨å†…äº§ç”Ÿçš„æ•°æ®ï¼Œæˆ‘ä»¬æ¨èæ˜¯æŒ‚è½½å†™å…¥åˆ°å®¿ä¸»æœºä¸Šï¼Œè¿›è¡Œç»´æŠ¤ã€‚å·çš„è®¾è®¡ç›®çš„å°±æ˜¯<span style="color:red">æ•°æ®çš„æŒä¹…åŒ–</span>ï¼Œå®Œå…¨ç‹¬ç«‹äºå®¹å™¨çš„ç”Ÿå­˜å‘¨æœŸï¼Œå› æ­¤Dockerä¸ä¼šåœ¨å®¹å™¨åˆ é™¤æ˜¯åˆ é™¤å™¨æŒ‚è½½çš„æ•°æ®å·ã€‚</p></li><li><p>ç‰¹ç‚¹ï¼š</p><ol><li>æ•°æ®å·å¯åœ¨å®¹å™¨ä¹‹é—´å…±äº«æˆ–é‡ç”¨æ•°æ®</li><li>å·ä¸­çš„æ›´æ”¹å¯ä»¥ç›´æ¥å®æ—¶ç”Ÿæ•ˆ</li><li>æ•°æ®å·ä¸­çš„æ›´æ”¹ä¸ä¼šåŒ…å«åœ¨é•œåƒçš„æ›´æ–°ä¸­</li><li>æ•°æ®å·çš„ç”Ÿå‘½å‘¨æœŸä¸€ç›´æŒç»­åˆ°æ²¡æœ‰å®¹å™¨ä½¿ç”¨å®ƒä¸ºæ­¢</li></ol></li><li><p>æ³¨æ„ï¼š</p><p>DockeræŒ‚è½½ä¸»æœºç›®å½•è®¿é—®å¦‚æœå‡ºç°<code>cannot open directory .: Permission denied</code></p><p>è§£å†³åŠæ³•ï¼šåœ¨æŒ‚è½½ç›®å½•åå¤šåŠ ä¸€ä¸ªâ€“privileged=trueå‚æ•°å³å¯ã€‚</p><p>å¦‚æœæ˜¯CentOS7å®‰å…¨æ¨¡å—ä¼šæ¯”ä¹‹å‰ç³»ç»Ÿç‰ˆæœ¬åŠ å¼ºï¼Œä¸å®‰å…¨çš„ä¼šå…ˆç¦æ­¢ï¼Œæ‰€ä»¥ç›®å½•æŒ‚è½½çš„æƒ…å†µè¢«é»˜è®¤ä¸ºä¸å®‰å…¨çš„è¡Œä¸ºï¼Œåœ¨SELinuxé‡Œé¢æŒ‚è½½ç›®å½•è¢«ç¦æ­¢æ‰äº†é¢ï¼Œå¦‚æœè¦å¼€å¯ï¼Œæˆ‘ä»¬ä¸€èˆ¬ä½¿ç”¨â€“privileged=trueå‘½ä»¤ï¼Œæ‰©å¤§å®¹å™¨çš„æƒé™è§£å†³æŒ‚è½½ç›®å½•æ²¡æœ‰æƒé™çš„é—®é¢˜ï¼Œä¹Ÿå³ä½¿ç”¨è¯¥å‚æ•°ï¼Œcontainerå†…çš„rootæ‹¥æœ‰çœŸæ­£çš„rootæƒé™ï¼Œå¦åˆ™ï¼Œcontainerå†…çš„rootåªæ˜¯å¤–éƒ¨çš„ä¸€ä¸ªæ™®é€šç”¨æˆ·æƒé™ã€‚</p></li></ul><h2 id="3-è¯»å†™è§„åˆ™">.3 è¯»å†™è§„åˆ™</h2><p><code>:rw</code> é»˜è®¤è§„åˆ™ä¸ºå¯è¯»å†™ã€‚</p><p><code>:ro</code> å®¹å™¨å®ä¾‹å†…éƒ¨è¢«é™åˆ¶ï¼Œåªèƒ½è¯»å–ä¸èƒ½å†™(= read only)ï¼Œæ­¤æ—¶å¦‚æœå®¿ä¸»æœºå†™å…¥å†…å®¹ï¼Œå¯ä»¥åŒæ­¥ç»™å®¹å™¨å†…ï¼Œå®¹å™¨å¯ä»¥è¯»å–åˆ°ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docker run -it --privileged=true -v /å®¿ä¸»æœºç»å¯¹è·¯å¾„ç›®å½•:/å®¹å™¨å†…ç›®å½•:rw é•œåƒå</span><br><span class="line">docker run -it --privileged=true -v /å®¿ä¸»æœºç»å¯¹è·¯å¾„ç›®å½•:/å®¹å™¨å†…ç›®å½•:ro é•œåƒå</span><br></pre></td></tr></table></figure><h2 id="4-å·çš„ç»§æ‰¿å’Œå…±äº«">.4 å·çš„ç»§æ‰¿å’Œå…±äº«</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -it  --privileged=true --volumes-from çˆ¶ç±»å®¹å™¨id  --name u2 é•œåƒå</span><br></pre></td></tr></table></figure><p>æ­¤æ—¶u2åªæ˜¯ç»§æ‰¿äº†çˆ¶ç±»å®¹å™¨çš„è§„åˆ™ï¼Œçˆ¶ç±»å®¹å™¨å¦‚æœæŒ‚æ‰å¹¶ä¸ä¼šå¯¹u2çš„æŒ‚è½½äº§ç”Ÿå½±å“ã€‚</p><h1 id="å›¢é˜Ÿåä½œ">å›¢é˜Ÿåä½œ</h1><h2 id="1-é˜¿é‡Œäº‘">.1 é˜¿é‡Œäº‘</h2><h2 id="2-dockerhub">.2 dockerhub</h2><h2 id="3-ç§æœ‰ä»“åº“">.3 ç§æœ‰ä»“åº“</h2><h3 id="3-1-åˆ›å»ºç§æœ‰ä»“åº“">.3.1 åˆ›å»ºç§æœ‰ä»“åº“</h3><ul><li><p>ä¸‹è½½é•œåƒDocker Registry</p><p>ç›¸å½“äºæœ¬åœ°æœ‰ä¸ªç§æœ‰Docker hubã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -d -p 5000:5000 -v $&#123;PWD&#125;/registry:/var/lib/registry --restart always --privileged=true --name registry registry</span><br></pre></td></tr></table></figure></li><li><p>ä¿®æ”¹é…ç½®æ–‡ä»¶ daedom.json ä½¿ä¹‹æ”¯æŒhttpï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/docker/daedom.json</span><br></pre></td></tr></table></figure><p>åœ¨ daedom.json æ·»åŠ ï¼šï¼ˆï¼ï¼ï¼åƒä¸‡åˆ«æ¼æ‰åé¢çš„é€—å·ï¼ï¼ï¼ï¼‰</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">&quot;insecure-registries&quot;</span><span class="punctuation">:</span><span class="punctuation">[</span><span class="string">&quot;ä½ çš„ipåœ°å€:5000&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br></pre></td></tr></table></figure><p>é‡å¯ Dockerï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl restart docker</span><br></pre></td></tr></table></figure></li></ul><h3 id="3-2-æŸ¥çœ‹ç§æœ‰åº“é•œåƒ">.3.2 æŸ¥çœ‹ç§æœ‰åº“é•œåƒ</h3><ul><li><p>æµè§ˆå™¨è®¿é—® <code>http://ä½ çš„ipåœ°å€:5000/v2/_catalog</code></p></li><li><p>æˆ–è€… curl æŸ¥è¯¢</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -XGET http://ä½ çš„ipåœ°å€:5000/v2/_catalog</span><br></pre></td></tr></table></figure></li></ul><h3 id="3-3-æ¨é€å’Œæ‹‰å–">.3.3 æ¨é€å’Œæ‹‰å–</h3><p>ä»¥ä¸‹ä»¥nginxä¸¾ä¾‹è¯´æ˜</p><ul><li><p>ç»™é•œåƒæ‰“ä¸Šæ ‡ç­¾ï¼ˆä½¿å…¶ç¬¦åˆç§åº“è§„èŒƒï¼‰</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker tag nginx:1.18.0 ä½ çš„ipåœ°å€:5000/nginx:1.18.0</span><br></pre></td></tr></table></figure></li><li><p>æŠŠæœ¬åœ°çš„é•œåƒæ¨åˆ°æœåŠ¡</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker push ä½ çš„ipåœ°å€:5000/nginx:1.18.0</span><br></pre></td></tr></table></figure></li><li><p>æ‹‰å–é•œåƒ</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker pull ä½ çš„ipåœ°å€:5000/nginx:1.18.0</span><br></pre></td></tr></table></figure></li></ul><h1 id="Docker-APPå¸¸è§„å®‰è£…">Docker APPå¸¸è§„å®‰è£…</h1><h2 id="1-tomcat">.1 tomcat</h2><ul><li><p>åˆ›å»ºä¸´æ—¶å®¹å™¨</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -p 8080:8080 --rm --name temp_tomcat -d tomcat</span><br></pre></td></tr></table></figure><ul><li><p>8080å¦‚æœä¸èƒ½è®¿é—®ï¼Œè¿›å…¥äº¤äº’</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@docker_test ~]# docker exec -it temp_tomcat /bin/bash</span><br><span class="line">root@d69eb116a23c:/usr/local/tomcat# cd webapps</span><br><span class="line">root@d69eb116a23c:/usr/local/tomcat/webapps# cp -r webapps.dist/. webapps</span><br></pre></td></tr></table></figure></li></ul></li><li><p>åˆ›å»ºå®¹å™¨</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">docker run -d -p 8080:8080 --privileged=true  --restart=always \</span><br><span class="line">-v /mydata/tomcat/webapps:/usr/local/tomcat/webapps \</span><br><span class="line">-v /mydata/tomcat/logs:/usr/local/tomcat/logs \</span><br><span class="line">-v /mydata/tomcat/conf:/usr/local/tomcat/conf \</span><br><span class="line">--name tomcat \</span><br><span class="line">tomcat</span><br></pre></td></tr></table></figure></li></ul><h2 id="2-MySQL">.2 MySQL</h2><ul><li><p>æ£€æŸ¥å®¿ä¸»æœºä¸Šæ˜¯å¦æœ‰Mysqlï¼Œä»¥åŠ3306ç«¯å£å ç”¨æƒ…å†µ</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@nb /]# ps -ef | grep mysql</span><br><span class="line">root      4688  1287  0 01:35 pts/0    00:00:00 grep --color=auto mysql</span><br><span class="line">[root@nb /]# netstat -anp | grep 3306</span><br><span class="line">[root@nb /]# </span><br></pre></td></tr></table></figure></li><li><p>åˆ›å»ºå®¹å™¨</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">docker run -d -p 3306:3306 --privileged=true --restart=always \</span><br><span class="line">-v /mydata/mysql/logs:/var/log/mysql \</span><br><span class="line">-v /mydata/mysql/data:/var/lib/mysql \</span><br><span class="line">-v /mydata/mysql/conf:/etc/mysql/conf.d \</span><br><span class="line">-e MYSQL_ROOT_PASSWORD=000588 \</span><br><span class="line">--name mysql \</span><br><span class="line">mysql:5.7</span><br></pre></td></tr></table></figure></li><li><p>ä¿®æ”¹é…ç½®</p><p>æ­¤æ—¶åº”è¯¥ä¿®æ”¹é…ç½®æ–‡ä»¶ï¼Œå¦åˆ™é»˜è®¤ä¸æ”¯æŒutf-8</p><p>ä¿®æ”¹é…ç½®æ–‡ä»¶ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">touch /mydata/mysql/conf/my.cnf</span><br><span class="line">vim /mydata/mysql/conf/my.cnf</span><br></pre></td></tr></table></figure><p>æ·»åŠ ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[client]</span><br><span class="line">default_character_set=utf8</span><br><span class="line">[mysqld]</span><br><span class="line">collation_server = utf8_general_ci</span><br><span class="line">character_set_server = utf8</span><br></pre></td></tr></table></figure><p>é‡å¯å®¹å™¨ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker restart mysql</span><br></pre></td></tr></table></figure><p>å†æ¬¡è¿›å…¥å®¹å™¨åå†è¿›å…¥MySQLï¼ŒæŸ¥çœ‹å½“å‰å­—ç¬¦é›†ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docker exec -it mysql bash</span><br><span class="line">mysql -u root -p 123456</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; SHOW VARIABLES LIKE &#x27;character%&#x27;;</span><br></pre></td></tr></table></figure></li></ul><h2 id="3-redis">.3 redis</h2><ul><li><p>åˆ›å»ºå®¹å™¨</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">docker run -p 6379:6379 --restart=always \</span><br><span class="line">--privileged=true \</span><br><span class="line">-v /mydata/redis/redis.conf:/etc/redis/redis.conf \</span><br><span class="line">-v /mydata/redis/data:/data \</span><br><span class="line">redis-server /etc/redis/redis.conf \</span><br><span class="line">--log-opt max-size=100m --log-opt max-file=2 \</span><br><span class="line">--appendonly yes \</span><br><span class="line">--requirepass 000588 \</span><br><span class="line">--name redis \</span><br><span class="line">-d redis</span><br></pre></td></tr></table></figure><blockquote><ol><li><code>--privileged=true</code> å¼€å¯å®¹å™¨å·</li><li><code>--restart=always</code> æ€»æ˜¯å¼€æœºå¯åŠ¨</li><li><code>-log</code>æ˜¯æ—¥å¿—æ–¹é¢çš„</li><li><code>-p 6379:6379</code> å°†6379ç«¯å£æŒ‚è½½å‡ºå»</li><li><code>--name</code> ç»™è¿™ä¸ªå®¹å™¨å–ä¸€ä¸ªåå­—</li><li><code>-v</code> æ•°æ®å·æŒ‚è½½<ul><li><code>/mydata/redis/redis.conf:/etc/redis/redis.conf</code> è¿™é‡Œæ˜¯å°† liunx è·¯å¾„ä¸‹çš„myredis.conf å’Œredisä¸‹çš„redis.conf æŒ‚è½½åœ¨ä¸€èµ·ã€‚</li><li><code>/mydata/redis/data:/data</code> è¿™ä¸ªåŒä¸Š</li></ul></li><li><code>-d redis</code> è¡¨ç¤ºåå°å¯åŠ¨redis</li><li><code>redis-server /etc/redis/redis.conf</code> ä»¥é…ç½®æ–‡ä»¶å¯åŠ¨ redisï¼ŒåŠ è½½å®¹å™¨å†…çš„ conf æ–‡ä»¶ï¼Œæœ€ç»ˆæ‰¾åˆ°çš„æ˜¯æŒ‚è½½çš„ç›®å½• <code>/etc/redis/redis.conf</code> ä¹Ÿå°±æ˜¯ liunx ä¸‹çš„<code>/home/redis/myredis/myredis.conf</code></li><li><code>--appendonly yes</code> å¼€å¯redis æŒä¹…åŒ–</li><li><code>--requirepass 000588</code> è®¾ç½®å¯†ç </li></ol></blockquote><ul><li><p>ä¿®æ”¹redis.conf</p><p>æ‰“å¼€é…ç½®æ–‡ä»¶ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /mydata/redis/redis.conf</span><br></pre></td></tr></table></figure><p>ä¿®æ”¹ redis.conf ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"># 1.å¼€å¯rediséªŒè¯</span><br><span class="line">requirepass 000588</span><br><span class="line"></span><br><span class="line"># 2.å…è®¸rediså¤–åœ°è¿æ¥</span><br><span class="line"># æ³¨é‡Šæ‰ </span><br><span class="line"># bind 127.0.0.1</span><br><span class="line"></span><br><span class="line"># 3.å°†daemonize yesæ³¨é‡Šèµ·æ¥æˆ–è€… daemonize noè®¾ç½®ï¼Œå› ä¸ºè¯¥é…ç½®å’Œdocker runä¸­-då‚æ•°å†²çªï¼Œä¼šå¯¼è‡´å®¹å™¨ä¸€ç›´å¯åŠ¨å¤±è´¥</span><br><span class="line">daemonize no</span><br></pre></td></tr></table></figure><p>myredis.conf <a target="_blank" rel="noopener" href="https://blog.csdn.net/FangHX25/article/details/109134203">åŸç‰ˆconfç¿»è¯‘</a></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br></pre></td><td class="code"><pre><span class="line"># bind 192.168.1.100 10.0.0.1</span><br><span class="line"># bind 127.0.0.1 ::1</span><br><span class="line"># bind 127.0.0.1</span><br><span class="line"></span><br><span class="line">protected-mode no</span><br><span class="line"></span><br><span class="line">port 6379</span><br><span class="line"></span><br><span class="line">tcp-backlog 511</span><br><span class="line"></span><br><span class="line">requirepass 000588</span><br><span class="line"></span><br><span class="line">timeout 0</span><br><span class="line"></span><br><span class="line">tcp-keepalive 300</span><br><span class="line"></span><br><span class="line">daemonize no</span><br><span class="line"></span><br><span class="line">supervised no</span><br><span class="line"></span><br><span class="line">pidfile /var/run/redis_6379.pid</span><br><span class="line"></span><br><span class="line">loglevel notice</span><br><span class="line"></span><br><span class="line">logfile &quot;&quot;</span><br><span class="line"></span><br><span class="line">databases 30</span><br><span class="line"></span><br><span class="line">always-show-logo yes</span><br><span class="line"></span><br><span class="line">save 900 1</span><br><span class="line">save 300 10</span><br><span class="line">save 60 10000</span><br><span class="line"></span><br><span class="line">stop-writes-on-bgsave-error yes</span><br><span class="line"></span><br><span class="line">rdbcompression yes</span><br><span class="line"></span><br><span class="line">rdbchecksum yes</span><br><span class="line"></span><br><span class="line">dbfilename dump.rdb</span><br><span class="line"></span><br><span class="line">dir ./</span><br><span class="line"></span><br><span class="line">replica-serve-stale-data yes</span><br><span class="line"></span><br><span class="line">replica-read-only yes</span><br><span class="line"></span><br><span class="line">repl-diskless-sync no</span><br><span class="line"></span><br><span class="line">repl-disable-tcp-nodelay no</span><br><span class="line"></span><br><span class="line">replica-priority 100</span><br><span class="line"></span><br><span class="line">lazyfree-lazy-eviction no</span><br><span class="line">lazyfree-lazy-expire no</span><br><span class="line">lazyfree-lazy-server-del no</span><br><span class="line">replica-lazy-flush no</span><br><span class="line"></span><br><span class="line">appendonly yes</span><br><span class="line"></span><br><span class="line">appendfilename &quot;appendonly.aof&quot;</span><br><span class="line"></span><br><span class="line">no-appendfsync-on-rewrite no</span><br><span class="line"></span><br><span class="line">auto-aof-rewrite-percentage 100</span><br><span class="line">auto-aof-rewrite-min-size 64mb</span><br><span class="line"></span><br><span class="line">aof-load-truncated yes</span><br><span class="line"></span><br><span class="line">aof-use-rdb-preamble yes</span><br><span class="line"></span><br><span class="line">lua-time-limit 5000</span><br><span class="line"></span><br><span class="line">slowlog-max-len 128</span><br><span class="line"></span><br><span class="line">notify-keyspace-events &quot;&quot;</span><br><span class="line"></span><br><span class="line">hash-max-ziplist-entries 512</span><br><span class="line">hash-max-ziplist-value 64</span><br><span class="line"></span><br><span class="line">list-max-ziplist-size -2</span><br><span class="line"></span><br><span class="line">list-compress-depth 0</span><br><span class="line"></span><br><span class="line">set-max-intset-entries 512</span><br><span class="line"></span><br><span class="line">zset-max-ziplist-entries 128</span><br><span class="line">zset-max-ziplist-value 64</span><br><span class="line"></span><br><span class="line">hll-sparse-max-bytes 3000</span><br><span class="line"></span><br><span class="line">stream-node-max-bytes 4096</span><br><span class="line">stream-node-max-entries 100</span><br><span class="line"></span><br><span class="line">activerehashing yes</span><br><span class="line"></span><br><span class="line">hz 10</span><br><span class="line"></span><br><span class="line">dynamic-hz yes</span><br><span class="line"></span><br><span class="line">aof-rewrite-incremental-fsync yes</span><br><span class="line"></span><br><span class="line">rdb-save-incremental-fsync yes</span><br></pre></td></tr></table></figure></li></ul></li></ul><h2 id="4-nginx">.4 nginx</h2><ul><li><p>åˆ›å»ºä¸´æ—¶å®¹å™¨</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -p 80:80 --rm --name temp-nginx -d nginx</span><br></pre></td></tr></table></figure><blockquote><ol><li><code>--rm</code> é€€å‡ºå®¹å™¨æ—¶ä¼šè‡ªåŠ¨å°†å…¶åˆ é™¤</li></ol></blockquote></li><li><p>åˆ›å»ºå®¿ä¸»æœºç›®å½•å¹¶æ‹·è´éœ€è¦åˆ›å»ºçš„å®¹å™¨å·</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mkdir -p /data/nginx/conf</span><br><span class="line">mkdir -p /data/nginx/html</span><br><span class="line">mkdir -p /data/nginx/logs</span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">docker cp temp-nginx:/etc/nginx/nginx.conf /data/nginx/conf/nginx.conf</span><br><span class="line">docker cp temp-nginx:/etc/nginx/conf.d /data/nginx/conf/conf.d</span><br><span class="line">docker cp temp-nginx:/usr/share/nginx/html /data/nginx</span><br><span class="line">chmod 777 /data/nginx/conf/nginx.conf</span><br></pre></td></tr></table></figure></li><li><p>åœæ­¢å®¹å™¨</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docker stop temp-nginx</span><br><span class="line">docker ps -a</span><br></pre></td></tr></table></figure></li><li><p>åˆ›å»ºå®¹å™¨</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">docker run -p 80:80 -p 443:443 --privileged=true --restart=always \</span><br><span class="line">-v /mydata/nginx/conf/nginx.conf:/etc/nginx/nginx.conf \</span><br><span class="line">-v /mydata/nginx/conf/conf.d:/etc/nginx/conf.d \</span><br><span class="line">-v /mydata/nginx/html:/usr/share/nginx/html \</span><br><span class="line">-v /mydata/nginx/logs:/var/log/nginx \</span><br><span class="line">--name nginx \</span><br><span class="line">-d nginx</span><br></pre></td></tr></table></figure></li></ul><h1 id="Docker-APPå¤æ‚å®‰è£…">Docker APPå¤æ‚å®‰è£…</h1><h2 id="1-MySQLä¸»ä»å¤åˆ¶">1. MySQLä¸»ä»å¤åˆ¶</h2><ol><li><p>å¯åŠ¨ä¸»åº“é•œåƒ</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">docker run -d -p 3306:3306 --privileged=<span class="literal">true</span> --restart=always \</span><br><span class="line">-v /mydata/mysql-master/logs:/var/log/mysql \</span><br><span class="line">-v /mydata/mysql-master/data:/var/lib/mysql \</span><br><span class="line">-v /mydata/mysql-master/conf:/etc/mysql/conf.d \</span><br><span class="line">-e MYSQL_ROOT_PASSWORD=000588 \</span><br><span class="line">--name mysql-master \</span><br><span class="line">mysql:5.7</span><br></pre></td></tr></table></figure></li><li><p>è¿›å…¥ä¸»åº“é…ç½®æ–‡ä»¶<code>/mydata/mysql-master/conf</code>ä¸‹æ–°å»º <code>my.cnf</code></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">[mysqld]</span><br><span class="line"><span class="comment">## è®¾ç½®server_idï¼ŒåŒä¸€å±€åŸŸç½‘ä¸­éœ€è¦å”¯ä¸€</span></span><br><span class="line">server_id=101</span><br><span class="line"><span class="comment">## æŒ‡å®šä¸éœ€è¦åŒæ­¥çš„æ•°æ®åº“åç§°</span></span><br><span class="line">binlog-ignore-db=mysql</span><br><span class="line"><span class="comment">## å¼€å¯äºŒè¿›åˆ¶æ—¥å¿—åŠŸèƒ½</span></span><br><span class="line">log-bin=mall-mysql-bin</span><br><span class="line"><span class="comment">## è®¾ç½®äºŒè¿›åˆ¶æ—¥å¿—ä½¿ç”¨å†…å­˜å¤§å°ï¼ˆäº‹åŠ¡ï¼‰</span></span><br><span class="line">binlog_cache_size=1M</span><br><span class="line"><span class="comment">## è®¾ç½®ä½¿ç”¨çš„äºŒè¿›åˆ¶æ—¥å¿—æ ¼å¼ï¼ˆmixed,statement,rowï¼‰</span></span><br><span class="line">binlog_format=mixed</span><br><span class="line"><span class="comment">## äºŒè¿›åˆ¶æ—¥å¿—è¿‡æœŸæ¸…ç†æ—¶é—´ã€‚é»˜è®¤å€¼ä¸º0ï¼Œè¡¨ç¤ºä¸è‡ªåŠ¨æ¸…ç†ã€‚</span></span><br><span class="line">expire_logs_days=7</span><br><span class="line"><span class="comment">## è·³è¿‡ä¸»ä»å¤åˆ¶ä¸­é‡åˆ°çš„æ‰€æœ‰é”™è¯¯æˆ–æŒ‡å®šç±»å‹çš„é”™è¯¯ï¼Œé¿å…slaveç«¯å¤åˆ¶ä¸­æ–­ã€‚</span></span><br><span class="line"><span class="comment">## å¦‚ï¼š1062é”™è¯¯æ˜¯æŒ‡ä¸€äº›ä¸»é”®é‡å¤ï¼Œ1032é”™è¯¯æ˜¯å› ä¸ºä¸»ä»æ•°æ®åº“æ•°æ®ä¸ä¸€è‡´</span></span><br><span class="line">slave_skip_errors=1062</span><br></pre></td></tr></table></figure><p>é‡æ–°å¯åŠ¨ä¸»åº“å®¹å™¨<code>docker restart mysql-master</code>ã€‚</p></li><li><p>ä¸»åº“æ“ä½œ</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># docker è¿æ¥å®¹å™¨</span></span><br><span class="line">docker <span class="built_in">exec</span> -it mysql-master /bin/bash -c <span class="string">&#x27;mysql -uroot -p000588&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¿®æ”¹mysqlèº«ä»½éªŒè¯æ’ä»¶ä¸ºmysql_native_password;</span></span><br><span class="line"><span class="comment"># å› ä¸ºmysql 8.0+èµ·;å…¶é»˜è®¤çš„èº«ä»½éªŒè¯æ’ä»¶ä¸ºcaching_sha2_password;</span></span><br><span class="line"><span class="comment"># å¦‚æœä¸æ”¹ä¼šå¯¼è‡´ç™»å½•éªŒè¯å¤±è´¥;</span></span><br><span class="line"><span class="comment"># ALTER USER &#x27;root&#x27;@&#x27;%&#x27; IDENTIFIED WITH mysql_native_password BY &#x27;000588&#x27;;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»ºä»åº“æ•°æ®åŒæ­¥ç”¨æˆ·slave;</span></span><br><span class="line">CREATE USER slave IDENTIFIED WITH mysql_native_password BY <span class="string">&#x27;000588&#x27;</span>;</span><br><span class="line"><span class="comment">#  æˆæƒ</span></span><br><span class="line">GRANT SELECT, REPLICATION SLAVE, REPLICATION CLIENT ON *.* TO <span class="string">&#x27;slave&#x27;</span>@<span class="string">&#x27;%&#x27;</span>;</span><br><span class="line">GRANT ALL PRIVILEGES ON *.* TO <span class="string">&#x27;slave&#x27;</span>@<span class="string">&#x27;%&#x27;</span>;</span><br><span class="line"><span class="comment"># ç”Ÿæ•ˆ</span></span><br><span class="line">FLUSH PRIVILEGES;</span><br><span class="line"><span class="comment"># æŸ¥çœ‹ä¸»åº“çŠ¶æ€ï¼ˆè®°å½•æ•°æ®1,å¾…ç”¨ï¼‰</span></span><br><span class="line">show master status;</span><br></pre></td></tr></table></figure></li><li><p>å¯åŠ¨ä»æœåŠ¡å™¨é•œåƒ</p><p>å¦‚æœåŒå®¿ä¸»æœåŠ¡å™¨ä¿®æ”¹:</p><p>ç«¯å£<code>-p 3307:3306</code></p><p>å®¹å™¨å<code>--name mysql-slave</code></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">docker run -d -p 3306:3306 --privileged=<span class="literal">true</span> --restart=always \</span><br><span class="line">-v /mydata/mysql-slave/logs:/var/log/mysql \</span><br><span class="line">-v /mydata/mysql-slave/data:/var/lib/mysql \</span><br><span class="line">-v /mydata/mysql-slave/conf:/etc/mysql/conf.d \</span><br><span class="line">-e MYSQL_ROOT_PASSWORD=000588 \</span><br><span class="line">--name mysql-slave \</span><br><span class="line">mysql:5.7</span><br></pre></td></tr></table></figure></li><li><p>è¿›å…¥ä¸»åº“é…ç½®æ–‡ä»¶<code>/mydata/mysql-slave/conf</code>ä¸‹æ–°å»º <code>my.cnf</code></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">[mysqld]</span><br><span class="line"><span class="comment">## è®¾ç½®server_idï¼ŒåŒä¸€å±€åŸŸç½‘ä¸­éœ€è¦å”¯ä¸€</span></span><br><span class="line">server_id=102</span><br><span class="line"><span class="comment">## æŒ‡å®šä¸éœ€è¦åŒæ­¥çš„æ•°æ®åº“åç§°</span></span><br><span class="line">binlog-ignore-db=mysql  </span><br><span class="line"><span class="comment">## å¼€å¯äºŒè¿›åˆ¶æ—¥å¿—åŠŸèƒ½ï¼Œä»¥å¤‡Slaveä½œä¸ºå…¶å®ƒæ•°æ®åº“å®ä¾‹çš„Masteræ—¶ä½¿ç”¨</span></span><br><span class="line">log-bin=mall-mysql-slave1-bin  </span><br><span class="line"><span class="comment">## è®¾ç½®äºŒè¿›åˆ¶æ—¥å¿—ä½¿ç”¨å†…å­˜å¤§å°ï¼ˆäº‹åŠ¡ï¼‰</span></span><br><span class="line">binlog_cache_size=1M  </span><br><span class="line"><span class="comment">## è®¾ç½®ä½¿ç”¨çš„äºŒè¿›åˆ¶æ—¥å¿—æ ¼å¼ï¼ˆmixed,statement,rowï¼‰</span></span><br><span class="line">binlog_format=mixed  </span><br><span class="line"><span class="comment">## äºŒè¿›åˆ¶æ—¥å¿—è¿‡æœŸæ¸…ç†æ—¶é—´ã€‚é»˜è®¤å€¼ä¸º0ï¼Œè¡¨ç¤ºä¸è‡ªåŠ¨æ¸…ç†ã€‚</span></span><br><span class="line">expire_logs_days=7  </span><br><span class="line"><span class="comment">## è·³è¿‡ä¸»ä»å¤åˆ¶ä¸­é‡åˆ°çš„æ‰€æœ‰é”™è¯¯æˆ–æŒ‡å®šç±»å‹çš„é”™è¯¯ï¼Œé¿å…slaveç«¯å¤åˆ¶ä¸­æ–­ã€‚</span></span><br><span class="line"><span class="comment">## å¦‚ï¼š1062é”™è¯¯æ˜¯æŒ‡ä¸€äº›ä¸»é”®é‡å¤ï¼Œ1032é”™è¯¯æ˜¯å› ä¸ºä¸»ä»æ•°æ®åº“æ•°æ®ä¸ä¸€è‡´</span></span><br><span class="line">slave_skip_errors=1062  </span><br><span class="line"><span class="comment">## relay_logé…ç½®ä¸­ç»§æ—¥å¿—</span></span><br><span class="line">relay_log=mall-mysql-relay-bin  </span><br><span class="line"><span class="comment">## log_slave_updatesè¡¨ç¤ºslaveå°†å¤åˆ¶äº‹ä»¶å†™è¿›è‡ªå·±çš„äºŒè¿›åˆ¶æ—¥å¿—</span></span><br><span class="line">log_slave_updates=1  </span><br><span class="line"><span class="comment">## slaveè®¾ç½®ä¸ºåªè¯»ï¼ˆå…·æœ‰superæƒé™çš„ç”¨æˆ·é™¤å¤–ï¼‰</span></span><br><span class="line">read_only=1</span><br></pre></td></tr></table></figure><p>é‡æ–°å¯åŠ¨ä»åº“å®¹å™¨<code>docker restart mysql-slave</code>ã€‚</p></li><li><p>ä»åº“æ“ä½œ(è®°å½•æ•°æ®1)</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">docker <span class="built_in">exec</span> -it mysql-slave /bin/bash -c <span class="string">&#x27;mysql -uroot -p000588&#x27;</span></span><br><span class="line"><span class="comment"># å¦‚æœä¸»ä»åœ¨ä¸€å°æœåŠ¡å™¨,åˆ™éœ€è¦é€šè¿‡[ docker inspect --format=&#x27;&#123;&#123;.NetworkSettings.IPAddress&#125;&#125;&#x27; mysql] æŸ¥è¯¢ä¸»åº“å®¹å™¨IP</span></span><br><span class="line"><span class="comment"># å¦‚æœä¸åœ¨ä¸€å°æœåŠ¡å™¨,åˆ™ç›´æ¥ä½¿ç”¨å¤–ç½‘ipå³å¯ ä¸»åº“ä¸­ä¸¤ä¸ªç»“æœæ·»åŠ è¿›æ¥</span></span><br><span class="line"></span><br><span class="line">change master to master_host=<span class="string">&#x27;192.168.206.105&#x27;</span>, master_user=<span class="string">&#x27;slave&#x27;</span>, master_password=<span class="string">&#x27;000588&#x27;</span>, master_port=3306, master_log_file=<span class="string">&#x27;mall-mysql-bin.000001&#x27;</span>, master_log_pos=154, master_connect_retry=30;</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¸»æ•°æ®åº“çš„IPåœ°å€ï¼›</span></span><br><span class="line">master_hostï¼š<span class="string">&#x27;192.168.206.105&#x27;</span>,</span><br><span class="line"><span class="comment"># ä¸»æ•°æ®åº“çš„è¿è¡Œç«¯å£ï¼›</span></span><br><span class="line">master_portï¼š3306,</span><br><span class="line"><span class="comment"># åœ¨ä¸»æ•°æ®åº“åˆ›å»ºçš„ç”¨äºåŒæ­¥æ•°æ®çš„ç”¨æˆ·è´¦å·ï¼›</span></span><br><span class="line">master_userï¼š<span class="string">&#x27;slave&#x27;</span>,</span><br><span class="line"><span class="comment"># åœ¨ä¸»æ•°æ®åº“åˆ›å»ºçš„ç”¨äºåŒæ­¥æ•°æ®çš„ç”¨æˆ·å¯†ç ï¼›</span></span><br><span class="line">master_passwordï¼š<span class="string">&#x27;000588&#x27;</span>,</span><br><span class="line"><span class="comment"># æŒ‡å®šä»æ•°æ®åº“è¦å¤åˆ¶æ•°æ®çš„æ—¥å¿—æ–‡ä»¶ï¼Œé€šè¿‡æŸ¥çœ‹ä¸»æ•°æ®çš„çŠ¶æ€ï¼Œè·å–Fileå‚æ•°ï¼›</span></span><br><span class="line">master_log_fileï¼š<span class="string">&#x27;mysql-bin.000001&#x27;</span>,</span><br><span class="line"><span class="comment"># æŒ‡å®šä»æ•°æ®åº“ä»å“ªä¸ªä½ç½®å¼€å§‹å¤åˆ¶æ•°æ®ï¼Œé€šè¿‡æŸ¥çœ‹ä¸»æ•°æ®çš„çŠ¶æ€ï¼Œè·å–Positionå‚æ•°ï¼›</span></span><br><span class="line">master_log_posï¼š154,</span><br><span class="line"><span class="comment"># è¿æ¥å¤±è´¥é‡è¯•çš„æ—¶é—´é—´éš”ï¼Œå•ä½ä¸ºç§’ã€‚</span></span><br><span class="line">master_connect_retryï¼š30;</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¼€å¯ä¸»ä»åŒæ­¥</span></span><br><span class="line">mysql&gt; start slave;</span><br><span class="line"><span class="comment"># æŸ¥çœ‹ä¸»ä»åŒæ­¥çŠ¶å†µ</span></span><br><span class="line">mysql&gt; show slave status\G;</span><br></pre></td></tr></table></figure><p><code>Slave_IO_Running</code>åŠ<code>Slave_SQL_Running</code>ä¸ºYESæ—¶;ä»åº“å¯åŠ¨+ä¸»ä»å¤åˆ¶æˆåŠŸã€‚</p></li></ol><ul><li><p>åœæ­¢ä¸»ä»å¤åˆ¶</p><p>åœ¨ä»åº“ä¸­æ‰§è¡Œ<code>stop slaveï¼›</code></p></li><li><p>è¯»å†™åˆ†ç¦»</p><p>å‚è€ƒ<a target="_blank" rel="noopener" href="https://blog.csdn.net/jkjkjkll/article/details/125102188">https://blog.csdn.net/jkjkjkll/article/details/125102188</a></p></li></ul><p>Docker ç½‘ç»œ</p></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">æ–‡ç« ä½œè€…:</span> <span class="post-copyright-info"><a href="https://blog.halfsummer.xyz">aceniu</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">æ–‡ç« é“¾æ¥:</span> <span class="post-copyright-info"><a href="https://blog.halfsummer.xyz/posts/920e92d1.html">https://blog.halfsummer.xyz/posts/920e92d1.html</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">ç‰ˆæƒå£°æ˜:</span> <span class="post-copyright-info">æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜æ¥è‡ª <a href="https://blog.halfsummer.xyz" target="_blank">è‰¾æ–¯ç‰› Blog</a>ï¼</span></div></div><div class="tag_share"><div class="post-meta__tag-list"></div><div class="post_share"><div class="social-share" data-image="http://cos.halfsummer.xyz/pictures/niubb/2023/20230228-63fdc7d0ce7ba.jpeg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload='this.media="all"'><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/posts/edc1b716.html" title="Shellç¼–ç¨‹ å­¦ä¹ ç¬”è®°"><div class="cover" style="background:var(--default-bg-color)"></div><div class="pagination-info"><div class="label">ä¸Šä¸€ç¯‡</div><div class="prev_info">Shellç¼–ç¨‹ å­¦ä¹ ç¬”è®°</div></div></a></div><div class="next-post pull-right"><a href="/posts/6c6bf881.html" title="Gitee + PicGO æ­å»ºå›¾åºŠ"><div class="cover" style="background:var(--default-bg-color)"></div><div class="pagination-info"><div class="label">ä¸‹ä¸€ç¯‡</div><div class="next_info">Gitee + PicGO æ­å»ºå›¾åºŠ</div></div></a></div></nav><hr><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i> <span>è¯„è®º</span></div></div><div class="comment-wrap"><div><div id="twikoo-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="http://cos.halfsummer.xyz/pictures/niubb/2023/20230228-63fdc7d0ce7ba.jpeg" onerror='this.onerror=null,this.src="/img/friend_404.gif"' alt="avatar"></div><div class="author-info__name">aceniu</div><div class="author-info__description">Love 33 & Yilia</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">33</div></a><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">13</div></a><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">10</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/aceniu"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon faa-parent animated-hover" href="https://github.com/aceniu" target="_blank" title="Github"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-icon_github-circle"></use></svg></a><a class="social-icon faa-parent animated-hover" href="https://mail.qq.com/cgi-bin/qm_share?t=qm_mailme&amp;email=123354319@qq.com" target="_blank" title="Email"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-youxiang"></use></svg></a><a class="social-icon faa-parent animated-hover" href="/atom.xml" target="_blank" title="RSS"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-Rss"></use></svg></a><a class="social-icon faa-parent animated-hover" href="https://space.bilibili.com/289493392" target="_blank" title="BiliBili"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-bilibili-line"></use></svg></a><a class="social-icon faa-parent animated-hover" href="tencent://Message/?Uin=123354319&amp;amp;websiteName=local.edu.com:8888=&amp;amp;Menu=yes" target="_blank" title="QQ"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-icon_qq-circle"></use></svg></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>å…¬å‘Š</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>ç›®å½•</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#1%EF%BC%89%E7%AE%80%E4%BB%8B"><span class="toc-text">1ï¼‰ç®€ä»‹</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-1-Docker-%E4%B8%BA%E4%BB%80%E4%B9%88%E6%A8%AA%E7%A9%BA%E5%87%BA%E4%B8%96"><span class="toc-text">1.1 Docker ä¸ºä»€ä¹ˆæ¨ªç©ºå‡ºä¸–</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-2-%E6%A6%82%E8%BF%B0"><span class="toc-text">1.2 æ¦‚è¿°</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-3-%E5%AE%B9%E5%99%A8%E4%B8%8E%E8%99%9A%E6%8B%9F%E6%9C%BA%E7%9A%84%E6%AF%94%E8%BE%83"><span class="toc-text">1.3 å®¹å™¨ä¸è™šæ‹Ÿæœºçš„æ¯”è¾ƒ</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-4-Docker-%E6%9E%B6%E6%9E%84"><span class="toc-text">1.4 Docker æ¶æ„</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-5-Docker-%E5%BC%95%E6%93%8E"><span class="toc-text">1.5 Docker å¼•æ“</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-6-Docker-%E5%B9%B3%E5%8F%B0%E7%BB%84%E6%88%90"><span class="toc-text">1.6 Docker å¹³å°ç»„æˆ</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-7-%E9%95%9C%E5%83%8F-%E5%AE%B9%E5%99%A8"><span class="toc-text">1.7 é•œåƒ&amp;å®¹å™¨</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-8-Docker-%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F"><span class="toc-text">1.8 Docker ç”Ÿå‘½å‘¨æœŸ</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-9-Docker-%E9%95%9C%E5%83%8F%E5%8E%9F%E7%90%86%E7%90%86%E8%A7%A3"><span class="toc-text">1.9 Docker é•œåƒåŸç†ç†è§£</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#2%EF%BC%89Docker-%E5%AE%89%E8%A3%85"><span class="toc-text">2ï¼‰Docker å®‰è£…</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#2-1-Docker-%E7%89%88%E6%9C%AC%E8%AF%B4%E6%98%8E"><span class="toc-text">2.1 Docker ç‰ˆæœ¬è¯´æ˜</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-2-%E5%8D%B8%E8%BD%BD"><span class="toc-text">2.2 å¸è½½</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-3-%E5%AE%89%E8%A3%85"><span class="toc-text">2.3 å®‰è£…</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-4-%E9%85%8D%E7%BD%AE%E9%95%9C%E5%83%8F%E5%8A%A0%E9%80%9F%E5%99%A8"><span class="toc-text">2.4 é…ç½®é•œåƒåŠ é€Ÿå™¨</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-5-%E5%90%AF%E5%8A%A8"><span class="toc-text">2.5 å¯åŠ¨</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-6-%E6%B5%8B%E8%AF%95"><span class="toc-text">2.6 æµ‹è¯•</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#3%EF%BC%89%E9%95%9C%E5%83%8F%E7%AE%A1%E7%90%86%E5%91%BD%E4%BB%A4"><span class="toc-text">3ï¼‰é•œåƒç®¡ç†å‘½ä»¤</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#8-1-%E6%90%9C%E7%B4%A2%E9%95%9C%E5%83%8F%E6%98%AF%E5%90%A6%E5%AD%98%E5%9C%A8%E4%BA%8E%E9%95%9C%E5%83%8F%E5%BA%93"><span class="toc-text">8.1 æœç´¢é•œåƒæ˜¯å¦å­˜åœ¨äºé•œåƒåº“</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-2-%E6%9F%A5%E7%9C%8B%E9%95%9C%E5%83%8F"><span class="toc-text">8.2 æŸ¥çœ‹é•œåƒ</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-2-%E9%95%9C%E5%83%8F%E6%8B%89%E5%8F%96"><span class="toc-text">8.2 é•œåƒæ‹‰å–</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-3-%E6%9F%A5%E7%9C%8B-Docker-%E7%9A%84%E6%9C%8D%E5%8A%A1%E4%BF%A1%E6%81%AF"><span class="toc-text">8.3 æŸ¥çœ‹ Docker çš„æœåŠ¡ä¿¡æ¯</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-4-%E5%88%A0%E9%99%A4%E9%95%9C%E5%83%8F"><span class="toc-text">8.4 åˆ é™¤é•œåƒ</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-5-%E5%AF%BC%E5%87%BA%E9%95%9C%E5%83%8F"><span class="toc-text">8.5 å¯¼å‡ºé•œåƒ</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-6-%E5%AF%BC%E5%85%A5%E9%95%9C%E5%83%8F"><span class="toc-text">8.6 å¯¼å…¥é•œåƒ</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-7-%E6%9F%A5%E7%9C%8B-Docker-%E9%95%9C%E5%83%8F%E4%BF%A1%E6%81%AF"><span class="toc-text">8.7 æŸ¥çœ‹ Docker é•œåƒä¿¡æ¯</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#4%EF%BC%89%E5%AE%B9%E5%99%A8%E7%AE%A1%E7%90%86%E5%91%BD%E4%BB%A4"><span class="toc-text">4ï¼‰å®¹å™¨ç®¡ç†å‘½ä»¤</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#9-1-%E8%BF%90%E8%A1%8C%E3%80%81%E5%88%9B%E5%BB%BA%E5%AE%B9%E5%99%A8"><span class="toc-text">9.1 è¿è¡Œã€åˆ›å»ºå®¹å™¨</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#9-2-%E5%90%AF%E5%8A%A8%E3%80%81%E5%81%9C%E6%AD%A2%E3%80%81%E9%87%8D%E5%90%AF%E5%AE%B9%E5%99%A8"><span class="toc-text">9.2 å¯åŠ¨ã€åœæ­¢ã€é‡å¯å®¹å™¨</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#9-3-%E6%9F%A5%E7%9C%8B%E5%AE%B9%E5%99%A8%E3%80%81%E5%AE%B9%E5%99%A8%E6%97%A5%E5%BF%97%E3%80%81%E5%AE%B9%E5%99%A8%E7%9A%84%E8%AF%A6%E7%BB%86%E4%BF%A1%E6%81%AF"><span class="toc-text">9.3 æŸ¥çœ‹å®¹å™¨ã€å®¹å™¨æ—¥å¿—ã€å®¹å™¨çš„è¯¦ç»†ä¿¡æ¯</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#9-4-%E5%88%A0%E9%99%A4%E5%AE%B9%E5%99%A8"><span class="toc-text">9.4 åˆ é™¤å®¹å™¨</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#9-5-%E8%BF%9B%E5%85%A5%E5%AE%B9%E5%99%A8%E5%86%85"><span class="toc-text">9.5 è¿›å…¥å®¹å™¨å†…</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#9-6-%E5%AE%B9%E5%99%A8%E7%9A%84%E7%AB%AF%E5%8F%A3%E6%98%A0%E5%B0%84"><span class="toc-text">9.6 å®¹å™¨çš„ç«¯å£æ˜ å°„</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#9-7-%E6%9F%A5%E7%9C%8B%E5%AE%B9%E5%99%A8%E7%9A%84%E7%AB%AF%E5%8F%A3%E6%98%A0%E5%B0%84"><span class="toc-text">9.7 æŸ¥çœ‹å®¹å™¨çš„ç«¯å£æ˜ å°„</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#9-8-%E6%9B%B4%E6%96%B0%E5%AE%B9%E5%99%A8%E5%8F%82%E6%95%B0"><span class="toc-text">9.8 æ›´æ–°å®¹å™¨å‚æ•°</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#9-9-%E5%AE%B9%E5%99%A8%E7%9A%84%E6%96%87%E4%BB%B6%E6%8B%B7%E8%B4%9D"><span class="toc-text">9.9 å®¹å™¨çš„æ–‡ä»¶æ‹·è´</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#9-8-%E5%AE%B9%E5%99%A8%E7%9A%84%E6%8F%90%E4%BA%A4"><span class="toc-text">9.8 å®¹å™¨çš„æäº¤</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#9-9-%E5%AE%B9%E5%99%A8%E7%9A%84%E5%AF%BC%E5%87%BA%E5%92%8C%E5%AF%BC%E5%85%A5"><span class="toc-text">9.9 å®¹å™¨çš„å¯¼å‡ºå’Œå¯¼å…¥</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#9-9-%E6%9F%A5%E7%9C%8B%E5%AE%B9%E5%99%A8%E8%AF%A6%E7%BB%86%E4%BF%A1%E6%81%AF"><span class="toc-text">9.9 æŸ¥çœ‹å®¹å™¨è¯¦ç»†ä¿¡æ¯</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#5%EF%BC%89Docker-%E9%95%9C%E5%83%8F"><span class="toc-text">5ï¼‰Docker é•œåƒ</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#10-1-dockerfile-%E6%8C%87%E4%BB%A4"><span class="toc-text">10.1 dockerfile æŒ‡ä»¤</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#10-1-1-FROM-%E6%8C%87%E5%AE%9A%E5%9F%BA%E7%A1%80%E9%95%9C%E5%83%8F"><span class="toc-text">10.1.1 FROM æŒ‡å®šåŸºç¡€é•œåƒ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#10-1-2-MAINTAINER-%E6%8C%87%E5%AE%9A%E7%BB%B4%E6%8A%A4%E8%80%85%E4%BF%A1%E6%81%AF"><span class="toc-text">10.1.2 MAINTAINER æŒ‡å®šç»´æŠ¤è€…ä¿¡æ¯</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#10-1-3-RUN-%E6%89%A7%E8%A1%8C%E5%91%BD%E4%BB%A4"><span class="toc-text">10.1.3 RUN æ‰§è¡Œå‘½ä»¤</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#10-1-4-ADD-%E6%8B%B7%E8%B4%9D%E6%96%87%E4%BB%B6%EF%BC%8C%E4%BC%9A%E8%87%AA%E5%8A%A8%E8%A7%A3%E5%8E%8B"><span class="toc-text">10.1.4 ADD æ‹·è´æ–‡ä»¶ï¼Œä¼šè‡ªåŠ¨è§£å‹</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#10-1-5-COPY-%E5%A4%8D%E5%88%B6%E6%96%87%E4%BB%B6"><span class="toc-text">10.1.5 COPY å¤åˆ¶æ–‡ä»¶</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#10-1-6-WORKDIR-%E8%AE%BE%E7%BD%AE%E5%BD%93%E5%89%8D%E5%B7%A5%E4%BD%9C%E7%9B%AE%E5%BD%95"><span class="toc-text">10.1.6 WORKDIR è®¾ç½®å½“å‰å·¥ä½œç›®å½•</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#10-1-7-VOLUME-%E8%AE%BE%E7%BD%AE%E5%8D%B7%EF%BC%8C%E6%8C%82%E8%BD%BD%E5%88%B0%E4%B8%BB%E6%9C%BA%E7%9B%AE%E5%BD%95"><span class="toc-text">10.1.7 VOLUME è®¾ç½®å·ï¼ŒæŒ‚è½½åˆ°ä¸»æœºç›®å½•</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#10-1-8-EXPOSE-%E6%8C%87%E5%AE%9A%E5%AF%B9%E5%A4%96%E7%9A%84%E7%AB%AF%E5%8F%A3"><span class="toc-text">10.1.8 EXPOSE æŒ‡å®šå¯¹å¤–çš„ç«¯å£</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#10-1-9-CMD-%E6%8C%87%E5%AE%9A%E5%AE%B9%E5%99%A8%E5%90%AF%E5%8A%A8%E5%90%8E%E8%A6%81%E5%B9%B2%E7%9A%84%E4%BA%8B%E6%83%85"><span class="toc-text">10.1.9 CMD æŒ‡å®šå®¹å™¨å¯åŠ¨åè¦å¹²çš„äº‹æƒ…</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#10-1-10-ENTRYPOINT-%E5%AE%B9%E5%99%A8%E5%90%AF%E5%8A%A8%E5%90%8E%E6%89%A7%E8%A1%8C%E7%9A%84%E5%91%BD%E4%BB%A4"><span class="toc-text">10.1.10 ENTRYPOINT å®¹å™¨å¯åŠ¨åæ‰§è¡Œçš„å‘½ä»¤</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#10-1-11-ENV-%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F"><span class="toc-text">10.1.11 ENV ç¯å¢ƒå˜é‡</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#10-1-12-restart-%E9%87%8D%E5%90%AF%E6%9C%BA%E5%88%B6"><span class="toc-text">10.1.12 restart é‡å¯æœºåˆ¶</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#10-2-%E6%9E%84%E5%BB%BA%E9%95%9C%E5%83%8F"><span class="toc-text">10.2 æ„å»ºé•œåƒ</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#11%EF%BC%89%E5%AE%B9%E5%99%A8%E6%95%B0%E6%8D%AE%E5%8D%B7"><span class="toc-text">11ï¼‰å®¹å™¨æ•°æ®å·</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E5%91%BD%E4%BB%A4"><span class="toc-text">.1 å‘½ä»¤</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E6%A6%82%E8%BF%B0"><span class="toc-text">.2 æ¦‚è¿°</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E8%AF%BB%E5%86%99%E8%A7%84%E5%88%99"><span class="toc-text">.3 è¯»å†™è§„åˆ™</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-%E5%8D%B7%E7%9A%84%E7%BB%A7%E6%89%BF%E5%92%8C%E5%85%B1%E4%BA%AB"><span class="toc-text">.4 å·çš„ç»§æ‰¿å’Œå…±äº«</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%9B%A2%E9%98%9F%E5%8D%8F%E4%BD%9C"><span class="toc-text">å›¢é˜Ÿåä½œ</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E9%98%BF%E9%87%8C%E4%BA%91"><span class="toc-text">.1 é˜¿é‡Œäº‘</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-dockerhub"><span class="toc-text">.2 dockerhub</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E7%A7%81%E6%9C%89%E4%BB%93%E5%BA%93"><span class="toc-text">.3 ç§æœ‰ä»“åº“</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1-%E5%88%9B%E5%BB%BA%E7%A7%81%E6%9C%89%E4%BB%93%E5%BA%93"><span class="toc-text">.3.1 åˆ›å»ºç§æœ‰ä»“åº“</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-%E6%9F%A5%E7%9C%8B%E7%A7%81%E6%9C%89%E5%BA%93%E9%95%9C%E5%83%8F"><span class="toc-text">.3.2 æŸ¥çœ‹ç§æœ‰åº“é•œåƒ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-3-%E6%8E%A8%E9%80%81%E5%92%8C%E6%8B%89%E5%8F%96"><span class="toc-text">.3.3 æ¨é€å’Œæ‹‰å–</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Docker-APP%E5%B8%B8%E8%A7%84%E5%AE%89%E8%A3%85"><span class="toc-text">Docker APPå¸¸è§„å®‰è£…</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-tomcat"><span class="toc-text">.1 tomcat</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-MySQL"><span class="toc-text">.2 MySQL</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-redis"><span class="toc-text">.3 redis</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-nginx"><span class="toc-text">.4 nginx</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Docker-APP%E5%A4%8D%E6%9D%82%E5%AE%89%E8%A3%85"><span class="toc-text">Docker APPå¤æ‚å®‰è£…</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-MySQL%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6"><span class="toc-text">1. MySQLä¸»ä»å¤åˆ¶</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>æœ€æ–°æ–‡ç« </span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/posts/317ae1f5.html" title="Gitåˆ é™¤æš‚å­˜åŒºæˆ–ç‰ˆæœ¬åº“ä¸­çš„æ–‡ä»¶">Gitåˆ é™¤æš‚å­˜åŒºæˆ–ç‰ˆæœ¬åº“ä¸­çš„æ–‡ä»¶</a><time datetime="2023-03-14T01:17:28.000Z" title="å‘è¡¨äº 2023-03-14 01:17:28">2023-03-14</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/posts/70fb250c.html" title="Gitå¦‚ä½•å›æ»šä»£ç ?">Gitå¦‚ä½•å›æ»šä»£ç ?</a><time datetime="2023-03-14T01:13:35.000Z" title="å‘è¡¨äº 2023-03-14 01:13:35">2023-03-14</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/posts/c1c5e0d7.html" title="Tomcat å­¦ä¹ ç¬”è®°">Tomcat å­¦ä¹ ç¬”è®°</a><time datetime="2023-03-13T23:19:24.000Z" title="å‘è¡¨äº 2023-03-13 23:19:24">2023-03-13</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/posts/c1020521.html" title="Nginx å­¦ä¹ ç¬”è®°">Nginx å­¦ä¹ ç¬”è®°</a><time datetime="2023-03-13T23:16:34.000Z" title="å‘è¡¨äº 2023-03-13 23:16:34">2023-03-13</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/posts/fa17c65a.html" title="Redis å­¦ä¹ ç¬”è®°">Redis å­¦ä¹ ç¬”è®°</a><time datetime="2023-03-13T23:16:24.000Z" title="å‘è¡¨äº 2023-03-13 23:16:24">2023-03-13</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2023 By aceniu</div><div class="framework-info"><span>æ¡†æ¶</span> <a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>ä¸»é¢˜</span> <a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="é˜…è¯»æ¨¡å¼"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="æµ…è‰²å’Œæ·±è‰²æ¨¡å¼è½¬æ¢"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="å•æ å’ŒåŒæ åˆ‡æ¢"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="è®¾ç½®"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="ç›®å½•"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="ç›´è¾¾è¯„è®º"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="å›åˆ°é¡¶éƒ¨"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">æœç´¢</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i> <span>æ•°æ®åº“åŠ è½½ä¸­</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="æœç´¢æ–‡ç« " type="text"></div></div><hr><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js"></script><script src="/js/search/local-search.js"></script><div class="js-pjax"><script>(()=>{
  const init = () => {
    twikoo.init(Object.assign({
      el: '#twikoo-wrap',
      envId: 'https://hexo-twikoo.halfsummer.xyz/',
      region: '',
      onCommentLoaded: function () {
        btf.loadLightbox(document.querySelectorAll('#twikoo .tk-content img:not(.tk-owo-emotion)'))
      }
    }, null))
  }

  const getCount = () => {
    const countELement = document.getElementById('twikoo-count')
    if(!countELement) return
    twikoo.getCommentsCount({
      envId: 'https://hexo-twikoo.halfsummer.xyz/',
      region: '',
      urls: [window.location.pathname],
      includeReply: false
    }).then(function (res) {
      countELement.innerText = res[0].count
    }).catch(function (err) {
      console.error(err);
    });
  }

  const runFn = () => {
    init()
    
  }

  const loadTwikoo = () => {
    if (typeof twikoo === 'object') {
      setTimeout(runFn,0)
      return
    } 
    getScript('https://cdn.jsdelivr.net/npm/twikoo/dist/twikoo.all.min.js').then(runFn)
  }

  if ('Twikoo' === 'Twikoo' || !true) {
    if (true) btf.loadComment(document.getElementById('twikoo-wrap'), loadTwikoo)
    else loadTwikoo()
  } else {
    window.loadOtherComment = () => {
      loadTwikoo()
    }
  }
})()</script></div><div class="app-refresh" id="app-refresh" style="position:fixed;top:-2.2rem;left:0;right:0;z-index:99999;padding:0 1rem;font-size:15px;height:2.2rem;transition:all .3s ease"><div class="app-refresh-wrap" style="display:flex;color:#fff;height:100%;align-items:center;justify-content:center"><label>âœ¨ æœ‰æ–°æ–‡ç« å•¦ï¼ ğŸ‘‰</label><a href="javascript:void(0)" onclick="location.reload()"><span style="color:#fff;text-decoration:underline;cursor:pointer">ğŸ—ç‚¹å‡»é£Ÿç”¨ğŸ”</span></a></div></div><script>if ('serviceWorker' in navigator) {
if (navigator.serviceWorker.controller) {
navigator.serviceWorker.addEventListener('controllerchange', function() {
showNotification()
})
}
window.addEventListener('load', function() {
navigator.serviceWorker.register('/sw.js')
})
}
function showNotification() {
if (GLOBAL_CONFIG.Snackbar) {
var snackbarBg =
document.documentElement.getAttribute('data-theme') === 'light' ?
GLOBAL_CONFIG.Snackbar.bgLight :
GLOBAL_CONFIG.Snackbar.bgDark
var snackbarPos = GLOBAL_CONFIG.Snackbar.position
Snackbar.show({
text: 'âœ¨ æœ‰æ–°æ–‡ç« å•¦ï¼ ğŸ‘‰',
backgroundColor: snackbarBg,
duration: 500000,
pos: snackbarPos,
actionText: 'ğŸ—ç‚¹å‡»é£Ÿç”¨ğŸ”',
actionTextColor: '#fff',
onActionClick: function(e) {
location.reload()
},
})
} else {
var showBg =
document.documentElement.getAttribute('data-theme') === 'light' ?
'#3b70fc' :
'#1f1f1f'
var cssText = `top: 0; background: ${showBg};`
document.getElementById('app-refresh').style.cssText = cssText
}
}</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><script async src="/js/ali_font.js"></script><div class="js-pjax"><script async>for(var arr=document.getElementsByClassName("recent-post-item"),i=0;i<arr.length;i++)arr[i].classList.add("wow"),arr[i].classList.add("animate__zoomIn"),arr[i].setAttribute("data-wow-duration","1.5s"),arr[i].setAttribute("data-wow-delay","200ms"),arr[i].setAttribute("data-wow-offset","30"),arr[i].setAttribute("data-wow-iteration","1")</script><script async>for(var arr=document.getElementsByClassName("card-widget"),i=0;i<arr.length;i++)arr[i].classList.add("wow"),arr[i].classList.add("animate__zoomIn"),arr[i].setAttribute("data-wow-duration",""),arr[i].setAttribute("data-wow-delay","200ms"),arr[i].setAttribute("data-wow-offset",""),arr[i].setAttribute("data-wow-iteration","")</script><script async>for(var arr=document.getElementsByClassName("flink-list-card"),i=0;i<arr.length;i++)arr[i].classList.add("wow"),arr[i].classList.add("animate__flipInY"),arr[i].setAttribute("data-wow-duration","3s"),arr[i].setAttribute("data-wow-delay",""),arr[i].setAttribute("data-wow-offset",""),arr[i].setAttribute("data-wow-iteration","")</script><script async>for(var arr=document.getElementsByClassName("flink-list-card"),i=0;i<arr.length;i++)arr[i].classList.add("wow"),arr[i].classList.add("animate__animated"),arr[i].setAttribute("data-wow-duration","3s"),arr[i].setAttribute("data-wow-delay",""),arr[i].setAttribute("data-wow-offset",""),arr[i].setAttribute("data-wow-iteration","")</script><script async>for(var arr=document.getElementsByClassName("article-sort-item"),i=0;i<arr.length;i++)arr[i].classList.add("wow"),arr[i].classList.add("animate__slideInRight"),arr[i].setAttribute("data-wow-duration","1.5s"),arr[i].setAttribute("data-wow-delay",""),arr[i].setAttribute("data-wow-offset",""),arr[i].setAttribute("data-wow-iteration","")</script><script async>for(var arr=document.getElementsByClassName("site-card"),i=0;i<arr.length;i++)arr[i].classList.add("wow"),arr[i].classList.add("animate__flipInY"),arr[i].setAttribute("data-wow-duration","3s"),arr[i].setAttribute("data-wow-delay",""),arr[i].setAttribute("data-wow-offset",""),arr[i].setAttribute("data-wow-iteration","")</script><script async>for(var arr=document.getElementsByClassName("site-card"),i=0;i<arr.length;i++)arr[i].classList.add("wow"),arr[i].classList.add("animate__animated"),arr[i].setAttribute("data-wow-duration","3s"),arr[i].setAttribute("data-wow-delay",""),arr[i].setAttribute("data-wow-offset",""),arr[i].setAttribute("data-wow-iteration","")</script></div><script defer src="https://cdn.cbd.int/hexo-butterfly-wowjs/lib/wow.min.js"></script><script defer src="https://cdn.cbd.int/hexo-butterfly-wowjs/lib/wow_init.js"></script></body></html>